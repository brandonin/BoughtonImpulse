(function(l,m,n){l.execute(function(){l.when("jQuery","A","p13n-sc-call-on-visible","p13n-sc-util","p13n-sc-math","p13n-sc-lazy-image-loader").register("p13n-sc-list",function(e,f,j,i,g,k){function h(b){var a=this;a.$container=e(b);if(a.$container.attr(c))return!1;a.$container.attr(c,!0);f.state("sims-list",{initialized:"true"});a.$cellListContainer=a.$container.find(".p13n-sc-list-cells-container");a.$cellList=a.$container.find(".p13n-sc-list-cells");a.$buttons=a.$container.find(".p13n-sc-list-show-more-buttons");
a.$showMoreButton=a.$container.find(".p13n-sc-list-button-show-more");a.$hideButton=a.$container.find(".p13n-sc-list-button-hide");a.$showMorePartialOverlay=a.$container.find(".p13n-sc-list-partial-overlay");a.asins=a.$container.data("asins").toString().split(",");a.asinIndex=a.$container.data("asin-index");a.numVisibleRows=d;a.originalItemWidth=a.$cellListContainer.find(".p13n-sc-list-item:first-child").outerWidth(!0);a.originalCellMarginLeft=parseInt(a.$cellListContainer.find(".p13n-sc-list-item").css("margin-left"),
10);a.initialCellContainerHeight=0;a.isInitialLoad=!0;a.calculateColumns();a.adjustColumnWidths();a.fillVisibleProductSlots();a.placeOverlay();a.configureButtons();a.$buttons.removeClass("a-hidden");a.$showMoreButton.bind("click",function(b){a.showMoreWasTapped(b)});a.$showMorePartialOverlay.bind("click",function(b){a.showMoreWasTapped(b)});a.$showMorePartialOverlay.hover(function(){a.$showMoreButton.addClass("p13n-sc-list-buttons-hover")},function(){a.$showMoreButton.removeClass("p13n-sc-list-buttons-hover")});
a.$showMoreButton.hover(function(){a.$showMoreButton.addClass("p13n-sc-list-buttons-hover")},function(){a.$showMoreButton.removeClass("p13n-sc-list-buttons-hover")});a.$hideButton.hover(function(){a.$hideButton.addClass("p13n-sc-list-buttons-hover")},function(){a.$hideButton.removeClass("p13n-sc-list-buttons-hover")});a.$hideButton.bind("click",function(b){a.hideWasTapped(b)});e(m).bind("resize.p13n-sc-list",function(){a.handleResize()});k.loadImages(a.$container);f.trigger("p13n-sc-list:init",a.$container)}
var c="data-p13n-sc-list-initialized",d=2;h.prototype={hasAdditionalProducts:function(){return this.asins.length>this.asinIndex+1},loadAdditionalProducts:function(b){var a=this;if(!a.isLoadingProducts&&a.hasAdditionalProducts()){a.isLoadingProducts=!0;a.$container.attr("data-p13n-sc-list-loading",!0);for(var c=[],d=a.asinIndex+1;d<=a.asinIndex+b&&d<a.asins.length;d++)c.push(this.asins[d]);(b=this.$container.data("ajax-params"))||(b={faceoutTemplateClass:this.$container.data("faceout-template-class"),
widgetTemplateClass:this.$container.data("widget-template-class"),reftagPrefix:this.$container.data("reftag-prefix"),suppressCurrencyImageFormat:this.$container.data("suppress-currency-image-format"),imageWidth:a.$container.data("image-width")||"",imageHeight:a.$container.data("image-height")||"",auiDeviceType:a.$container.data("aui-device-type")});b.lazyLoadImages=1;b.asins=c.join();b.offset=this.asinIndex+1;d=a.$container.data("ajax-url");f.get(d,{params:b,success:function(b){a.handleAjaxComplete(b,
c.length)},error:function(){a.handleAjaxError(c.length)}})}},handleAjaxComplete:function(b,a){this.asinIndex+=a;this.hideLoadingAnimation();if(b&&e.isArray(b)&&b.length>0){var c=e(b.join(""));this.$cellList.append(c);k.loadImages(c)}else i.log.error("List View partial endpoint returned an item that was not an array of cells.");this.isLoadingProducts=!1;this.$container.attr("data-p13n-sc-list-loading",!1);this.showMorePending=!1;this.adjustColumnWidths();this.placeOverlay();this.isInitialLoad||this.fillNextProductSlots()},
handleAjaxError:function(){i.count("p13n:sc:list:desktop:ajax-error",(i.count("p13n:sc:list:desktop:ajax-error")||0)+1);this.hideLoadingAnimation();this.isLoadingProducts=!1;this.$container.attr("data-p13n-sc-list-loading",!1);if(this.showMorePending)this.numVisibleRows=g.max(d,this.numVisibleRows-3),this.animateClosed(this.getCellContainerHeights().cellContainerHeight),this.showMorePending=!1},visibleSlotsAreFilled:function(){return g.min(this.numVisibleRows*this.numColumns,this.asins.length)-(this.asinIndex+
1)<=0},fillVisibleProductSlots:function(){var b=g.min(this.numVisibleRows*this.numColumns,this.asins.length)-(this.asinIndex+1);if(b>0&&!this.isLoadingProducts){for(var a=0;a<b;a++)this.addLoadingAnimation();this.loadAdditionalProducts(b)}},fillNextProductSlots:function(){var b=g.min(3*this.numColumns,this.asins.length-(this.asinIndex+1))-(this.asinIndex+1);if(b>0&&!this.isLoadingProducts){for(var a=0;a<b;a++)this.addLoadingAnimation();this.loadAdditionalProducts(b)}},handleResize:function(){this.calculateColumns();
this.adjustColumnWidths();this.fillVisibleProductSlots();this.placeOverlay();this.configureButtons();f.trigger("p13n-sc-list:resize",this)},calculateColumns:function(){var b=this.$cellListContainer.width();this.numColumns=g.floor(b/this.originalItemWidth);this.cellMarginLeft=this.originalCellMarginLeft+(g.floor((b-this.originalItemWidth*this.numColumns)/this.numColumns)-5)},getNumPossibleRows:function(){return g.ceil(this.asins.length/this.numColumns)},adjustColumnWidths:function(){this.$cellListContainer.find(".p13n-sc-list-item").css("margin-left",
this.cellMarginLeft)},getCellContainerHeights:function(){if(this.numVisibleRows>=this.getNumPossibleRows()&&!this.isInitialLoad)return{cellContainerHeight:this.$cellList.height(),lastRowPixels:0};for(var b=this.$cellList.children(),a=b.first().offset().top,c=0,d=0,f=0,e=0;e<b.length;e++){var h=b.eq(e).offset().top,g=b.eq(e).outerHeight(!0);if(h>a){c+=1;if(c===this.numVisibleRows)break;d+=f;f=g;a=h}else g>f&&(f=g)}c>=this.numVisibleRows||c>=1&&(this.hasAdditionalProducts()||this.isInitialLoad)?(b=
d+55,a=55):(b=d+f,a=0);return{cellContainerHeight:b,lastRowPixels:a}},placeOverlay:function(){var b=this.getCellContainerHeights();this.cellContainerHeight=b.cellContainerHeight;this.$cellListContainer.css({height:this.cellContainerHeight,overflow:"hidden"});this.$showMorePartialOverlay.css({height:b.lastRowPixels,top:-b.lastRowPixels})},showMoreWasTapped:function(){this.isInitialLoad=!1;f.trigger("p13n-sc-list:show-more",this);i.count("p13n:sc:list:desktop:show-more",(i.count("p13n:sc:list:desktop:show-more")||
0)+1);this.numVisibleRows=g.min(this.numVisibleRows+3,this.getNumPossibleRows());if(!this.visibleSlotsAreFilled())this.showMorePending=!0,this.fillVisibleProductSlots();this.animateOpen(this.getCellContainerHeights().cellContainerHeight)},hideWasTapped:function(){i.count("p13n:sc:list:desktop:hide",(i.count("p13n:sc:list:desktop:hide")||0)+1);this.numVisibleRows=d;this.animateClosed(this.getCellContainerHeights().cellContainerHeight)},animateOpen:function(b){var a=this;f.animate(a.$cellListContainer,
{height:b},1E3,"cubic-bezier(0.86, 0, 0.07, 1)",function(){a.configureButtons();a.placeOverlay()})},animateClosed:function(b){var a=this;a.$cellListContainer.animate({height:b},{duration:500,queue:!1,complete:function(){a.configureButtons();a.placeOverlay()}});e("html, body").animate({scrollTop:a.$container.offset().top+b+a.$buttons.outerHeight()-e(m).height()+150},{duration:500,queue:!1})},addLoadingAnimation:function(){this.$cellList.append(e('<div class="sims-show-hide p13n-sc-list-item p13n-sc-list-loader a-manually-loaded" style="right: 0px;"></div>'))},
hideLoadingAnimation:function(){this.$cellListContainer.find(".p13n-sc-list-loader").remove()},isAtMaxHeight:function(){return this.numVisibleRows>=this.getNumPossibleRows()},isAtMinHeight:function(){return this.numVisibleRows<=d},configureButtons:function(){var b=this.getNumPossibleRows(),a=2;b===1||b===d&&!this.isInitialLoad?a=3:this.isAtMinHeight()?a=0:this.isAtMaxHeight()&&!this.isLoadingProducts&&(a=1);this.setButtonState(a);this.$buttons.width(this.$cellListContainer.innerWidth())},setButtonState:function(b){this.buttonState=
b;this.$buttons.removeClass("p13n-sc-both-state p13n-sc-show-more-state p13n-sc-hide-state");b===0?(this.$buttons.addClass("p13n-sc-show-more-state"),this.$buttons.show()):b===1?(this.$buttons.addClass("p13n-sc-hide-state"),this.$buttons.show()):b===2?(this.$buttons.addClass("p13n-sc-both-state"),this.$buttons.show()):b===3&&this.$buttons.hide()}};f.on("afterReady",function(){e(".p13n-sc-list").each(function(b,a){new h(a)})});f.state.bind("sims-list",function(){e(".p13n-sc-list").each(function(b,
a){new h(a)})});return h});l.when("A","jQuery","p13n-sc-call-on-visible","p13n-sc-logger","afterReady").execute("sims-list-logger",function(e,f,j,i){function g(e){j.register(e,function(){i.logAsyncAction(f.extend(!0,{},{featureElement:e,isEventComplete:function(){return!e.attr(k)},replicateAsinImpressions:!0},{action:"view"}))})}var k="data-p13n-sc-list-loading";f(".p13n-sc-list").each(function(e,c){var d=f(c);d.attr("data-p13n-sc-list-initialized")&&g(d)});e.on("p13n-sc-list:init",function(e){g(e)});
e.on("p13n-sc-list:show-more",function(e){i.logAsyncAction(f.extend(!0,{},{featureElement:e.$container,isEventComplete:function(){return!e.isLoadingProducts},replicateAsinImpressions:!0},{action:"show_more"}))});e.on("p13n-sc-list:resize",function(e){e.$container.attr("data-p13n-sc-list-initialized")&&i.logAsyncAction(f.extend(!0,{},{featureElement:e.$container,isEventComplete:function(){return!e.isLoadingProducts},replicateAsinImpressions:!0},{action:"resize"}))})});l.when("jQuery","A").execute("sims-bind-parse-aui",
function(e,f){function j(){var g=f.parseJSON;f.each(e('script[type="a-state"]'),function(k){k=e(k);if(!k.data("a-eval")){var h=k.attr("data-a-state");if(h&&(h=g(h),h.key&&e.inArray(h.key,i)!==-1)){var c=g(k.html());f.state.replace(h.key,c);k.data("a-eval",!0)}}})}var i=["sims-fbt","sims-list","view_to_purchase-sims-weblab-state"];f.on("a:pageUpdate",function(){j()})});(function(){l.when("jQuery","A","p13n-sc-line-truncator").register("sims-carousel-truncation",function(e,f,j){for(var e=["purchase",
"session"],i=e.length-1;i>=0;i--)f.on("a:carousel:"+e[i]+":change:animating",function(e){j.truncateLines(e.carousel.dom.$container)}),f.on("a:carousel:"+e[i]+":change:loading",function(e){j.truncateLines(e.carousel.dom.$container)}),f.on("a:carousel:"+e[i]+":change:pageSize",function(e){j.truncateLines(e.carousel.dom.$container)})})})(m,document,m.ueLogError);l.when("jQuery","A","a-checkbox","p13n-sc-util","p13n-sc-call-on-visible","p13n-sc-logger").execute("sims-fbt",function(e,f,j,i,g,k){function h(c){var d=
this,b=c.data("sims-fbt-instance");if(b)return b;c.data("sims-fbt-instance",d);d.hasLazyInitialized=!1;e(".sims-fbt-checkbox input").show();d.$fbtRootElement=c;d.$detailsLinkText=d.$fbtRootElement.find(".sims-fbt-details-link a");d.auiCheckboxes=[];b=this.$fbtRootElement.find("div.sims-fbt-checkbox");this.numOfItems=b.length;for(var a=0;a<this.numOfItems;a++)this.auiCheckboxes[a]=j(b[a]),this.auiCheckboxes[a].check();f.declarative.remove(d.$detailsLinkText,"details-link-click");f.declarative.remove(e(".sims-fbt-details-help-link"),
"help-link-click");f.declarative.create(d.$detailsLinkText,"details-link-click");f.declarative.create(e(".sims-fbt-details-help-link"),"help-link-click");var h=e("#sims-fbt-container");g.register(c,function(){k.logAction({featureElement:h,action:"view",replicateAsinImpressions:!0,meta:{numsims:d.numOfItems}})});return d}h.prototype={lazyInitialize:function(){if(!this.hasLazyInitialized){this.$priceBlock=this.$fbtRootElement.find(".sims-fbt-price-box");this.$totalPriceDiv=this.$priceBlock.find(".sims-fbt-total-price");
this.$addToCartButton=this.$priceBlock.find(".sims-fbt-add-to-cart");this.$addToWishlistButton=this.$priceBlock.find(".sims-fbt-add-to-wishlist");this.$sellerInfo=this.$fbtRootElement.find(".sims-fbt-seller-info");this.$detailsText=this.$fbtRootElement.find(".sims-fbt-shipping-details-text");this.haveDetails=this.$detailsText.length!==0;try{this.FBTData=f.state("sims-fbt")}catch(c){i.log.error("[sims-fbt] Unable to find Data Attribute (page state) "+c);return}this.images=[];this.plusSigns=[];for(var d=
0;d<this.numOfItems;d++)this.images[d]=this.$fbtRootElement.find(".sims-fbt-image-"+(d+1)),d>0&&(this.plusSigns[d]=this.$fbtRootElement.find(".sims-fbt-plus-"+(d+1)));this.hasLazyInitialized=!0}},toggleSellerInfo:function(){this.lazyInitialize();var c=this.$sellerInfo.is(":hidden");if(!c){var d=this.$fbtRootElement.find(".sims-fbt-checkbox-label");this.$sellerInfo.hide();this.$sellerInfo.promise().done(function(){d.each(function(){e(this).css("opacity",parseFloat(e(this).css("opacity"))-0.01)});setTimeout(function(){d.css("opacity",
"")},20)})}this.updateSellerText(c);c&&this.$sellerInfo.show(200)},handleCheckboxChange:function(c){var d=c.$declarativeParent,b=c.data,a=parseInt(b.itemNum,10);this.lazyInitialize();this.auiCheckboxes[a-1].disable();c=this.$priceBlock;this.auiCheckboxes[a-1].isUnchecked()&&(c=c.add(this.handleItemUnchecked(d,b,a)));var e=this;c.fadeOut(function(){e.handleItemChecked(d,b,a)})},handleItemChecked:function(c,d,b){this.updateButtons(c);this.updateTotalPrice(c);this.updateSellerText(this.$sellerInfo.is(":visible"));
if(this.findFirstCheckedItem()>=0){d=this.$priceBlock;this.auiCheckboxes[b-1].isChecked()&&(c.find(".sims-fbt-checkbox-label").removeClass("sims-fbt-unselected-item"),c=this.findFirstVisibleItem(),c>=1&&(b>c?d=d.add(this.plusSigns[b-1]):b<c&&(d=d.add(this.plusSigns[c-1]))),d=d.add(this.images[b-1]));var a=this;d.fadeIn(function(){a.auiCheckboxes[b-1].enable()})}else this.auiCheckboxes[b-1].enable()},handleItemUnchecked:function(c,d,b){c.find(".sims-fbt-checkbox-label").addClass("sims-fbt-unselected-item");
c=this.images[b-1];b>1&&(c=c.add(this.plusSigns[b-1]));b=this.findFirstCheckedItem();b>1&&(c=c.add(this.plusSigns[b-1]));return c},findFirstVisibleItem:function(){for(var c=1;c<=this.numOfItems;c++)if(this.images[c-1].is(":visible"))return c;return-1},findFirstCheckedItem:function(){for(var c=1;c<=this.numOfItems;c++)if(this.auiCheckboxes[c-1].isChecked())return c;return-1},updateButtons:function(){for(var c=this.getOfferListingIDsSeletected(),d=1,b="preOrderText",a=c.length-1;a>=0;a--)if(!this.FBTData.itemDetails[c[a]].isPreorder){b=
"addToCartText";d=0;break}d?this.$addToCartButton.removeClass("a-button-primary").addClass("a-button-preorder"):this.$addToCartButton.removeClass("a-button-preorder").addClass("a-button-primary");c.length>=1?(this.$addToCartButton.find(".a-button-text").text(this.FBTData[b][c.length]),this.$addToCartButton.attr("disabled")&&(this.$addToCartButton.removeClass("a-button-disabled"),this.$addToCartButton.removeAttr("disabled")),this.$addToWishlistButton.find(".a-button-text").text(this.FBTData.addToWishListText[c.length]),
this.$addToWishlistButton.attr("disabled")&&(this.$addToWishlistButton.removeClass("a-button-disabled"),this.$addToWishlistButton.removeAttr("disabled"))):(this.$addToCartButton.find(".a-button-text").text(this.FBTData.addToCartText[1]),this.$addToCartButton.addClass("a-button-disabled"),this.$addToCartButton.attr("disabled","disabled"),this.$addToWishlistButton.find(".a-button-text").text(this.FBTData.addToWishListText[1]),this.$addToWishlistButton.addClass("a-button-disabled"),this.$addToWishlistButton.attr("disabled",
"disabled"))},updateTotalPrice:function(){var c=this.getOfferListingIDsSeletected(),d=0,b=0,a=0,e=0;if(c.length===0)this.$totalPriceDiv.hide();else{for(var f=0;f<c.length&&!e;f++){if(this.FBTData.itemDetails[c[f]].doesMAPPolicyApply){e=1;break}else isFinite(this.FBTData.itemDetails[c[f]].price)&&(d+=parseFloat(this.FBTData.itemDetails[c[f]].price,10));isFinite(this.FBTData.itemDetails[c[f]].points)&&(b+=parseInt(this.FBTData.itemDetails[c[f]].points,10),a+=parseFloat(this.FBTData.itemDetails[c[f]].pointsValue,
10))}this.$totalPriceDiv.show();c=this.$totalPriceDiv.find(".sims-fbt-total-price-value");e?(c.html(this.FBTData.MAPText),c.removeClass("a-color-price").addClass("sims-fbt-map-text").addClass("a-size-base")):(e=this.FBTData.currencySymbol,e+=this.formatPrice(d),c.html(e),c.removeClass("sims-fbt-map-text").addClass("a-color-price").removeClass("a-size-base"));e=this.$totalPriceDiv.find(".sims-fbt-points-wrapper");b>0?(d=parseInt(a*100/d+0.5,10),a=e.find(".sims-fbt-points-value"),c=e.find(".sims-fbt-points-percentage"),
a.html(b),c.html(d),e.show()):e.hide()}},getOfferListingIDsSeletected:function(){var c=[];e("input",".sims-fbt-checkbox").each(function(){this.checked&&c.push(this.value)});return c},formatPrice:function(c){for(var d=(c-parseInt(c,10)).toFixed(2),d=d.replace("0.","."),b=parseInt(c,10),a=0;b>0;){var e=b%10,b=parseInt(b/10,10),d=e.toString()+d;a++;a%3===0&&b>0&&(d=","+d)}this.FBTData.currencyCode==="EUR"?(d=d.replace(/,/,"+"),d=d.replace(/\./,","),d=d.replace(/\+/,".")):this.FBTData.currencyCode===
"JPY"&&(d=d.replace(".00",""));Math.abs(c)<1&&(d="0"+d);return d},updateSellerText:function(c){var d="",b="",a="",a=0;if(this.haveDetails){for(b=1;b<=this.numOfItems;b++)this.auiCheckboxes[b-1].isChecked()&&(d+=b,a++);b=a===0?this.getString("noDetails"):a===1?"":this.FBTData.shippingDetails[d]==="seller"?this.getString("differentSellers"):this.FBTData.shippingDetails[d]==="availabilityone"?this.getString("differentAvailabilityOne"):this.FBTData.shippingDetails[d]==="availabilitysome"?this.getString("differentAvailabilitySome"):
"";a=a===0?"":b===""?this.getString(c?"hideDetailsLong":"showDetailsLong"):this.getString(c?"hideDetails":"showDetails");b!==this.$detailsText.text()&&this.$detailsText.text(b);a!==this.$detailsLinkText.text()&&this.$detailsLinkText.text(a)}},getString:function(c){return this.FBTData&&this.FBTData.fbtStrings?this.FBTData.fbtStrings[c]:n}};(function(){function c(){return e("#sims-fbt-content").data("sims-fbt-instance")}function d(){var b=e("#sims-fbt-content");b.length&&new h(b)}f.declarative("help-link-click",
"click",function(b){b.$event.preventDefault();m.open(b.$event.target.href,"AmazonHelp","width=550,height=550,resizable=1,scrollbars=1,toolbar=0,status=0").focus();return!1});f.declarative("details-link-click","click",function(b){b.$event.preventDefault();(b=c())&&b.toggleSellerInfo()});f.declarative("fbt-checkbox-click","change",function(b){var a=c();a&&a.handleCheckboxChange(b)});f.state.bind("sims-fbt",d);f.on("afterReady",d)})()});l.when("jQuery","A","p13n-sc-call-on-visible").execute("sims-client-side-weblab",
function(e,f,j){function i(f){var h=0,c={cache:!0,crossDomain:!1,data:e.param(f,!1),error:function(b){b=b.status||0;h>=3||b>=400&&b<500||setTimeout(d,200*Math.pow(2,h))},global:!1,url:"/gp/similarities/record.html"},d=function(){h+=1;e.ajax(c)};d()}function g(){var g={"#view_to_purchase-sims-feature":"view_to_purchase-sims-weblab-state"},h;for(h in g)if(g.hasOwnProperty(h)){var c=e(h);c.length>0&&j.register(c,function(){var c=f.state(g[h]);c&&i(c)})}}f.on("ready a:pageUpdate",function(){g()})});l.when("A",
"jQuery","p13n-sc-call-on-visible","p13n-sc-logger").execute("sims-vtp-logger",function(e,f,j,i){var g=f(".vtp-container");g.length>0&&j.register(g,function(){i.logAction({featureElement:g,action:"view",replicateAsinImpressions:!0})})})})})(function(){var l=window.AmazonUIPageJS||window.P,m=l._namespace||l.attributeErrors;return m?m("SimilaritiesUDPTransistionAssets"):l}(),window);
/* ******** */
(function(e){e.execute(function(){e.when("jQuery","cf").register("beauty-recommendations-cf",function(a){function c(d,b){for(var q="bRec"+(d?"Vert":"Horiz")+"ImgHolder",h,e,c=0;c<f;c++)h=q+c,h=a("#"+h),e=a("#bRecImg"+c),b?n(e,b[c],h):e.detach().appendTo(h)}function e(d){for(var d="bRec"+(d?"Vert":"Horiz")+"CheckHolder",b,c,h=0;h<f;h++)b=d+h,b=a("#"+b),c=a("#bRecCheckOuter"+h),c.detach().appendTo(b)}function i(a,d){var b,c;b=d.offset();c=a.offset();return{top:c.top-b.top,left:c.left-b.left}}function n(a,
d,c){b.css("position","relative");a.css("left",d.left);a.css("top",d.top);a.css("position","absolute");a.detach().appendTo(b);setTimeout(function(){var d=i(c,b);a.animate({left:d.left,top:d.top},250,"swing")},1);setTimeout(function(){a.detach().appendTo(c);a.css("position","static");b.css("position","static")},400)}function l(){for(var d,c=[],e=0;e<f;e++)d=a("#bRecImg"+e),d=i(d,b),c.push(d);return c}var f,b,j,k,d,o,m,g;return{init:function(){f=a(".bRecVerticalContent").length;b=a("#beautyRecommendations");
j=a("#bRecHorizontalView");k=a("#bRecVerticalView");d=a("#bRecToggle");o=a("#useWithDot");m=!0;g=!1;if(f>1){k.hide();m=!1;j.show();g=!0;c(!1,null);e(!1);for(var i=0;i<f;i++)a("#bRecCheckbox"+i).prop("checked",!0);d.css("visibility","visible");d.click(function(d){a.get(a(this).data("foresterurl"));var b=l();g?(j.hide(),g=!1,k.fadeIn(400,function(){m=!0}),c(!0,b),e(!0)):m&&(k.hide(),m=!1,j.fadeIn(400,function(){g=!0}),c(!1,b),e(!1));d.preventDefault()});o.click(function(){d.click()})}}}});e.when("A",
"jQuery","ready").register("beauty-recommendations-ready",function(a,c){function e(a){switch(a){case 0:return b.bRecCart1;case 1:return b.bRecCart2;case 2:return b.bRecCart3;case 3:return b.bRecCart4;default:return b.bRecCart1}}function i(a){switch(a){case 0:return b.bRecWish1;case 1:return b.bRecWish2;case 2:return b.bRecWish3;case 3:return b.bRecWish4;default:return b.bRecWish1}}function n(a){switch(a){case 0:return b.bRecPrice1;case 1:return b.bRecPrice2;case 2:return b.bRecPrice3;case 3:return b.bRecPrice4;
default:return b.bRecPrice1}}function l(){for(var a=0,b,f,g=0;g<j;g++)f=c("#bRecImg"+g),(b=c("#bRecCheckbox"+g).prop("checked"))?(a++,f.removeClass("bRecDisabled")):f.addClass("bRecDisabled");c("#bRecAddToCart").find("span.a-button-text").text(e(a));c("#bRecAddToList").find("span.a-button-text").text(i(a));c("#bRecPriceLabel").text(n(a));a="";for(b=0;b<j;b++)a+=c("#bRecCheckbox"+b).prop("checked")?"1":"0";a=parseInt(a,2);a=k[a];c("#bRecPrice").text(a)}var f,b,j,k;return{init:function(){var d=c("#bRecDataDiv").find("script").html();
f=d?c.parseJSON(d):a.state("beautyRecommendations");b=a.state("bRecDynamicStrings");if(f){j=f.numRecommendations;k=f.possibleSums;for(d=0;d<j;d++)c("#bRecCheckbox"+d).change(l);c("#bRecPricePara").removeClass("a-hidden");l()}}}})})})(function(){var e=window.AmazonUIPageJS||window.P,a=e._namespace||e.attributeErrors;return a?a("BeautyRecommendationAssets"):e}(),window);
/* ******** */
(function(g){g.execute(function(){g.when("A","a-carousel-framework","a-carousel-ajax-standard").register("AmazonClicks",function(a,k,m){var o=a.extend([],m);o.getItems=function(a,f,b){var d=a.getAttr("pageNumber");a.getAttr("pageSize");var i=a.getAttr("fetchedItems"),g=JSON.parse("["+a.getAttr("initialSeenAsins")+"]"),c="[",h;for(h=0;h<g.length;h++)c+='"'+g[h]+'",';c=c.substring(0,c.length-1);for(h=0;h<i.length;h++)typeof i[h]==="object"&&c.indexOf(i[h].oid)===-1&&(c+=',"'+i[h].oid+'"');c+="]";b.pg=
d;b.tot=a.getAttr("set_size");b.start=b.offset;b.num=b.count;b.cc=d===1?0:b.offset;b.oData=c;m.getItems(a,f,b)};k.registerStrategy("ajax","clicksCustomAjax",o);return{registerCustomAjax:function(e,f,b){f=a.extend([],m);f.getItems=function(a,d,c){var e=a.getAttr("pageNumber");a.getAttr("pageSize");var f=a.getAttr("fetchedItems"),g="[",j;for(j=0;j<b.length;j++)g+='"'+b[j]+'",';g=g.substring(0,g.length-1);for(j=0;j<f.length;j++)typeof f[j]==="object"&&g.indexOf(f[j].oid)===-1&&(g+=',"'+f[j].oid+'"');
g+="]";c.pg=e;c.tot=a.getAttr("set_size");c.start=c.offset;c.num=c.count;c.cc=e===1?0:c.offset;c.oData=g;m.getItems(a,d,c)};var e=k.getCarouselByName(e+"_carousel"),d=e.getAttr("ajax");d.prefetch_next_page=!1;e.setAttr("circular",!1);e.setAttr("ajax",d);e.strategies.ajax=f},registerFeedbackEvents:function(e,f,b,d,g){var k=!0,c=function(){a.$("#"+f).text(d);k=!1;a.$("."+g).each(function(){a.$(this).show()})},h=function(){a.$("#"+f).text(b);k=!0;a.$("."+g).each(function(){a.$(this).hide()})};a.$("#"+
f).click(function(){k?c():h()});a.on("a:carousel:"+e+":change:pageNumber",h);h()},lazyLoadCarousel:function(e,f,b){var d=a.$("#"+e),i=function(){g.when("A","a-carousel-framework").execute(function(a,c){if(a.onScreen(d,800)){var e=d.width(),g=d.offset().top;a.off("scroll",i);a.get(f+"&bWidth="+e+"&yPos="+g.toFixed(0),{success:function(a){c.onInit(b,function(){var b=d.find(".a-carousel-container");b!==void 0&&c.kill(b);d.html(a)});c.createAll()},error:function(){c.onInit(b,function(){d.html("")})}})}})};
a.on("scroll",i);i()},truncateTitles:function(e){a.$("."+e).each(function(){var f=a.$(this);if(f.css("overflow")==="hidden"){var b=f.html(),d=a.$(this.cloneNode(!0)).hide().css("position","absolute").css("overflow","visible").width(f.width()).height("auto");f.after(d);for(d.html(b);b.length>0&&d.height()>f.height();)b=b.substr(0,b.length-1),d.html(b+"&#133;");f.html(d.html()).height("auto").removeClass(e);d.remove()}})}}})})})(function(){var g=window.AmazonUIPageJS||P,a=g.attributeErrors;return a?
a("ProductAdsDetailPageAssets"):g}());
/* ******** */
(function(b){b.execute(function(){b.when("jQuery","jumpLink").execute(function(b,a){var k=b("#miniATFUDP"),f=0;k.length>0&&(f=k.height()+9);window.isACRJumplLinkAnimated===1?a.bind("#acrCustomerWriteReviewLink, #acrCustomerReviewLink, #reviewLink, #reviewLinkShort, #reviewCreateLink",1E3,f):window.isACRJumplLinkAnimated===2?a.bind("#acrCustomerWriteReviewLink, #acrCustomerReviewLink, #reviewLink, #reviewLinkShort, #reviewCreateLink",1200,f):window.isACRJumplLinkAnimated===3?a.bind("#acrCustomerWriteReviewLink, #acrCustomerReviewLink, #reviewLink, #reviewLinkShort, #reviewCreateLink",
1400,f):window.isACRJumplLinkAnimated===4?a.bind("#acrCustomerWriteReviewLink, #acrCustomerReviewLink, #reviewLink, #reviewLinkShort, #reviewCreateLink",10,f):k.length>0&&(f=k.height()+9,a.bind("#acrCustomerWriteReviewLink, #acrCustomerReviewLink, #reviewLink, #reviewLinkShort, #reviewCreateLink",10,f))});b.when("A","jQuery","ImageBlockATF","jumpLink").register("miniATFUtils",function(l,a,k,f){function u(d){o&&!d||p||(d=(new Date).getTime()-v,d=d<50?50-d:10,o=1,o=0,v=(new Date).getTime(),setTimeout(function(){var d=
m.scrollTop(),b=a("#miniATFUDP");if(b.length>0){var c=w;if(c==="T1"){c=a("#sims_fbt");if(c.length<=0||c.height()<=0)c=a("#buyxgety_feature_div");var g=c,c=Number.MAX_VALUE;if(g&&g.length>0){var i=g.height(),g=g.offset();i&&g&&(c=g.top+i)}c=Math.min(c,y)}else if(c==="T2"){c="#product-details-grid_feature_div,#prodDetails,#important-information_feature_div,#importantInformation,#detail-bullets,#detail_bullets_id,#technical-data,#technicalSpecifications_feature_div,#productDescription,#product-description-iframe,#dpx-btf-hlcx-comparison_feature_div,#HLCXComparisonWidget_feature_div".split(",");
g=Number.MAX_VALUE;for(i=0;i<c.length;i++){var e=a(c[i]);if(e&&e.length>0&&e.height()>0){var h;h=Number.MAX_VALUE;if(e&&e.length>0&&(e=e.offset()))h=e.top;h<g&&(g=h)}}c=Math.min(g,z)-100}else c=void 0;d>c?!q&&b.is(":hidden")&&(b.removeClass("a-hidden"),b.slideDown(A)):(b.slideUp(B),q=0)}},d))}var r=a("#miniATFUDP"),x=a("#miniATFPartialSelection")[0],j=a(".twister-dropdown-highlight")[0];if(!(r.length<=0)){var m,q=0,v=0,o=0,n={},p=0,B=200,A=200,y=1200,z=1700,s=0,w="T1";n.setMiniATFShowHeight=function(a){w=
a};n.setMiniATFScrollUpHeight=function(d){s=0;d==="T1"&&(d=a("#productTitle"),d.length>0&&(d=d.offset())&&(s=d.top-20))};a("body").delegate(".go-to-top","click",function(){a("body, html").animate({scrollTop:s},300);q=1;x&&j&&(a(j).removeClass("transparentTwisterDropdownBorder"),a(j).addClass("highlightTwisterDropdownBorder"));return!1});x&&j&&a(j).click(function(){a(this).addClass("transparentTwisterDropdownBorder");a(this).removeClass("highlightTwisterDropdownBorder")});m=a(window);m.scroll(function(){u(0)});
m.resize(function(){u(1)});var t=0;r.length>0&&(t=r.height()+9,f.bind("#seeMoreDetailsLink",300,t),f.bind("#HLCXComparisonJumplinkLink",300,t));b.when("ImageBlockBTF","imageBlockUtils").execute(function(d){var b=function(h){var c=h.getState().selected_variations;if(c){var b="",f=h.getState().variation_display_labels;a.each(d.visualDimensions,function(a,h){var g=d.gIsNewTwister===1?h:f[h];c[g]&&(b+=" "+c[g])});return b&&b.substring(1)}},f=d.defaultColor,c=f,g=d.landingAsinColor,i,e=a("#miniATF_image");
e.length>0&&(i=e.attr("src"));n.updateMiniATFDiv=function(){p=0;var h=a("#miniATF_image");h.length>0&&i&&h.attr("src",i)};l.on("image-block-twister-swatch-click",function(a,e,l,j){p=1;a=(a=j?j:b(e))&&a!==""?a:f;a===g&&(a=f);a!==c&&(i=(e=a!==f&&a!==g?d:k)&&e.colorImages&&e.colorImages[a]&&e.colorImages[a].length>0&&e.colorImages[a][0]?e.colorImages[a][0].large:null,c=a)})});return n}});b.when("ueCount","jQuery").execute(function(b,a){a("#miniATF_BackToTopLink").click(function(){b.incrementCounterByOne("sl_back_to_top_button_click_count")})})})})(function(){var b=
window.AmazonUIPageJS||P,l=b.attributeErrors;return l?l("CommonDetailPageScripts"):b}());
/* ******** */
(function(a){a.execute(function(){a.when("A","jQuery").register("jumpLink",function(a,c){return{bind:function(a,e,f){try{e=e||1E3,f=f||0,c("body").delegate(a,"click",function(b){try{var g=c(a);if(g.get(0)){var d=g.attr("href");d&&d.charAt(0)==="#"&&c(d).length!==0&&(b.preventDefault(),c("html, body").animate({scrollTop:c(d).offset().top-f},e))}}catch(h){window.ueLogError&&window.ueLogError(h,{logLevel:"FATAL",attribution:"jumpLink",message:"[JumpLink - Error in executing click handler]"})}})}catch(b){window.ueLogError&&
window.ueLogError(b,{logLevel:"FATAL",attribution:"jumpLink",message:"[JumpLink - Error in binding click handler]"})}}}})})})(function(){var a=window.AmazonUIPageJS||P,b=a.attributeErrors;return b?b("DetailPageCommonScripts"):a}());
/* ******** */
(function(f){f.execute(function(){f.when("A","jQuery","a-carousel-framework","a-carousel-ajax-standard","ready").execute("bundle-discoverability-widget",function(c,d,j,k){function l(a,h,e){e._=c.now();a.triggerEvent("beforeAjax",{url:h,params:e});c.get(h,{success:function(b){(!b||!b.length)&&f.error("Carousel requires a set_size and none was returned by the fallback AJAX request","a-carousel-ajax-standard","sendRequest");var c=b[0].setSize?b[0].setSize:b.length;a.setAttr(m,c);for(var g=a.getAttr(i),
d;(d=b.pop())!==void 0&&e.offset+b.length<c;)g[e.offset+b.length]=d;if(g.length===c)for(b=c;b<n;++b)g[b]||(g[b]="&nbsp;");e.needSetSize&&a.init();a.setAttr(i,g);a.setAttr(o,!1);a.getAttr(p)>=g.length&&a.strategies.ajax.wantCurrentPage(a);a.triggerEvent("ajaxSuccess",{url:h,params:e})},params:e})}var i="fetchedItems",p="pageSize",m="set_size",o="ajaxLock",n=15,d=c.extend({},k);d.getItems=function(a,d,e){var b=a.getAttr("ajax");a.setAttr("requestTimer",c.delay(l,b.fetch_delay,a,d,e))};d.afterInit=function(a){a.strategies.ajax.wantCurrentPage(a);
a.onChange("pageNumber",function(d,e){var b=a.getAttr("ajax");d>e?(a.strategies.ajax.wantNextPage(a),c.get(b.nextPageReftagUrl,{})):(a.strategies.ajax.wantPrevPage(a),c.get(b.prevPageReftagUrl,{}))})};j.registerStrategy("ajax","bundle-discoverability",d)})})})(function(){var f=window.AmazonUIPageJS||P,c=f.attributeErrors;return c?c("ProductBundleUIAssets"):f}());
/* ******** */
(function(i,h,H){i.execute(function(){i.when("A","a-popover","cf").register("add-to-wish-list",function(c,e){var j,w,k;function p(){d("#wishListDropDown").removeClass("a-button-selected");d("#wishListMainButton").removeClass("a-button-selected")}function n(a){c.state("atwl",d.extend(c.state("atwl")||{},a))}function i(){return(c.state("atwl")||{}).dropDownHtml}function x(){n({dropDownHtml:""})}function t(){var a=d("#atwl-dd-ul").parent();if(a&&a.get(0)){var b=a.get(0).scrollHeight,c=a.height(),a=2*
parseInt(a.css("padding-top"),10);return b>c+a}return!1}function I(){return parseInt(d.browser.version,10)<9&&document.body&&document.body.parentElement?!(!document.body.parentElement.scrollLeft&&!document.body.parentElement.scrollTop):!1}function J(a){a.find(".a-button-close").hide();a.find(".a-popover-content").css({"margin-right":"0px"});a.css({padding:"0"});a.find(".a-popover-inner").css({padding:"0"});setTimeout(function(){a.removeClass("a-arrow-bottom");d("#atwl-rich-content").css({"margin-bottom":"0px",
width:"auto"});if(d.browser.msie){var b=c.state("atwl")||{},g=d("#"+b.wishlistButtonSubmitId),b=g.offset(),B=g.height(),g=b.left,b=b.top+B;I()&&(g+=document.body.parentElement.scrollLeft,b+=document.body.parentElement.scrollTop);t()&&(g-=17);a.css({left:g+"px",top:b+"px"})}},50)}function u(){if(y){var a=e.get(y);a&&a.hide()}}function C(a){d("#"+a).children().first().width(j);u();if(e){var b=e.get(y),g=c.state("atwl")||{},b=b?e.get(y):e.create(d("#add-to-wishlist-button-group"),{content:d("#"+a).html(),
name:"atwl",skin:function(a){return a},activate:"onmouseclick",width:j,position:g.dropDownPosition||"triggerBottom"});b.update({width:j,content:d("#"+a).html()});y=b.id;b.show().updatePosition();J(b.$popover)}}function D(){p();K++;u();C("atwl-dd-error-holder")}function T(){u();var a=c.state("atwl")||{};return K>=a.maxAjaxFailureCount}function L(){var a=c.state("atwl")||{};return e.create(d("#add-to-wishlist-button-group"),{content:i(),name:"atwl",skin:function(a){return a},activate:"onmouseclick",
position:a.dropDownPosition||"triggerBottom"})}function U(a){var b;b=I()?50:0;setTimeout(function(){var b=d("#atwl-popover-inner"),c=b.width();t()?c+=w:d(".atwl-dd-list-name").each(function(){var a=d(this);a.width(a.width()+k)});var f=a.find("ul li a.a-active").first();f.css("margin-left","1px");f.parent().focus();b.width(c)},b)}function V(a){a.update({content:i(),width:"auto"});a.show();J(a.$popover);U(a.$popover)}function M(){var a=e.get("atwl");if(a)if(a.isActive()){a.hide();return}else e.remove(a);
else a=L(),e.remove(a);a=L();V(a);c.capabilities.touch&&setTimeout(function(){var a=d("#wishlistButtonStack"),c=a.clone(),B=a.parent();a.remove();B.append(c)},300)}function z(){var a=e.get("atwl");a&&a.isActive()&&a.hide()}function W(a){p();u();var b;try{b=c.parseJSON(a)}catch(g){D();return}typeof b.html!=="undefined"&&b.css!=="undefined"?(n({dropDownHtml:b.html}),a=b.css,d("body").append(a),M()):D()}function X(a){if(a&&a.promoEnabled){var b=a.html;if(b){var d=e.create(E.parent(),{name:"kbpPromoPopover",
content:b,position:"triggerBottom",width:a.width});d.show().lock();c.delay(function(){var a=(c.state("atwl")||{}).kbpPromo||{};a.mouseOver?a.countDown=!0:(d.unlock().hide(),e.remove(d));c.state("atwl",{kbpPromo:a})},1E4)}}}typeof c.state.parse!=="undefined"&&c.state.parse();var r=c.state("popoverState")||{},F="#"+(r.formId||"addToCart");h.setRegistryId=function(a){var b=d(F);b.find("[name='sourceCustomerOrgListID'],[name='colid'],[name='wlPopCommand']").attr("value",a);b.find("[name='submit.add-to-registry.wishlist'],[name='submit.add-to-wishlist']").eq(0).click();
return!1};var A=[];if(r.showWishListDropDown||r.showBabyRegDropdown||r.isAddToWishListDropDownAuiEnabled||r.showPopover){var d=c.$;if(r.showWishListDropDown||r.showBabyRegDropdown){var v,N=function(){var a=function(a){if(!a.data("wired")){a.data("wired",!0);a[0].name="";if(a.css("cursor")!=="not-allowed"){var b=a.attr("data-type"),c=r.wishlistPopoverWidth;a.amazonPopoverTrigger({ajaxSlideDuration:0,align:"left",cacheable:!0,closeEventInclude:"CLICK_OUTSIDE",destination:"/gp/registry/reglist-popover.html?sprited=0&type="+
b,group:"addToWishlist",loadingContent:"<div style='padding: 4px 28px;'><img src='"+h.AmazonPopoverImages.loadingBar+"'/></div>",location:"bottom",locationElement:"#"+a[0].id,locationOffset:[0,-5],showOnHover:!1,skin:"<div id='wishlist-dropdown-content'><div class='ap_content'></div></div>",width:c,onFilled:function(a){d(document).click();a.width(c);h.wlPop&&setTimeout(function(){h.wlPop.onFill(a);a.width(c)},0)}})}v&&(clearInterval(v),v=H)}},b="#"+r.babyRegistryId;if(!r.isAddToWishListDropDownAuiEnabled){var g=
c.state("atwl")||{};b+=", #"+g.wishlistButtonId}d(b).each(function(){a(d(this))})};N();var s=function(){v&&clearInterval(v);v=setInterval(N,200)};d("#twister").change(s);c.declarative("swatchthumb-action","click",s)}if(r.isAddToWishListDropDownAuiEnabled){var y,K=0,s=c.state("atwl")||{},O=s.wireDeclaratives,P=d("#"+s.wishlistButtonId);P.addClass("a-declarative");P.attr("data-action","atwl-splitbutton-arrow");var E=d("#"+s.wishlistButtonSubmitId);E.addClass("a-declarative");E.attr("data-action","atwl-splitbutton-main");
d("#wishListMainButton").addClass("a-declarative").attr("data-action","add-wishlist-declarative");j=230;w=10;k=10;n({resetDropDownHtml:x});O||(c.declarative("atwl-splitbutton-arrow","click",function(a){a.$event.preventDefault();setTimeout(function(){p()},0);if(a.$target.css("cursor")==="not-allowed")return!1;if(T())return u(),u(),C("atwl-dd-unavail-holder"),!1;var b=i(),a=c.state("atwl")||{};if(!b||!b.length){C("atwl-dd-spinner-holder");var b=c.state("wishlistDPState")||{},g="website.wishlist.detail.add";
if(typeof b.vendorId!=="undefined")g=b.vendorId;a={url:"/gp/registry/atwl/popover.html?"+d.param({sortMethod:a.sortMethod||0,type:"wishlist",useAll:a.showAllTypes||0,sourceVendorId:g}),cache:!1,success:W,error:D};d.ajax(a)}else M();return!1}),c.declarative("atwl-dd","click",function(a){a.$event.preventDefault();var b=a.data,a=b.id,b=b.type;typeof b==="undefined"&&(b="wishlist");var c="pop_"+a+"_"+b,e=d(F+",#addToWL");e.find("[name='sourceCustomerOrgListID'],[name='colid'],[name='wlPopCommand']").attr("value",
c);e.find("[name='registryID']").attr("value",a);e.find("[name='registryType']").attr("value",b);n({inSubmit:!0});e.find("[name='submit.add-to-registry.wishlist'],[name='submit.add-to-wishlist']").eq(0).click();z();return!1}),c.declarative("atwl-kbp-landing","click",function(a){var b=a.data,a=d(F).find("#ASIN").val(),b=b.url;b+="&asin="+a;h.open(b);return!1}));if((s=c.state("atwl")||{})&&s.sortMethod==="kbp")c.state("atwl",{kbpPromo:{mouseOver:!1,countDown:!1}}),c.ajax("/gp/toys/birthday/atwl-dpx.html",
{method:"get",cache:!1,params:{isAUI:1},success:X,error:function(){}}),O||(c.declarative("atwl-kbp-promo-mouseover","mouseleave",function(){var a=(c.state("atwl")||{}).kbpPromo;a.mouseOver=!1;if(a.countDown){var b=e.get("kbpPromoPopover");b&&(b.unlock().hide(),e.remove(b))}c.state("atwl",{kbpPromo:a})}),c.declarative("atwl-kbp-promo-mouseover","mouseenter",function(){var a=(c.state("atwl")||{}).kbpPromo;a.mouseOver=!0;c.state("atwl",{kbpPromo:a})}),c.on("a:popover:hide:kbpPromoPopover",function(){var a=
e.get("kbpPromoPopover");a.unlock().hide();e.remove(a)}));n({wireDeclaratives:!0})}if(r.showPopover){var Q=function(a,b){var d=document.getElementById(r.formId||"addToCart");if(typeof d==="undefined"||d===null)d=document.getElementById("addToWL");var e=[];if(typeof d!=="undefined"&&d!==null){var e=[],f=!1,m=d.elements;m||(m=d.querySelectorAll("input"),f=!0);for(var o=0;o<m.length;o++){var q;if(!(q=f)){q=m[o];var h=/^(?:checkbox|radio)$/i,j=/^(?:submit|button|image|reset|file)$/i,n=/^(?:input|select|textarea|keygen)/i;
if(q){var k=q.type;q=q.name&&!q.disabled&&n.test(q.nodeName)&&!j.test(k)&&(q.checked||!h.test(k))}else q=!1}q&&e.push(m[o])}}f={};m=c.state("wishlistDPState")||{};if(typeof m.asin!=="undefined"&&m.asin!==null)f.asin=m.asin;for(o=0;o<e.length;o++)if(e[o].type!=="submit")f[e[o].name]=e[o].value;f.requestedQty=f.quantity=d!==null&&typeof d.quantity!=="undefined"?d.quantity.value:1;f.sid=typeof f["session-id"]!=="undefined"?f["session-id"]:m.sid;f.cache=!1;f.url=m[a+"Url"];f.action=a;f.type=f.registryType||
"wishlist";if(a==="add")f.type=f.registryType||b,f.caller="aui",f.streaming=m.streaming,f.sourceVendorId=typeof m.vendorId!=="undefined"?m.vendorId:"website.wishlist.detail.add";else if(a==="create")f.create_sid=f.sid,f.create_type=f.registryType||b,f.create_nextAction="add",f.create_includeEmptyList=1,f.create_isFirst=m.isFirstCreate?1:0,f.caller="aui",f.create_sourceVendorId=typeof m.vendorId!=="undefined"?m.vendorId:"website.wishlist.detail.add";return f},G=function(a){var b=a.attr("name"),a=a.parents("form"),
b=d('<input type="hidden" />').attr("name",b).val("1");a.append(d(b));a.submit()},R=function(){var a=d("#add-wishlist-declarative").closest(".a-button").find("input");G(a)};c.capabilities.touch||d("#add-to-wishlist-button-submit").unbind("click").bind("click",function(a){a.preventDefault();if(d(this).css("cursor")==="not-allowed")return!1;var b="",b=c.state("wishlistDPState")||{},g=d("[name='wlPopCommand']").val(),a=h.currentType;if(g&&g!==""){g=g.split("_");a=g[2];if(a!=="wishlist"&&a!=="giftlist"&&
a!=="supplylist"||d("html").hasClass("a-lt-ie9")){R();return}b=g[1]==="new"?"create":g[1]==="default"&&b.isFirstCreate?"create":"add"}else if(a="wishlist",b=b.isFirstCreate?"create":"add",b==="add"&&d("html").hasClass("a-lt-ie9")){R();return}c.state("wishlistDPState",{action:b,type:a});h.currentType=a;d("#add-wishlist-declarative").trigger("click")});var S=function(){for(var a=["wlPopCommand","sourceCustomerOrgListID"],b=0;b<a.length;b++){var c=d('[name^="'+a[b]+'"]');c&&c.length&&c.val("")}};(c.state("wishlistDPState")||
{}).eventsBound||(c.on("a:popover:show:addCreateToWishlist",function(a){var b=a.popover,a=b.$popover,e=c.state("wishlistDPState")||{},j=e.action;a.addClass("pop-huc-"+j);var f=b.$trigger.closest(".a-button").find("input"),a=e.type;f.closest(".a-button-selected").removeClass("a-button-selected");var a=Q(j,a),e=a.url,m=a.streaming,o="ajax_"+m,q=new Date;h.ue&&h.uet("tc",o);var k=function(){b.hide();G(f)},n=function(){b.$popover.find("#popover-spinner").addClass("a-hidden");S()},w=function(){h.ue&&(h.uet("be",
o),h.uex("ld",o))},p=function(a,b,c){h.ue&&(h.ues("id",o,a),h.ues("t0",o,b),h.ues("ctb",o,c))};if(j==="create"||!m)c.ajax(e,{method:"post",params:a,success:function(a){a&&a.html?(p(a.requestId,q,"1"),a.status&&a.status==="no-asins"?k():(n(),j==="add"?b.$popover.find("#WLHUC_result").html(a.html).removeClass("a-hidden"):(b.$popover.find("#WLNEW_main").html(a.html).removeClass("a-hidden"),(a=c.state("atwl")||{})&&a.resetDropDownHtml&&a.resetDropDownHtml()),b.updatePosition()),w()):(j==="create"&&G(f),
b.hide())},error:k});else{var l=new XMLHttpRequest;l.open("GET",a.url+"&"+c.$.param(a),!0);l.send(null);var i=0;l.ontimeout=k;l.onerror=k;l.onreadystatechange=function(){try{if(l.readyState>2&&typeof l.status!=="unknown"&&l.status===200&&(typeof l.response!=="undefined"||typeof l.responseText!=="unknown"&&typeof l.responseText!=="undefined")){var a=[];typeof l.response!=="undefined"&&l.response!==null?a=l.response.split(",,,"):typeof l.responseText!=="unknown"&&typeof l.responseText!=="undefined"&&
l.responseText!==null&&(a=l.responseText.split(",,,"));for(var f=i;f<a.length;f++){var e=a[f],g;try{g=c.parseJSON(e)}catch(j){i=f;break}f===0&&g&&g.name==="skeleton"?g&&g.html&&(p(g.requestId,new Date,"1"),g.status&&g.status==="no-asins"?k():(n(),b.$popover.find("#WLHUC_result").html(g.html).removeClass("a-hidden"))):g&&g.name&&g.html&&g.name==="pcomp"?d("#wishListMainButton").hasClass("a-hidden")||(d("#wishListMainButton,#add-to-wishlist-button-group").addClass("a-hidden"),z(),d("#wishlistButtonStack").append(g.html)):
g&&g.name&&g.html&&g.name!=="js"?(b.$popover.find("#"+g.name).html(g.html),f===1&&h.ue&&h.uet("cf",o)):g&&g.html&&b.$popover.find("#WLHUC_result").append(g.html);b.updatePosition()}l.readyState===4&&w()}else typeof l.status!=="unknown"&&l.status!==200&&k()}catch(q){k()}}}}),c.on("a:popover:beforeShow:addCreateToWishlist",function(a){var a=a.popover,b=c.state("wishlistDPState")||{};a.$popover.find("#popover-spinner").css({margin:"10% 40%"});a.$popover.find("#popover-spinner").removeClass("a-hidden");
a.$popover.find(".wlAddCreatePop").html("").addClass("a-hidden");var d=b.action;a.update({width:b[d+"Width"],header:b[d+"Header"],height:b[d+"Height"]});a.updatePosition()}),c.on("a:popover:hide:addCreateToWishlist",function(){d(".a-modal-scroller").css({visibility:"hidden"});S()}),c.state("wishlistDPState",{eventsBound:!0}),c.declarative("add-wishlist-declarative",["click"],function(){var a=c.state("wishlistDPState")||{},b=Q(a.action,a.type),g=function(){d("#wishListMainButton,#add-to-wishlist-button-group").addClass("a-hidden");
z();d("#atwl-error-holder").removeClass("a-hidden")};d("#atwl-dd-no-title-holder").hasClass("a-hidden")||d("#atwl-dd-no-title-holder").addClass("a-hidden");var e=function(a){try{if(typeof a!=="undefined"){var b="";if(typeof a.pcompHtml!=="undefined"&&a.pcompHtml.trim()!=="")b=a.pcompHtml;else{g();return}d("#wishListMainButton").hasClass("a-hidden")||(d("#wishListMainButton,#add-to-wishlist-button-group").addClass("a-hidden"),z(),d("#atwl-output-holder").empty(),d("#atwl-output-holder").append(b),
d("#atwl-output-holder").removeClass("a-hidden"))}else g();for(b=0;b<A.length;b++)if(typeof A[b]==="function")A[b](a)}catch(c){g()}},f=function(a){var b=document.createElement("input");b.type="hidden";b.id=a;b.name=a;typeof d("#addItemForm")!=="undefined"&&d("#addItemForm").append(b);return b};if((typeof b.asin==="undefined"||b.asin.length===0)&&(typeof b.name==="undefined"||b.name.length===0))d("#atwl-dd-no-title-holder").removeClass("a-hidden");else if(a.custRecognized==="false"){if(a.asin===null){var a=
f("name.0"),b=f("imageUrl.0"),e=f("productUrl.0"),k=f("priceInput"),f=f("quantity.0");a.value=document.getElementById("name").value;b.value=document.getElementById("imageUrl").value;e.value=document.getElementById("productUrl").value;k.value=document.getElementById("price").value;f.value=1}d("#addItemForm").submit()}else c.ajax(b.url,{method:"get",dataType:"json",cache:!1,params:b,success:e,error:g})}))}}return{setPostAddSuccess:function(a){A.push(a)}}});i.when("A","a-modal","ready").execute(function(c,
e){var j=c.$,h=c.state("jumpstart-success-modal-state");h!==H&&!h.showDPHeadJavaScript&&h.showBabyRegSuccessModal&&h.hasBabyReg&&j(document).delegate("#add-to-registry-baby-button-submit","click",function(c){c.preventDefault();c=j("#is-fully-selected-baby-reg").val()==="true";if(typeof c!=="undefined"&&c!==null&&c){var c=j("#ASIN").val(),p=j("#rsid").val(),c={name:"baby-registry-add-success-modal",header:h.addSuccessModalHeader,url:"/gp/baby-reg/utils/RAW/raw-request.html/ref=br_js_asm?update=addSuccess&asin="+
c+"&sid="+p},p=j("#add-to-registry-baby-button-submit");e.create(p,c);e.get(j("#add-to-registry-baby-button-submit")).show()}})});i.when("A","b2b-lists-detail").execute(function(c,e){function h(){var e=c.$(i),j=c.$(k),x=c.$(p),t=1;e&&e.is(":visible")?t=e.val():j&&j.is(":visible")?t=j.val():x&&x.is(":visible")&&(t=x.val());return t}if(e.isEnabled()){var i="#free-form-quantity-dropdown",k="#quantity-update-text",p="#quantity";c.on("a:popover:beforeShow:add-to-business-list-modal",function(k){var i=
c.$("#ASIN").val();e.updateModal(k.popover,h(),i)})}});i.when("A","ready").register("b2b-lists-detail",function(c){function e(c,e,h){var i=RegExp("([?&])"+e+"=.*?(&|$)","i"),n=c;c.match(i)&&(n=c.replace(i,"$1"+e+"="+h+"$2"));return n}return{updateModal:function(h,i,k){var p=(c.state("businessListPageState")||{}).businessListUrl,n="";p&&(n=e(p,"quantity",i),n=e(n,"asin",k));h.update({url:n})},isEnabled:function(){return c.$("#add-business-list-button").length>0?!0:!1}}})})})(function(){var i=window.AmazonUIPageJS||
window.P,h=i._namespace||i.attributeErrors;return h?h("RegistryDPAssets"):i}(),window);
/* ******** */
(function(g,k){g.execute(function(){g.when("A","jQuery","softlines-utils","atf").register("looks-data-cache",function(f,a,b){var d=a("#multipleRecommendations"),g=[],c=!1,e=[];if(d.length>0){var k=d.attr("data-ids");if(b.isString(k)&&(f=f.parseJSON(k),a.isPlainObject(f)&&a.isArray(f.recommendations))){for(var f=f.recommendations,h=f.length,k=0;k<h;k++){var j=f[k];if(a.isPlainObject(j)&&a.isArray(j.asins)){var q=j.asins;if(a.isArray(q)){q=q.splice(0,Math.min(4,q.length));j.asins=q;e.push(j);for(var m=
q.length,l=[],j=0;j<m;j++){var n=q[j];a.isPlainObject(n)&&b.isString(n.asin)&&l.push(n.asin)}q=l.join();q=encodeURIComponent(q);g.push(q)}}}h>1&&(c=!0)}}var n=d.attr("data-asin"),o=d.attr("data-injectedViewModel");return{getLooks:function(){return e},getLooksAsins:function(){return g},getAsin:function(){return n},isShovelerArrowsEnabled:function(){return c},getInjectedViewModel:function(){return o}}});g.when("A","jQuery","recommendations-carousel-data","softlines-utils","looks-data-cache","atf").register("complete-the-look-carousel-data",
function(f,a,b,d,g){f=f.extend({},b);f.getProducts=function(){var b=[],e=g.getLooks(),f,h,j=e.length;for(f=0;f<j;f++)if(h=e[f],a.isPlainObject(h)&&a.isArray(h.asins)){var k=h.asins,m=k.length;for(h=0;h<m;h++){var l=k[h];a.isPlainObject(l)&&d.isString(l.asin)&&b.push(l.asin)}}return b};f.getDataSetType=function(){var b=g.getLooks(),e="";if(b.length>0&&(b=b[0],a.isPlainObject(b)&&a.isArray(b.asins)&&(b=b.asins,b.length>0&&(b=b[0],a.isPlainObject(b)&&d.isString(b.asinDataSetType)))))e=b.asinDataSetType;
return e};return f});g.when("jQuery","softlines-utils","looks-data-cache","atf").register("lookFeedback",function(f,a,b){function d(){l.length>0&&m.length>0&&(l.removeClass("visibleFeedbackBlock"),m.removeClass("hidden"),l.addClass("hidden"),m.addClass("visibleFeedbackBlock"));typeof Storage!=="undefined"&&localStorage.setItem(c,j)}function g(a){f.ajax({timeout:q,type:"GET",url:"/gp/softlines/logger/seed/"+k+"/look/"+e+("/ref=ctl_look_"+h+"_vote_"+a),data:{vote:a}})}var c,e,k=b.getAsin(),h,j="1",
q=4E3,m=f("#afterCtlFeedback"),l=f("#beforeCtlFeedback");f("#ctlButtonYes").click(function(){d();g("yes")});f("#ctlButtonNo").click(function(){d();g("no")});return{updateFeedback:function(a){h=a;a-=1;var d=b.getLooksAsins();a>=0&&a<d.length&&(e=d[a]);c=k+e;typeof Storage!=="undefined"&&(a=localStorage.getItem(c),l.length>0&&m.length>0&&(l.removeClass("hiddenFeedbackBlock"),a===j?(l.addClass("hidden"),m.removeClass("hidden"),m.addClass("visibleFeedbackBlock")):(l.removeClass("hidden"),l.addClass("visibleFeedbackBlock"),
m.addClass("hidden"))))}}});g.when("A","metrics-logger").register("csm-metrics-logger",function(f,a){var b=k.ue,d=f.extend({},a);d.addCount=function(a,c){var d=b.count(a)||0;b.count(a,d+c)};return d});g.when("jQuery","softlines-utils","looks-data-cache").register("ob-link-generator",function(f,a,b){return{getOutfitBuilderUrlForPageNumber:function(d){d-=1;var g,c=f("#outfitBuilder"),e=b.getLooksAsins();d>=0&&d<e.length&&c.length>0&&(c=c.data("outfitbuilderurlprefix"),a.isStringNotEmpty(c)&&(g=c+e[d]));
return g}}});g.when("A","jQuery","a-carousel-framework","a-carousel-ajax-standard","complete-the-look-carousel-data","looks-data-cache","softlines-utils","csm-metrics-logger","ob-link-generator","lookFeedback","ready").execute("complete-the-look-ajax",function(f,a,b,d,g,c,e,k,h,j){f=f.extend({},d);f.getItems=function(a,b,f){f.asin=c.getAsin();f.dataSetType=g.getDataSetType();var h=c.getInjectedViewModel();if(e.isStringNotEmpty(h))f.injectViewModel=h;d.getItems(a,b,f)};f.init=function(a){j.updateFeedback(1);
var b=g.getProducts();a.setAttr("ajax",{url:"/gp/product/ajax-handlers/complete-the-look-carousel.html",id_list:b});return d.init(a)};f.afterInit=function(b){d.afterInit(b);var f=c.getLooks(),g=0;if(a.isArray(f))g=f.length;k.addCount("ctl-carousel:shown",1);b.onChange("pageNumber",function(b,c){var d=":back";b>c&&(d=":next");b===g&&c===1&&(d=":back");c===g&&b===1&&(d=":next");j.updateFeedback(b);var f=a("#outfitBuilder");if(f.length>0){var i=h.getOutfitBuilderUrlForPageNumber(b);e.isStringNotEmpty(i)&&
f.attr("href",i)}k.addCount("ctl-carousel:page:"+b+d,1)})};b.registerStrategy("ajax","complete-the-look",f)});g.when("A","jQuery","a-carousel-framework","looks-data-cache","complete-the-look-carousel-data","csm-metrics-logger","ready").execute("complete-the-look-display",function(f,a,b,d,g,c){function e(b){function c(a){a.dom.$viewport.css("height","")}b.onChange(l,function(){b.dom.$carousel.children("li").css("visibility","")});b.onChange(h,function(a,d){a>d&&c(b)});b.onChange("loading",function(a){a||
c(b)});b.onChange(j,function(){c(b)});b.onChange(n,function(c){if(!c){var d=b.getAttr(j)-1,f=d+b.getAttr(h);b.dom.$carousel.children("li").each(function(b,c){var e=b>=d&&b<f;a(c).css("visibility",e?"":"hidden").attr("aria-hidden",e?"false":"true")})}});b.onChange(q+" "+m,function(){this.repaint(b)});b.onChange(m,function(){this.repaint(b)})}var k=0.82,h="pageSize",j="firstVisibleItem",q="single_page_align",m="minimum_gutter_width",l="pageNumber",n="animating",o=a("#recommendations");b.registerStrategy("display",
"complete-the-look",{repaint:function(a){d.isShovelerArrowsEnabled()||(k=1);a.getDimensions();var b=o.width()*k,c=Math.round(b*0.225),f=Math.round(b*0.0125);a.setAttr("currentGutter",0);a.setAttr(h,4);var e=a.dom.$carousel,g=e.children("li"),b=g.length,i=a.getAttr(j)-1,l=i+4,m=c+"px",n="0 "+f+"px";g.each(function(a,b){var c=a>=i&&a<l;b.style.visibility=c?"":"hidden";b.style.width=m;b.style.margin=n;b.setAttribute("aria-hidden",c?"false":"true")});f=g.first().outerWidth(!0);g=b*f;e.removeClass("a-text-right a-text-center");
e.css("width",g+"px");e={carousel:{width:g,outerWidth:e.outerWidth()},items:[]};for(g=0;g<b;g++)e.items.push({width:c,outerWidth:f});a.updateDimensionsCache(e);a.gotoIndex(a.getAttr(j),{animationDuration:0});a.triggerEvent("repaint")},resize:function(a,b){b.viewport&&b.viewport.width!==void 0&&(this.repaint(a),c.addCount("ctl-carousel:resized",1))},init:function(a){var b=[];d.isShovelerArrowsEnabled()&&(b=g.getProducts());b.length>0&&a.setAttr("set_size",b.length);a.setAttr(m,0);a.setAttr("first_item_flush_left",
!0);this.repaint(a);b=a.getDimensions();a.dom.$container.find(".a-carousel-left, .a-carousel-right, .a-carousel-viewport").css("height",Math.max(b.viewport.height,b.items[0]?b.items[0].height:0)+"px");b=a.getAttr(j);b>1&&(a.setAttr(j,b),b=Math.ceil(b/a.getAttr(h)),a.gotoPage(b));e(a)}})});g.when("jQuery").register("softlines-utils",function(f){function a(a){return f.type(a)!=="undefined"&&f.type(a)!=="null"}function b(b){return a(b)&&f.type(b)==="string"}return{isNotNull:a,isString:b,isStringNotEmpty:function(a){return b(a)&&
a.length>0}}});g.register("metrics-logger",function(){return{addCount:function(){}}});g.register("recommendations-carousel-data",function(){return{getProducts:function(){}}})})})(function(){var g=window.AmazonUIPageJS||window.P,k=g._namespace||g.attributeErrors;return k?k("SoftlinesRecommendationsAssets"):g}(),window);
/* ******** */
(function(e){e.execute(function(){e.when("A","a-popover","ready").execute(function(a,c){a.$("#freeSampleInlineJavascript").length===0&&e.register("sampling-feature",function(){var e,i,n,l,f,b;function j(){var c=a.$("#csxfsSelectedBlock").height()*l;a.$("#csxfsImageSelected").css("padding-top",c);a.$("#csxfsYourGiftText").css({left:f,opacity:0});a.$("#csxfsSampleImages").css({height:0,opacity:0});a.$(".csxfs_normal").each(function(){a.$(this).css("borderWidth",b)})}function k(b){var b=a.$("#"+b),d=
a.$("#"+y);c.create(b,{name:z,width:715,position:"triggerBottom",content:d.html(),activate:a.capabilities.touch?"onmouseover":"onclick"})}function d(b,c){a.$("#buybox_feature_div").css("opacity")!=="1"?setTimeout(function(){d(b,c)},500):(a.$(".csxfs_featurecontainer").show(),o=!1,u(),k("csxfsTitleDetailsLink"),k("csxfsSecondaryDetailsLink"),p()?(a.$("#csxfsSelectSampleButton, #csxfsImageSelected").bind("click",function(){b.animateIn(c)}),a.$(".csxfs_normal").bind("click",r).bind("click",function(){b.animateOut(c)}),
a.$(".csxfs_normal").hover(A,B),a.$("#csxfsNoThanks").bind("click",v).unbind("click",r)):(a.$("#csxfsImageSelected").bind("click",C),a.$("#csxfsAcceptSampleButton").bind("click",r),a.$("#csxfsDeclineSampleButton").bind("click",v)),a.$("#csxfsImageSelected").hasClass("csxfs_faded_image")?(s=!1,a.$("#addToCart").find("#freeSampleOfferListingID").val("")):a.$("#freeSampleOfferListingID").val(a.$("#csxfsImg0").data("offerlistingid")))}f=16;b=0;n=114;e=void 0;i=void 0;l=void 0;var o=!0,m=function(){a.$("#csffsFeaturecontainer").animate({height:e},
"slow",function(){a.$("#csxfsSelectedSampleText").css({left:f,opacity:0})});a.$("#csxfsSamplesBlock").removeClass("a-hidden");a.$("#csxfsSelectedBlock").addClass("a-hidden");a.$("#csxfsImageSelected").removeClass("csxfs_faded_image");a.$("#csxfsSampleImages").animate({height:i,opacity:1},"slow");a.$(".csxfs_normal").each(function(){a.$(this).animate({borderWidth:1},"3000")});a.$("#csxfsYourGiftText").animate({left:0,opacity:1},"slow");g(!0);return!1},g=function(b){b?(a.$("#csxfsFreeSampleDeclinedTitle").hide(),
a.$("#csxfsSelectedSampleText").removeClass("csxfs_nosampleselected_text"),a.$("#csxfsSampleTitle").show(),a.$("#csxfsFreeSampleTitle").show()):(a.$("#csxfsFreeSampleDeclinedTitle").show(),a.$("#csxfsSelectedSampleText").addClass("csxfs_nosampleselected_text"),a.$("#csxfsSampleTitle").hide(),a.$("#csxfsFreeSampleTitle").hide())},w=function(){o=!1;a.$("#csxfsLnkDiffGiftSec").hide();a.$("#csxfsLnkChooseGift").show();a.$("#csxfsLnkNoGift").hide();g(!1);a.$("#csxfsImageSelected").addClass("csxfs_faded_image");
a.$("#freeSampleOfferListingID").remove();a.$("#csxfsAcceptSample").show();a.$.get(a.$(this).data("foresterurl"));return!1},p=function(){return a.$("#csxfsItemsCount").val()>1?!0:!1},q=function(){var b=a.$(this).data("foresterurl");b&&a.$.get(b);p()?h():(u(),a.$("#addToCart").find("#freeSampleOfferListingID").val(a.$("#csxfsImg0").data("offerlistingid")),a.$("#csxfsSampleTitle").text(a.$("#csxfsImg0").data("title")).show(),a.$("#csxfsImageSelected").removeClass("csxfs_faded_image"),a.$("#csxfsLnkNoGift").show(),
g(!0),a.$("#csxfsAcceptSample").hide())},h=function(){a.$("#csxfsLnkDiffGiftSec").show();a.$("#csxfsLnkChooseGift").hide();a.$("#csxfsLnkNoGift").show();m();return!1},u=function(){o||(a.$("#addToCart").prepend(a.$('<input type="hidden" id="freeSampleOfferListingID" name="freeSampleOfferListingID" value="">')),o=!0)},x=function(){var b=a.$(this).find("img").attr("src"),c=a.$(this).data("title");a.$("#csxfsSampleImages").animate({height:0,opacity:0},"slow");a.$("#csxfsSamplesBlock").addClass("a-hidden");
a.$("#csxfsImageSelected").attr("src",b);a.$("#csxfsSampleTitle").text(c);a.$("#csxfsSelectedBlock").removeClass("a-hidden");b=a.$("#csxfsSelectedBlock").height()*l;a.$("#csxfsImageSelected").css("padding-top",b);a.$("#csffsFeaturecontainer").animate({height:n},"3000",function(){a.$("#csxfsYourGiftText").css({left:f,opacity:0})});a.$("#csxfsSelectedSampleText").animate({left:0,opacity:1},"slow");a.$(".csxfs_normal").each(function(){a.$(this).removeClass("csxfs_highlight")});a.$(this).addClass("csxfs_highlight");
j();u();a.$("#addToCart").find("#freeSampleOfferListingID").val(a.$(this).data("offerlistingid"));a.$.get(a.$(this).data("foresterurl"))},t,s=!0,z="csxDetailsPopOver",y="a-popover-csxDetailsPopOver",r=function(){s=!0;a.$("#csxfsSampleTitle").removeClass("csxfs_hidden_elements");a.$("#csxfsNoSample").addClass("csxfs_hidden_elements");a.$("#csxfsImageSelected").removeClass("csxfs_faded_image");if(p()){var b=a.$("#csxfsSampleTitle").text().trim(),c=a.$(this).data("title"),b=b.substring(0,b.indexOf(" ")+
1)+c;a.$("#csxfsSampleTitle").text(b);a.$("#csxfsSelectProductSubheadingText").text(c);t=c;c=a.$(this).find("img").attr("src");a.$("#csxfsImageSelected").attr("src",c);a.$(".csxfs_normal").removeClass("csxfs_highlight");a.$(this).addClass("csxfs_highlight");a.$("#csxfsButtonTextChange").removeClass("csxfs_hidden_elements");a.$("#csxfsButtonTextSelect").addClass("csxfs_hidden_elements");a.$("#csxfsFreeSampleTitle").removeClass("csxfs_hidden_elements");a.$("#csxfsTitleDetailsLink").removeClass("csxfs_hidden_elements");
a.$("#csxfsSelectSampleTitle").addClass("csxfs_hidden_elements");a.$("#csxfsCountSampleChoices").addClass("csxfs_hidden_elements");a.$("#freeSampleOfferListingID").val(a.$(this).data("offerlistingid"));a.$.get(a.$(this).data("foresterurl"))}else a.$("#csxfsDeclineSampleButton").removeClass("csxfs_hidden_elements"),a.$("#csxfsAcceptSampleButton").addClass("csxfs_hidden_elements"),a.$("#freeSampleOfferListingID").val(a.$("#csxfsImg0").data("offerlistingid")),a.$.get(a.$("#csxfsImg0").data("foresterurl"))},
v=function(){s=!1;a.$("#csxfsSampleTitle").addClass("csxfs_hidden_elements");a.$("#csxfsNoSample").removeClass("csxfs_hidden_elements");a.$("#csxfsImageSelected").addClass("csxfs_faded_image");if(p()){a.$(".csxfs_normal").removeClass("csxfs_highlight");a.$("#csxfsNoThanks").addClass("csxfs_highlight");var b=a.$(this).data("title");a.$("#csxfsSelectProductSubheadingText").text(b);t=b;a.$("#csxfsButtonTextChange").addClass("csxfs_hidden_elements");a.$("#csxfsButtonTextSelect").removeClass("csxfs_hidden_elements");
a.$("#csxfsFreeSampleTitle").addClass("csxfs_hidden_elements");a.$("#csxfsTitleDetailsLink").addClass("csxfs_hidden_elements");a.$("#csxfsSelectSampleTitle").removeClass("csxfs_hidden_elements");a.$("#csxfsCountSampleChoices").removeClass("csxfs_hidden_elements")}else a.$("#csxfsDeclineSampleButton").addClass("csxfs_hidden_elements"),a.$("#csxfsAcceptSampleButton").removeClass("csxfs_hidden_elements");a.$("#freeSampleOfferListingID").val("");a.$.get(a.$("#csxfsNoThanks").data("foresterurl"));return!1},
C=function(){s?v():r()},A=function(){t=a.$("#csxfsSelectProductSubheadingText").text();a.$("#csxfsSelectProductSubheadingText").text(a.$(this).data("title"))},B=function(){a.$("#csxfsSelectProductSubheadingText").text(t)};return{init:function(){a.$(".csxfs_featurecontainer").show();var b=a.$("#csffsFeaturecontainer").hasClass("a-hidden");a.$("#csffsFeaturecontainer").removeClass("a-hidden");e=a.$("#csxfsSamplesBlock").removeClass("a-hidden").height();i=a.$("#csxfsSampleImages").height();a.$("#csxfsSamplesBlock").addClass("a-hidden");
n=a.$("#csffsFeaturecontainer").height();b&&a.$("#csffsFeaturecontainer").addClass("a-hidden");a.$("#csxfsImageSelected").hasClass("csxfs_faded_image")&&a.$("#addToCart").find("#freeSampleOfferListingID").val("");j();a.$("#csxfsLnkDiffGift").bind("click",m);a.$("#csxfsLnkNoGift").bind("click",w);a.$(".csxfs_normal").bind("click",x);a.$("#csxfsImageSelected").bind("click",q);a.$("#csxfsLnkChooseGift").bind("click",h);a.$("#csxfsAcceptSample").bind("click",q)},initV2:d}})})})})(function(){var e=window.AmazonUIPageJS||
window.P,a=e._namespace||e.attributeErrors;return a?a("FreeSampleAssets"):e}(),window);
/* ******** */
(function(l,h){l.execute(function(){l.when("jQuery","ready").register("action-panel-secondary-panel",function(a){function c(b,c){if(b&&c&&d[b])a("#"+b+"_secondaryPanelHeadingText").text(c),d[b].heading=c}function f(b,c){if(b&&c&&d[b]){var f=a("#"+c);if(f.length>0)c!==d[b].contentId&&a("#"+d[b].contentId).addClass("aok-hidden"),a("#"+b+"_secondaryPanelContent").append(f),f.removeClass("aok-hidden"),d[b].contentId=c}}function b(b){b&&d[b]&&a("#actionPanel").animate({left:"+=420px"},400,"swing",function(){a("#"+
b+"_secondaryPanel").addClass("aok-hidden");a("#"+b+"_secondaryPanelBackButton").removeClass("backButtonClickedState")})}var d={};return{init:function(e){if(e.panelId){d[e.panelId]=e;e.heading&&c(e.panelId,e.heading);e.contentId&&f(e.panelId,e.contentId);var g=a("#"+e.panelId+"_secondaryPanelBackButton");g.click(function(){g.addClass("backButtonClickedState");b(e.panelId)})}},setHeading:c,setContent:f,animateIn:function(b){b&&d[b]&&(a("#"+b+"_secondaryPanel").removeClass("aok-hidden"),a("#actionPanel").animate({left:"-=420px"},
400,"swing"))},animateOut:b}});l.when("jQuery","ready").register("burj-featurebullets",function(a){var c=!1,f,b,d=function(){b.fadeTo(200,0.75,null,function(){c?(b.find(".closeFB").addClass("aok-hidden"),a("#featureBulletsPlaceholder").removeClass("FBplaceholder"),f.find(".a-vertical").addClass("collapsedFeatureBullets"),a("#fbExpandableSection").removeClass("expanded"),b.removeClass("expandedFeatureBullets"),b.find("h1").removeClass("expandedFBHeader"),a(".fadeTextTopforFB").hide(),a(".fadeTextBottomforFB").hide(),
f.find("#fbExpanderMoreButtonSection").show(),c=!1):(f.find(".a-vertical").removeClass("collapsedFeatureBullets"),b.addClass("expandedFeatureBullets"),a("#fbExpandableSection").addClass("expanded"),b.find("h1").addClass("expandedFBHeader"),a("#featureBulletsPlaceholder").addClass("FBplaceholder"),f.find("#fbExpanderMoreButtonSection").hide(),a("#feature-bullets")[0].offsetHeight<a("#feature-bullets")[0].scrollHeight&&(a(".fadeTextTopforFB").show(),a(".fadeTextBottomforFB").show()),b.find(".closeFB").removeClass("aok-hidden"),
c=!0);b.fadeTo(200,1)})};return{init:function(){f=a("#feature-bullets");b=a("#fbSection");a(".fadeTextTopforFB").hide();a(".fadeTextBottomforFB").hide();var e=a("#fbExpandableSection"),g=a("#fbExpandableSectionContent");g.height()>e.height()&&(g.addClass("expandableSection"),g.click(function(){d()}),a("#fbExpanderMoreButtonSection").removeClass("aok-hidden"),f.find(".moreFB").click(function(){d()}),b.find(".closeFB").click(function(){d()}),b.hover(null,function(){c&&d()}))}}});l.when("jQuery","ready").register("elevatorFeature",
function(a){var c,f,b,d,e,g,k,w=function(){h.pageYOffset>d?(c.addClass("stickyBar"),b.removeClass("aok-hidden"),f.removeClass("aok-hidden")):(c.removeClass("stickyBar"),b.addClass("aok-hidden"),f.addClass("aok-hidden"))},o=function(){var b=h.pageYOffset,c,d;for(c=0,d=k.length;c<d;++c){var t=k[c],g=a(t.element);if(g.length>0){var f=g.offset().top-e-10,g=f+g.height(),i;b>=f-10&&b<=g+10?(a(t.selector).addClass("elevatorHighlight"),i=t.selector):a(t.selector).hasClass("elevatorHighlight")&&i!==t.selector&&
a(t.selector).removeClass("elevatorHighlight")}}},m=function(a){if(a.length>0){var b=a.offset().top-e-10;j(b,a)}},j=function(b,c){var d=a(h).scrollTop(),t=Math.abs(d-b)+0,f=t/2E3*1E3,k=d-b<0,i=!1,j=k?b-t*0.2:b+t*0.2;g=!0;a(".elevatorButton").removeClass("elevatorHighlight");a("html, body").animate({scrollTop:b},{duration:f<500?500:f,step:function(a,d){if(c&&!i&&(k?a>j:a<j)){i=!0;var t=c.offset().top-e-10;if(b!==t)d.end=t}},complete:function(){g=!1;o()}})},i=function(b,c,e){var d=a(b);d.length?(k.push({selector:c,
element:b}),a(c).click(function(){d=a(b);m(d)})):a(e).addClass("aok-hidden")},r=function(){var b=[];a("#beautyRecommendations").length&&b.push("#beautyRecommendations");a("#sims_fbt").length&&b.push("#sims_fbt");a("#session-sims-feature, #fallbacksession-sims-feature").length&&b.push("#session-sims-feature, #fallbacksession-sims-feature");a("#purchase-sims-feature").length&&b.push("#purchase-sims-feature");if(b.length)b.sort(function(b,c){return a(b).offset().top-a(c).offset().top}),b.forEach(function(a){k.push({selector:"#elevatorRelatedProductsSection",
element:a})}),a("#elevatorRelatedProductsSection").click(function(){for(var c=h.pageYOffset,d=0,t=b.length,g=null;g===null&&d<t;){var f=a(b[d++]);f.length>0&&Math.floor(f.offset().top-e-10)>c&&(g=f)}g===null&&d===t&&(g=a(b[0]));m(g)});else{a("#elevatorRelatedProductsSection").addClass("aok-hidden");for(var c=a(".elevatorDividerSection"),d=!0,t=c.length-1;d&&t>=0;){var g=a(c[t]);g.hasClass("aok-hidden")?t--:(g.addClass("aok-hidden"),d=!1)}}},s=function(){a("#elevatorViewBuyingOptionsButton .a-button-inner").click(function(){j(a("#a-page .a-container").offset().top-
10,null)})},q;l.when("page-refresh:page").execute(function(a){q=a});var p=function(){if(q&&q.config){var b=!1,c;for(c in q.config)if(q.config[c].affectedFeatures&&(a(q.config[c].affectedFeatures).each(function(c,e){var d=a(e);d.css("display")!=="none"&&d.css("opacity")!=="1"&&(b=!0)}),b))return!0}return!1},n=function(){if(p())setTimeout(function(){n()},200);else{c=a("#elevatorBar");f=a("#elevatorBarPlaceholder");b=a("#elevatorViewBuyingOptionsSection");d=c.position().top;e=c.height();k=[];var u=!1;
g=!1;i("#productDescription, #product-description_feature_div, #product-description-iframe","#elevatorMoreAboutThisItemSection","#elevatorMoreAboutThisItemSection, #elevatorMoreAboutThisItemDivider");i("#detail-bullets, #prodDetails","#elevatorProductDetailsSection","#elevatorProductDetailsSection, #elevatorProductDetailsDivider");i("#quickPromoBucketContent","#elevatorSpecialOffersSection","#elevatorSpecialOffersSection, #elevatorSpecialOffersDivider");i("#cm_cr_dpwidget","#elevatorCustomerReviewsSection",
"#elevatorCustomerReviewsSection, #elevatorCustomerReviewsDivider");r();s();a(h).resize(function(){d=c.position().top});a(h).scroll(function(){u=!0});setInterval(function(){u&&(u=!1,w(),g||o())},100);w();o()}};return{init:n}});l.when("jQuery","atf").register("title-burj",function(a){var c,f,b,d,e,g,k,w,o,m,j,i,r,s=function(){e.text(g);if(j&&c.height()<f.height()){m.removeClass("aok-hidden");if(o){w=g;for(var a=0,d=g.length-1;a<d;){e.text(g);var h=g,t=a+Math.floor((d-a)/2),i=h.indexOf(" ",t),h=h.substring(0,
i!==-1?i:h.length-1);e.text(h+"...");c.height()<f.height()?d=t-1:(a=t+1,w=e.text())}o=!1}e.text(w);b.addClass("showPointerOnHover");k=!0}else j&&(m.addClass("aok-hidden"),b.removeClass("showPointerOnHover"),k=!1)},q=function(){if(k){var a=c.position().top;f.fadeTo(200,0.75,function(){j?(r(),m.removeClass("expand").addClass("collapse titleToggleClickedState"),c.addClass("expandedTitle"),f.css("top",a),d.css("top",a-8)):(i(),m.removeClass("collapse").addClass("expand titleToggleClickedState"),c.removeClass("expandedTitle"),
f.css("top",""),d.css("top",""));j=!j;s();d.height(f.height()+16);f.fadeTo(200,1,function(){m.removeClass("titleToggleClickedState")})})}},p=function(){j||q()},n=function(){o=!0;s()};return{init:function(){c=a("#title_feature_div");f=a("#titleSection");b=a("#title");d=a("#titleOverlay");e=a("#productTitle");g=e.text();k=!1;j=!0;m=a("#expandTitleToggle");l.when("A","a-tooltip","atf").execute(function(a,b){i=function(){b.create(m,{content:a.state("titleExpanderTooltipState").content,position:"triggerTop"})};
r=function(){b.remove(m)};j&&i()});a("#socialFabric").append(a('<hr class="a-spacing-medium a-divider-normal">'));n();a(h).resize(n);b.click(q);m.click(q);f.hover(null,p)}}});l.when("A","jQuery","a-popover","cf").register("actionpanel-modified-popover",function(a,c,f){return function(b,d){function e(){a.on.scroll(function(){var a=f.get(b);if(a&&a.isActive()){var c=a.$container.get(0).getBoundingClientRect();if(c.bottom<0||c.right<0)a.attrs("originalFocus",null),a.hide()}})}function g(){var e=c(d);
u.popoverHandle=f.create(e,{closeButton:!1,closeButtonLabel:"close",position:"triggerBottom",name:b,popoverLabel:b,width:"400",activate:a.capabilities.touch?"onmouseover":"onclick"});a.capabilities.touch&&e.bind("touchend",function(){u.popoverHandle.isActive()||e.trigger("mouseenter")});a.on("a:popover:afterShow:"+b,m);a.on("a:popover:afterHide:"+b,j);a.on("a:popover:afterUpdatePosition:"+b,w)}function k(){n=c("#"+i);if(!n.length){var a=document.createElement("div");if(p.length)a.id=i,n=c(a).addClass(r).css({width:p.outerWidth(),
top:p.position().top}).bind("touchend click",function(){return!1}),p.append(a)}}function w(a){var b,c=a.popover.$trigger.get(0).getBoundingClientRect();b=h.pageYOffset?h.pageYOffset:(document.compatMode||"")==="CSS1Compat"?document.documentElement.scrollTop:document.body.scrollTop;var e=p.get(0).getBoundingClientRect().left+q;a.popover.$container.css({top:c.top+b+"px",left:e+"px"})}function o(){var a=p.get(0).getBoundingClientRect();n.css("height",a.bottom-a.top+"px")}function m(a){o();n.show();a.popover.$container.hasClass(l)||
a.popover.$container.addClass(l);a.popover.$trigger.trigger(y,a)}function j(a){n.hide();a.popover.$trigger.trigger(A,a)}var i="actionPanelOverlay",r="action-panel-overlay",l="burj-action-panel-modified-popover",q=8,p=c("#actionPanel"),n,u=this,y="ActionPanelModifiedPopover.showPopover",A="ActionPanelModifiedPopover.hidePopover";p.length&&(g(),k(),e(),c(h).resize(o))}});l.when("A","jQuery","a-popover","burj-twister-utils","actionpanel-vodd-event-handler","leftcolumn-vodd-event-handler","cf").execute(function(a,
c,f,b,d,e){function g(){a.on.scroll(function(){var a=b.getActivePopover();if(a){var c=m.get(0).getBoundingClientRect();if(c.bottom<0||c.right<0)a.attrs("originalFocus",null),a.hide()}})}function k(a,b){if(j&&typeof j!=="undefined"&&j.onShowPopover)j.onShowPopover(a,b)}function h(a,b){if(j&&typeof j!=="undefined"&&j.onHidePopover)j.onHidePopover(a,b)}function o(a,b){if(j&&typeof j!=="undefined"&&j.onClickDimensionRow)j.onClickDimensionRow(a,b)}var m=c(".burj #twister"),j;m.length&&(f=m.find("[id^=vodd-button-]"),
f.length&&(c("#actionPanel #twister_feature_div").length>0?j=new d:c("#leftCol #twister_feature_div").length>0&&(j=new e),f.bind("TwisterVODD.showPopup",k).bind("TwisterVODD.hidePopup",h),c(".vodd-dimension-row").bind("TwisterVODD.dimensionRowClick",o),g()))});l.when("A","jQuery","a-popover","cf").register("burj-twister-utils",function(a,c,f){var b;return{getActivePopover:function(){b||(b=c("#twister").find("[id^=vodd-button-]"));var a=null;b.length&&b.each(function(b,c){var k=c.id.split("vodd-button-");
if((k=f.get("vodd-popover-"+k[k.length-1]))&&k.isActive())return a=k,!1});return a},getPageOffset:function(){var a,b;h.pageYOffset?(a=h.pageYOffset,b=h.pageXOffset):(document.compatMode||"")==="CSS1Compat"?(a=document.documentElement.scrollTop,b=document.documentElement.scrollLeft):(a=document.body.scrollTop,b=document.body.scrollLeft);return{top:a,left:b}}}});l.when("A","jQuery","burj-twister-utils","cf").register("actionpanel-vodd-event-handler",function(a,c,f){return function(){function b(){var a=
w.offset().top+w.height()-k.offset().top,b=k.height()-a;c("#"+g).css({height:b+"px",top:a+"px"})}function d(){var a=document.createElement("div");a.id=g;c(a).addClass(e).css({width:k.outerWidth()}).bind("touchend click",function(){return!1});k.append(a)}var e="twister-overlay",g="twisterOverlay",k=c("#actionPanel"),w=k.find("#twister_feature_div");this.onShowPopover=function(){b();k.addClass("twister-popover-visible");c("#"+g).show()};this.onHidePopover=function(){k.removeClass("twister-popover-visible");
c("#"+g).hide()};(function(){d();var e=function(){f.getActivePopover()&&b()};a.on("a:pageUpdate",e);c(h).resize(e)})()}});l.when("A","jQuery","burj-twister-utils","cf").register("leftcolumn-vodd-event-handler",function(a,c,f){return function(){function b(){o=c("#"+e.join(", #"));w=c("#main-image-container");m=c("#heroImage");j=c("#imageBlock_feature_div");i=c("#title_feature_div")}function d(a){c("html, body").animate({scrollTop:a},500)}var e="instantOrderUpdate_feature_div,brandBar_feature_div,averageCustomerReviews_feature_div,brandBarAE_feature_div,averageCustomerReviews_feature_div,ask_feature_div,zeitgeistBadge_feature_div,socialFabric_feature_div".split(","),
g=c("#twister_feature_div"),k=g.find("#twisterContainer"),w,o,m,j,i,l;this.onShowPopover=function(b,e){g.addClass("twister-popover-visible");if(e.popover){if(!m.length||m.hasClass("hide-background")){var p=g.get(0).getBoundingClientRect().top;l=i.css("margin-top");var n=c("#brandBar");n.length&&i.css("margin-top",n.css("margin-top"));o.addClass("aok-hidden");n=350;j.height()<=n&&(n=250);w.addClass("image-block-resized");a.trigger("Burj.ImageBlock.resizeImageBlockEvent",{maxImgBlockHeight:n});p=p-
g.get(0).getBoundingClientRect().top+10;g.css("margin-top",p+"px")}i.get(0).getBoundingClientRect().top<0?d(i.offset().top-10):(p=k.get(0).getBoundingClientRect().bottom-c(h).height(),p>0&&(p=f.getPageOffset().top+p,d(p+10)))}};this.onClickDimensionRow=function(){b()};this.onHidePopover=function(){g.removeClass("twister-popover-visible");var b=c("#title_feature_div");l&&typeof l!=="undefined"&&b.css("margin-top",l+"px");o.removeClass("aok-hidden");w.removeClass("image-block-resized");a.trigger("Burj.ImageBlock.resizeImageBlockEvent",
{maxImgBlockHeight:null});g.css("margin-top","10px")};b()}});l.when("A","a-popover","actionpanel-modified-popover","cf").register("sns-frequency-dropdown",function(a,c,f){var b=a.$;return{init:function(){b("#sns-frequency-button").length&&(new f("sns-frequency-dropdown-popover",b("#sns-frequency-button")),a.declarative("sns-frequency-update","click",function(a){var e=a.$target.parents("li"),a=a.data.frequency;e.siblings().removeClass("sns-selected-frequency");e.addClass("sns-selected-frequency");
b("#rcxOrdFreq").val(a);b("#sns-frequency-button-label").text(e.text());c.get("sns-frequency-dropdown-popover").hide()}),a.declarative("sns-frequency-dropdown-popover-close","click",function(){c.get("sns-frequency-dropdown-popover").hide()}))}}});l.when("jQuery","action-panel").register("mom-checkbox",function(a,c){return{init:function(){var f=a("#addToCart"),b=f.attr("action");a("#chkMom").change(function(){if(a("#chkMom").length){var d;a("#chkMom").is(":checked")?(f.attr("action","/gp/mom/pipeline/view-signup/"),
d="mom"):(f.attr("action",b),d="sns");c.setPanelState({mode:d})}});a("#chkMom").length&&a("#chkMom").is(":checked")&&a("#chkMom").attr("checked",!1)}}});l.when("jQuery","ready").register("btf-headings-burj",function(a){var c,f,b,d,e,g,k,h,o,m,j,i;l.when("page-refresh:page").execute(function(a){i=a});var r=function(){if(i&&i.config){var b=!1,c;for(c in i.config)if(i.config[c].affectedFeatures&&(a(i.config[c].affectedFeatures).each(function(c,e){var d=a(e);d.css("display")!=="none"&&d.css("opacity")!==
"1"&&(b=!0)}),b))return!0}return!1},s=function(){if(r())setTimeout(function(){s()},200);else{c=a(".prestige_beauty.burj-body #session-sims-feature");c.length&&(f=c.find("h2.a-carousel-heading").parent(),b=c.find(".a-column.a-span4.a-span-last.a-text-right"),f.length&&b.length&&(f.addClass("a-push2"),b.removeClass("a-span4"),b.addClass("a-span2")));d=a(".prestige_beauty.burj-body #purchase-sims-feature");d.length&&(e=d.find("h2.a-carousel-heading").parent(),g=d.find(".a-column.a-span4.a-span-last.a-text-right"),
e.length&&g.length&&(e.addClass("a-push2"),g.removeClass("a-span4"),g.addClass("a-span2")));k=a(".prestige_beauty.burj-body #cm_cr_dpwidget");h=k.find("h2");if(k.length&&h.length){var i=h.first();i.remove();k.prepend(i)}o=a(".burj-body #product-description-iframe");o.length&&(m=a(o[0].contentDocument.documentElement),m.length&&(j=m.find("h2"),j.length&&(j.css("color","#333"),j.css("font-size","21px"),j.css("font-weight","normal"),j.css("font-family","arial, verdana, helvetica, sans-serif"))))}};return{styleBTFHeadings:s}});
l.when("A","ready").execute(function(a){if(a.$("body").hasClass("burj-body")&&!a.$("body").hasClass("pantry")){var c=a.$("#nav-subnav");a.$(h).scrollTop()===0&&c.length&&a.$("html, body").delay(0).animate({scrollTop:c.offset().top},800)}});l.when("jQuery","A").register("twister-aui-page-state",function(a,c){var f=["csxfsSecondaryPanelSettings"];return{updatePageState:function(){var b=c.parseJSON;c.each(a('script[type="a-state"]'),function(d){d=a(d);if(!d.data("a-eval")){var e=d.attr("data-a-state");
if(e&&(e=b(e),e.key&&a.inArray(e.key,f)!==-1)){var g=b(d.html());c.state.replace(e.key,g);d.data("a-eval",!0)}}})}}});l.when("A","a-carousel-framework","twisterModule","ready").register("colorScenes",function(a,c,f){var b=a.$,d,e,g,k,l,o,m,j,i,r,s,q,p,n,u,y,A,t,B,v,J,z,x,T,K,L,U,V=!1,C,fa={skinTone_10:"skinTone_10_position",skinTone_20:"skinTone_20_position",skinTone_30:"skinTone_30_position",skinTone_40:"skinTone_40_position",skinTone_50:"skinTone_50_position"},ga,D,W,X,M=0,E,N,O,Y,P,va=function(){g.addClass("aok-hidden");
o.removeClass("aok-hidden");k.addClass("aok-hidden");Z();c.initializeAll()},wa=function(){o.addClass("aok-hidden");k.removeClass("aok-hidden");g.removeClass("aok-hidden");b(h).resize()},Z=function(){j.width(d.parent().width());e=d.width()},ha=function(a,c){$(a,c);b(h).bind("mousemove",a);b(h).bind("mouseup",c);typeof h.ontouchmove!=="undefined"&&(b(h).bind("touchmove",a),b(h).bind("touchend",c))},$=function(a,c){b(h).unbind("mousemove",a);b(h).unbind("mouseup",c);typeof h.ontouchmove!=="undefined"&&
(b(h).unbind("touchmove",a),b(h).unbind("touchend",c))},aa=function(){n=q.first().width();u=q.first().outerWidth(!0)-n;p=q.last().position().left;y=-(e/2)+u+n/2;A=p-e/2+u+n/2;var a=s.find(".selectedCarouselItem");T=a.length>0?a.width()-n-2*u:0;var a=A-y,b=N-E;Y=a/b;O=b/a},F,Q,G,ba,R,ca,ia=function(a){Q=F=0;G=Date.now();R=a;ba=R();clearInterval(ca);ca=setInterval(xa,50)},xa=function(){var a,b;a=Date.now();b=a-G;G=a;a=R()-ba;ba=R();b=1E3*a/(1+b);F=0.8*b+0.2*b},ka=function(){clearInterval(ca);if(F>50||
F<-50)Q=0.01*F,G=Date.now(),a.requestAnimationFrame(ja)},ja=function(){var b;if(Q&&(b=Date.now()-G,b=-Q*Math.exp(-b/500),b>0.5||b<-0.5))P==="carousel"?(H(b),I(-b*O,!1)):P==="slider"&&(H(b*Y),I(-b,!1)),a.requestAnimationFrame(ja)},S=function(a){return a.originalEvent&&a.originalEvent.targetTouches&&a.originalEvent.targetTouches.length>0?a.originalEvent.targetTouches[0].clientX:a.clientX},ya=function(){return v},na=function(a){t=!0;B=!1;ha(la,ma);J=S(a);ia(ya);a.preventDefault();a.stopPropagation();
return!1},ma=function(a){t=!1;$(la,ma);P="carousel";ka();a.preventDefault();a.stopPropagation();return!1},la=function(a){if(t){var b=S(a),c=b-J;J=b;H(c);I(-c*O,!1);B=!0;a.preventDefault();a.stopPropagation();return!1}},H=function(a){v-=a;aa();v<y?v=y:v>A&&(v=A);r.gotoPixel(v)},da=function(a){aa();var b=e/2-u-n/2+T,b=r.getItemOffset(a)-b;H(v-b);I(-(M-(E+(v-y)*O)),!0);z=a},oa=function(a){var b=fa[C.attr("id")],a=fa[a];K.removeClass(b).addClass(a);x.removeClass(b).addClass(a)},pa=function(a){x.attr("id")!==
a.attr("id")&&(x&&x.removeClass("selectedCarouselItem"),a.addClass("selectedCarouselItem"),x=a)},qa=function(a){B||(da(a.data.index),a=b(a.target),pa(a));B=!1},za=function(){K.animate({opacity:1},300,function(){b(".carouselScenePlaceholder").addClass("aok-hidden");x.addClass("selectedCarouselItem")})},ra=function(){U.addClass("aok-hidden");L.removeClass("aok-hidden")},ea=function(){V&&(ra(),b(h).unbind("click",ea),V=!1)},Aa=function(){L.addClass("aok-hidden");U.removeClass("aok-hidden");b(h).click(ea);
V=!0;event.preventDefault();event.stopPropagation();return!1},Ba=function(a){var c=a.target.id,a=b(a.target);c!==C.attr("id")&&C.removeClass("selectedSkinTone");a.addClass("selectedSkinTone");oa(c);C=a;ra()},Ca=function(){return M},ua=function(a){W=!0;ha(sa,ta);X=S(a);ia(Ca);a.preventDefault();a.stopPropagation();return!1},ta=function(a){W=!1;$(sa,ta);P="slider";ka();a.preventDefault();a.stopPropagation();return!1},I=function(a,b){var c=M+a;ea();c>N&&(c=N);c<E&&(c=E);b?D.animate({left:c},200):D.css("left",
c);M=c},sa=function(a){if(W){var b=S(a),c=b-X;X=b;I(c,!1);H(-c*Y);a.preventDefault();a.stopPropagation();return!1}},Ea=function(){c.onInit("colorScenes",function(){aa();v=y;var c=f.getState(),e=c.current_asin;x=b("#carouselSceneImage_"+e);z=parseInt(c.asin_variation_values[e].color_name,10)+1;da(z);Da();a.on("a:carousel:colorScenes:repaint",function(){da(z);pa(x)})})},Da=function(){f.getState();a.ajax("/gp/ccx/scene/color/sceneinfo?asinList=B000A82JBA,B000A85FXY",{method:"get",success:function(){K.css("background-image",
'url("https://images-na.ssl-images-amazon.com/images/I/81L1nyuvtTL._SP190,215,0|71rB4eNx1OL.jpg,71erSXu3dML.jpg,71HetONbNtL.jpg,71zE2zeo9GL.jpg_.jpg")');oa("skinTone_30");za()},error:function(){h.ueLogError&&h.ueLogError({message:"[Failed to load sprite images from/gp/ccx/scene/color/sceneinfo?asinList=B000A82JBA,B000A85FXY ]"},{logLevel:"ERROR",attribution:"color_scenes_throwing_the_error"})}})};return{init:function(){B=t=!1;d=b("#leftCol");e=d.width();g=b("#imageBlock_feature_div");l=b("#colorScenesIngressButton");
k=b("#colorScenesIngressContainer");o=b("#colorScenesStage");m=b("#colorScenesBackArrowImage");j=b("#colorScenesCarouselSection");i=b("#colorScenesCarouselContainer");s=i.find(".a-carousel");q=s.children();r=c.getCarouselByName("colorScenes");K=b(".carouselSceneImage");L=b("#colorSceneSkinToneButton");U=b("#skinTonePanel");C=b("#skinTone_30");ga=b("#colorSceneSliderBar");D=b("#colorSceneSlider");E=0;N=ga.outerWidth()-D.outerWidth();l.click(va);m.click(wa);L.click(Aa);C.addClass("selectedSkinTone");
b(".skinToneColor").click(Ba);i.mousedown(na);D.mousedown(ua);typeof h.ontouchstart!=="undefined"&&(i.bind("touchstart",na),D.bind("touchstart",ua));for(var Fa=r.dom.$carousel.children(),f=0;f<Fa.length;f++)b(Fa[f]).bind("click",{index:f+1},qa),typeof h.ontouchend!=="undefined"&&b(Fa[f]).bind("touchend",{index:f+1},qa);a.on.resize(Z);a.on.orientationchange(Z);Ea()}}})})})(function(){var l=window.AmazonUIPageJS||window.P,h=l._namespace||l.attributeErrors;return h?h("BurjDesktopAssets"):l}(),window);
/* ******** */
(function(a){a.execute(function(){a.when("jQuery").register("action-panel",function(c){var a="ap-onetime,ap-sns,ap-deal,ap-mom,ap-fresh,ap-oos,ap-b2brd".split(",");return{setPanelState:function(b){if(b.mode){for(var e=c("#actionPanel"),d=0;d<a.length;d++)e.removeClass(a[d]);b="ap-"+b.mode;c.inArray(b,a)>=0&&e.addClass(b)}}}});a.when("jQuery","action-panel").register("toggleBB",function(a,f){return{init:function(){a('input[name="toggleBuyBox"]:radio').change(function(){var b=a(this).attr("value");
f.setPanelState({mode:b});b==="onetime"?a("#csffsFeaturecontainer").removeClass("a-hidden"):a("#csffsFeaturecontainer").addClass("a-hidden")})}}})})})(function(){var a=window.AmazonUIPageJS||window.P,c=a._namespace||a.attributeErrors;return c?c("ActionPanelAssets"):a}(),window);
/* ******** */
(function(i,k){i.execute(function(){i.when("A","jQuery","ready").register("DeliveryCountdownComponent",function(c,b){function h(b,c,f,a,d){this.strings=b;this.asin=c;this.deliveryMessageSectionId=f;this.countdownElementId=a;this.secondsLeft=d;this.intervalHandle=null}k.DeliveryCountdownHandler=function(b){var c=b.strings,f=b.asin,a=b.deliveryMessageSectionId,d=b.fastCountdownElementId,i=b.cheapCountdownElementId;this.cheapCountdownTimer=this.fastCountdownTimer=null;this.start=function(b,e){if(b>0)this.fastCountdownTimer=
new h(c,f,a,d,b),this.fastCountdownTimer.start();if(e>0)this.cheapCountdownTimer=new h(c,f,a,i,e),this.cheapCountdownTimer.start()};this.stop=function(){if(this.fastCountdownTimer)this.fastCountdownTimer.stop(),this.fastCountdownTimer=null;if(this.cheapCountdownTimer)this.cheapCountdownTimer.stop(),this.cheapCountdownTimer=null}};h.prototype.start=function(){var b=this;this.intervalHandle=c.interval(function(){b&&b.updateCountdownText()},1E3)};h.prototype.stop=function(){this.intervalHandle&&k.clearInterval(this.intervalHandle)};
h.prototype.updateCountdownText=function(){this.secondsLeft--;if(this.secondsLeft>0){var c=Math.floor(this.secondsLeft/60),g=c%60,c=Math.floor(c/60),f=this.secondsLeft%60,a=this.strings.inNext,d=c>1?this.strings.hours:this.strings.hour,h=g>1?this.strings.minutes:this.strings.minute,i=f>1?this.strings.seconds:this.strings.second,k=this.strings.timeSeperator;b(this.countdownElementId).html(c>0&&g>0?c+k+d+k+g+k+h+k+a:c>0&&g===0?c+k+d+a:c===0&&g>0?g+k+h+a:f+k+i+a)}else this.stop(),g="<a href='javacript:window.location.reload();'>"+
this.strings.refreshTimeout+"</a>",b(this.deliveryMessageSectionId).html(g)}});i.when("A","jQuery","LUXContext").register("LUXController",function(c,b,h){function e(){return{addressLabel:j,addressId:F,obfuscatedId:z,countryCode:s,zipCode:t,state:r,city:p,district:u,locationType:x}}function g(a){j=a.addressLabel;F=a.addressId;z=a.obfuscatedId;s=a.countryCode;t=a.zipCode;r=a.state;p=a.city;u=a.district;x=a.locationType}function f(a,b,f){a=c.copy(a);a.deviceType=h.deviceType;a.pageType=d;c.post(B,{contentType:"application/x-www-form-urlencoded;charset=utf-8",
params:a,success:function(a){if(a.sembuUpdated){a.address&&g(a.address);var d=e();c.trigger(m,d);c.trigger(k,d);b&&b();i.when("LUXMetrics").execute(function(a){a.logLocationChange(d.locationType)})}else f&&f()},error:function(){c.trigger(l,e());f&&f()}})}var a=!1,d=null,k="DeliveryAddressDropdown_OnAddressChange",m="DeliveryAddressDropdown_OnSembuUpdateSuccess",l="DeliveryAddressDropdown_OnSembuUpdateFail",j,F,z,s,t,r,p,u,x,B="/gp/delivery/ajax/address-change.html";return{locationChangeEventName:k,
locationTypes:{defaultAddress:"DEFAULT_ADDRESS",accountAddress:"ACCOUNT_ADDRESS",lockerAddress:"LOCKER_ADDRESS",locationInput:"LOCATION_INPUT",realmDefault:"REALM_DEFAULT",region:"REGION",country:"COUNTRY",ip2location:"IP2LOCATION"},init:function(b){i.when("LUXResponder").execute(function(d){a?c.equals(b,e())||(g(b),d.refresh()):(g(b),d.activate(),a=!0)});i.when("LUXCustom").execute(function(a){a.activate()});i.when("LUXMetrics").execute(function(a){d=a.getPageType()})},getLocationData:function(){return e()},
changeLocation:function(a,b,c){f(a,b,c)}}});i.when("A","LUXDPOnly").register("LUXDPRefreshController",function(c){function b(b){d=b;h({addressId:d.addressId,zipCode:d.zipCode,city:d.city,state:d.state,district:d.district,countryCode:d.countryCode});var c={asin:d.asin,merchantId:d.merchantId,deviceType:d.deviceType,smid:d.smid,exMerchId:d.exMerchId};d.useTwisterRefresh==="T1"&&i.when("TwisterUpdateHandler").execute(function(b){b.init(c);f=!0;a=b});i.when("UnifiedLocationUpdateHandler").execute(function(b){f||
(b.init(c),a=b)});e(d.obfuscatedId)}function h(a){var b=1;g("#quantity").length===1&&(b=g("#quantity").val());c.state("unifiedLocation",{addressId:a.addressId,zipCode:a.zipCode,city:a.city,state:a.state,district:a.district,countryCode:a.countryCode,quantity:b})}function e(a){if(d&&d.oneClick){var b="unifiedLocation1ClickAddress";d.deviceType&&d.deviceType==="mobileApp"&&(b="addressID");a||(a=d.addNewAddress?d.addNewAddress:jQuery("#"+b).data("addnewaddress"));b='[id="'+b+'"]';0<g(b).length&&g(b).val(a);
if(d.deviceType&&d.deviceType in k&&(b=c.state("buyNowInfo"))){var e=b.urlParams,e=e.indexOf("addressID=")>0?e.replace(/(addressID=)[^&]*/,"$1"+a):e+"&addressID="+a;b.urlParams=e;c.state("buyNowInfo",b)}}}var g=c.$,f=!1,a=null,d=null,k={tabletApp:1,tabletLargeApp:1,iPad:1};c.on("DeliveryAddressDropdown_OnAddressChange",function(b){h(b);e(b.obfuscatedId);a!==null&&(a.refresh(),f||c.trigger("LocationUX_OnAddressChange",b))});return{init:function(a){b(a)}}});i.when("A","detailPage:RefreshHandler","LUXDPOnly",
"a-state").execute(function(c,b){i.register("TwisterUpdateHandler",function(){return{init:function(b){c.state("unifiedLocation",b)},refresh:function(){var h=b.getHandlerInstance("LocationUX"),e=[],g="addressId,zipCode,city,state,district,countryCode".split(",");if(h){var f=c.state("unifiedLocation"),a;for(a in f)if(f.hasOwnProperty(a)&&c.$.inArray(a,g)>-1){var d=typeof f[a];if(d==="number"||d==="boolean"||d==="string"||f[a]instanceof String)e.push(h.getURLParamObject(a,f[a]===null?"":f[a],1))}}e.length>
0&&h.doPageRefresh(e)}}})});i.when("A","LUXDPOnly","a-state").execute(function(c){i.register("UnifiedLocationUpdateHandler",function(){return{init:function(a){c.state("unifiedLocation",a)},refresh:function(){b=2;h()}}});var b=0,h=function(){var a=c.state("unifiedLocation"),b;for(b in a)if(a.hasOwnProperty(b)){var h=typeof a[b];h==="number"||h==="boolean"||h==="string"||a[b]instanceof String||(a[b]===null?a[b]="":delete a[b])}a&&a.asin&&a.merchantId&&(c.trigger("UnifiedLocationPreRefresh"),c.ajax("/gp/product/features/unified-location/udp/refresh-features.html?_encoding=UTF-8",
{params:a,method:"POST",success:e,error:g,abort:f}))},e=function(){c.trigger("UnifiedLocationPostRefresh",!0)},g=function(){c.trigger("UnifiedLocationPostRefresh",!1);--b>0&&h()},f=function(){c.trigger("UnifiedLocationPostRefresh",!1)}});i.when("A","jQuery","a-popover","LUXWidgetConfig","ready").execute(function(c,b,h,e){function g(g){var h=!1,D=g.selectedAddressId,v=g.selectedObfuscatedId,E=g.selectedAddressLabel,H=g.selectedCountryCode,N=g.selectedZipCode,C=g.selectedState,w=g.selectedCity,o=g.selectedDistrict,
q=g.addressPopover.name,y=g.addressPopover.type,J=e.initialAddressLoadCount,K=e.addressReloadCount,A=g.deviceType,L=g.isRecognized,I=0,M=!1;this.init=function(){h||(h=!0,U())};this.destroy=function(){c.off("a:popover:beforeShow:"+q,T);c.off("a:popover:afterHide:"+q,R);c.capabilities.tablet&&b.isFunction(c.off.orientationchange)&&c.off.orientationchange(X);b(document).undelegate(n,"focus");b(document).undelegate(n,"input");b(document).undelegate(r,"click");b(document).undelegate(d,"click");b(document).undelegate(l+
" input[type=radio], "+p+" ul li .a-touch-link.a-touch-select","click");b(document).undelegate(s,"click")};var G=function(){i.when(y).execute(function(a){a.get(q)&&a.get(q).hide()})},U=function(){c.on("a:popover:beforeShow:"+q,T);c.on("a:popover:afterHide:"+q,R);c.capabilities.tablet&&b.isFunction(c.on.orientationchange)&&c.on.orientationchange(X);b(document).delegate(n,"focus",function(){$()});b(document).delegate(r,"click",function(){var a=!0;A==="mobileApp"&&i.now("mash").execute(function(b){b&&
(a=!1,b.navstack.begin().back().end(),b.showLoginDialog({successCallback:function(){b.navstack.begin().back().forward(k.location.href).end()}}))});if(a)k.location.href=g.addressPopover.signInURL+k.location.pathname});b(document).delegate(n,"keyup",function(){Q()});b(document).delegate(n,"keypress",function(a){(a.keyCode||a.which)===13&&S()});b(document).delegate(d,"click",function(){S()});b(document).delegate(l+" input[type=radio], "+p+" ul li .a-touch-link.a-touch-select","click",function(){var a=
b.parseJSON(b(this).hasClass("a-touch-link")?b(this).find("input[type=hidden]").val():b(this).val());if(b(this).hasClass("a-active"))G();else if(a){var c=a.id;c!==D&&aa({addressId:c,isDefaultShippingAddress:a.isDefault,addressLabel:a.label,deviceType:A},!1,b(this))}});b(document).delegate(s,"click",function(){Y()});A==="tabletApp"&&k.scrollBy(0,1)},V=b(n).attr("placeholder"),Q=function(){A==="tabletApp"&&(b(n).val()?b(n).removeAttr("placeholder"):b(n).attr("placeholder",V))},S=function(){var a=b(n).val();
!a||!a.match(/^\d{5}$/)?Z():aa({zipCode:a,deviceType:A},!0,null)},T=function(){b(m).hasClass("aok-hidden")||(b(n).val(""),$());c.capabilities.tablet&&b("#a-popover-lgtbox")&&b("#a-popover-lgtbox").css({position:"absolute",top:"0px",left:"0px",width:"100%",height:b("#a-page").css("height")});Q();M||Y()},R=function(){A==="tabletApp"&&document.activeElement.blur()},X=function(){i.when(y).execute(function(a){a.get(q)&&a.get(q).refresh()})},Y=function(){L&&b.ajax({type:"POST",url:f,contentType:"application/x-www-form-urlencoded;charset=utf-8",
data:{currentAddressCount:I,loadCount:M?K:J,selectedAddressId:D,deviceType:A},dataType:"json",success:function(a){if(a){var c=a.loadedAddressCount;if(c>0){var d=a.html;d&&(b(p).length?(b(p+" ul li").has("span .a-touch-link.a-touch-select").remove(),b(p+" ul").html(d+b(p+" ul").html())):b(l).html(d),b(j).removeClass("a-hidden aok-hidden"),b(F).addClass("aok-hidden"),b(t).removeClass("a-hidden aok-hidden"),i.when(y).execute(function(a){a.get(q)&&a.get(q).updatePosition()}),a.hasMore?b(s).removeClass("a-hidden aok-hidden"):
b(s).addClass("aok-hidden"),I=c)}}M=!0},error:function(){}})},Z=function(){b(n).addClass("a-form-error");b(m).removeClass("a-hidden aok-hidden");A==="tabletApp"&&(document.activeElement.blur(),b(m)[0].scrollIntoView())},$=function(){b(n).removeClass("a-form-error");b(m).addClass("aok-hidden")},aa=function(c,d,e){b.ajax({type:"POST",url:a,contentType:"application/x-www-form-urlencoded;charset=utf-8",data:c,dataType:"json",success:function(a){if(a.sembuUpdated){if(a=a.address)D=a.addressId,v=a.obfuscatedId,
E=a.addressLabel,H=a.countryCode,N=a.zipCode,C=a.state,w=a.city,o=a.district,a="",a=E?E:(w?w+", ":"")+(C?C+" ":"")+N,b(z).html(a),d&&(b(l+" input[type=radio]:checked").attr("checked",!1),b(n).val("")),b(p+" ul li .a-touch-link.a-touch-select.a-active").removeClass("a-active"),e&&e.hasClass("a-touch-link")&&e.addClass("a-active");G();W(x);W(u)}else a.isValidAddress||Z()},error:function(){W(B)}})},W=function(a){c.trigger(a,{addressId:D,obfuscatedId:v,countryCode:H,zipCode:N,state:C,city:w,district:o})}}
var f="/gp/delivery/ajax/get-customer-address-list.html",a="/gp/delivery/ajax/address-change.html",d="#unifiedLocationAddrUpdate",n="#unifiedLocationAddrInput",m="#unifiedLocationInvalidInputAlert",l="#unifiedLocationAccountAddrList",j="#unifiedLocationTitleSelectAddress",F="#unifiedLocationTitleNoAddress",z="#unifiedLocationSelectedAddressText",s="#unifiedLocationSeeMore",t="#unifiedLocationSeeMoreDiv",r="#unifiedLocationSignIn",p="#unifiedLocationPopoverSelections",u="DeliveryAddressDropdown_OnAddressChange",
x="DeliveryAddressDropdown_OnSembuUpdateSuccess",B="DeliveryAddressDropdown_OnSembuUpdateFail";i.register("DeliveryAddressDropdown",function(){var a;return{init:function(b){a&&a.destroy();(a=new g(b)).init()}}})});i.when("A","jQuery","LUXContext","LUXWidgetConfig","LUXUtils","LUXController","LUXMetrics","ready").register("LUXResponder",function(c,b,h,e,g,f,a){function d(a){a===J?(b(w).addClass("a-form-error"),b(o).width(b(o).parent().width()).removeClass("aok-hidden"),b(q).addClass("aok-hidden")):
a===K?(b(w).removeClass("a-form-error"),b(o).addClass("aok-hidden"),b(q).width(b(q).parent().width()).removeClass("aok-hidden")):a===A&&(b(w).removeClass("a-form-error"),b(o).addClass("aok-hidden"),b(q).addClass("aok-hidden"))}function n(a){b(O).html(g.generateLocationLabel(a))}function m(a){b(D+" input[type=radio]:checked").attr("checked",!1);for(var d=b(D+" .a-declarative").has(".a-radio input[type=radio]"),a=a.addressId,e=d.length-1;e>=0;e--)if(c.parseJSON(d[e].getAttribute(y)).addressId===a){b(".a-radio input[type=radio]",
d[e]).attr("checked",!0);break}}function l(a){a.locationType===f.locationTypes.locationInput&&a.zipCode?b(w).val(a.zipCode):b(w).val("");d(A)}function j(a){i.when("a-dropdown").execute(function(b){b=b.getSelect(e.countrySelectorComponentName);c.objectIsEmpty(b)||(a.locationType===f.locationTypes.country||a.locationType===f.locationTypes.region||a.locationType===f.locationTypes.ip2location&&!a.state?b.setValue(g.mapLocationDataToCode(a)):b.setValue(""))})}function F(){c.post(P,{contentType:"application/x-www-form-urlencoded;charset=utf-8",
params:g.prepareCountrySelectionGeneratorInput(),success:function(a){b(C).html(a);j(f.getLocationData())}})}function z(a){f.changeLocation(a.data,null,function(){m(f.getLocationData())})}function s(a){f.changeLocation(g.mapCodeToLocationData(a.value),null,function(){j(f.getLocationData())})}function t(){var a=b(w).val();g.validateZipCode(a)?f.changeLocation({zipCode:g.preprocessZipCode(a),locationType:f.locationTypes.locationInput},function(){d(A)},function(){d(J)}):g.isMilitaryZipCode(a)?d(K):d(J)}
function r(){i.when(e.addressSelectorComponentType).execute(function(a){a.get(e.addressSelectorComponentName)&&a.get(e.addressSelectorComponentName).hide()})}function p(){var c=b(D+" .a-radio"),d=b(D+" .a-radio.aok-hidden"),c=c.length===d.length;d.slice(0,c?e.initialAddressLoadCount:e.addressReloadCount).removeClass("aok-hidden");b(D+" .a-radio.aok-hidden").length===0&&(b(H).addClass("aok-hidden"),b(N).addClass("aok-hidden"));c||a.logEvent(a.getEvents().click.seeMore)}function u(a){n(a);m(a);l(a);
j(a);r()}function x(){var d=f.getLocationData();l(d);h.isRecognizedCustomer&&b(D+" .a-radio").length===0&&b(v).length===0&&c.get(B,{params:{currentAddressId:d.addressId,deviceType:h.deviceType},success:function(a){a&&(b("#unifiedLocationTitleNoAddress").remove(),b("#unifiedLocationAccountAddrList").remove(),b("#unifiedLocationSeeMoreDiv").remove(),b("#unifiedLocationTitleSelectAddress").remove(),b(E).before(a),p())}});b.trim(b(C).html()).length||F(d);a.logWidgetView(a.getEvents().view.addressSelector)}
var B="/gp/delivery/ajax/get-address-selections.html",P="/gp/delivery/ajax/get-country-selections.html",O=".lux-location-label",D="#LUXAddressSelections",v="#LUXNoAddressNote",E=".lux-address-selector-divider",H="#LUXSeeMoreAddressLink",N="#LUXAddressActionSeparator",C="#unifiedLocationCountrySelectionDiv",w="#unifiedLocationAddrInput",o="#LUXInvalidZipCodeAlert",q="#LUXMilitaryZipCodeAlert",y="data-lux-address-selection",J=1,K=2,A=3;return{activate:function(){var g=f.getLocationData();a.logPageView(g.locationType);
g.locationType===f.locationTypes.region&&n(g);c.on("a:popover:beforeShow:"+e.addressSelectorComponentName,x);l(g);c.on(f.locationChangeEventName,u);c.declarative("lux-address-selection",["change"],z);b(document).delegate(w,"keypress",function(a){a.which===13&&t()});b(document).delegate(w,"focus",function(){d(A)});b(document).delegate("#unifiedLocationAddrUpdate","click",t);b(document).delegate("#unifiedLocationSignIn","click",function(){a.logEvent(a.getEvents().click.signIn);k.location.href=e.signInURL+
k.location.pathname});b(document).delegate(H,"click",p);b(document).delegate(".lux-manage-address-link","click",function(){a.logEvent(a.getEvents().click.manageAddressBook);return!0});c.on("a:dropdown:"+e.countrySelectorComponentName+":select",s)},refresh:function(){u(f.getLocationData())}}});i.declare("LUXWidgetConfig",{addressSelectorComponentName:"LUXAddressSelector",addressSelectorComponentType:"a-popover",countrySelectorComponentName:"LUXCountrySelector",countrySelectorComponentType:"a-dropdown",
initialAddressLoadCount:5,addressReloadCount:5,signInURL:"/gp/sign-in.html?ie=UTF8&useRedirectOnSuccess=1&path="});i.when("A","jQuery","LUXController","RegionNames","ready").register("LUXRegionData",function(c,b,h,e){function g(a){if(c.objectIsEmpty(a)||!a.countryCode||!a.zipCode)return null;for(var b in f)if(f.hasOwnProperty(b)&&c.reduce(f[b],function(e,g,h){return e&&!c.objectIsEmpty(a[h])&&c.equals(a[h],f[b][h])},!0))return b;return null}var f={"GB-ML":{countryCode:"GB",zipCode:"KA10 6EB"},"GB-NI":{countryCode:"GB",
zipCode:"BT1 3ES"},"GB-JE":{countryCode:"GB",zipCode:"JE2 4QA"},"GB-IS":{countryCode:"GB",zipCode:"ZE1 0BX"},"GB-BF":{countryCode:"GB",zipCode:"BFPO 204"},"GB-HI":{countryCode:"GB",zipCode:"PH41 4PU"},"DE-ML":{countryCode:"DE",zipCode:"60313"},"DE-GI":{countryCode:"DE",zipCode:"27498"},"FR-ML":{countryCode:"FR",zipCode:"75001"},"FR-CH":{countryCode:"FR",zipCode:"20000"},"FR-GP":{countryCode:"FR",zipCode:"97100"},"FR-GY":{countryCode:"FR",zipCode:"97300"},"FR-MC":{countryCode:"FR",zipCode:"98000"},
"FR-MQ":{countryCode:"FR",zipCode:"97200"},"FR-NC":{countryCode:"FR",zipCode:"98800"},"FR-PF":{countryCode:"FR",zipCode:"98700"},"FR-RE":{countryCode:"FR",zipCode:"97400"},"FR-SB":{countryCode:"FR",zipCode:"97133"},"FR-SM":{countryCode:"FR",zipCode:"97150"},"FR-SP":{countryCode:"FR",zipCode:"97500"},"FR-WF":{countryCode:"FR",zipCode:"98611"},"FR-YT":{countryCode:"FR",zipCode:"97600"},"IT-ML":{countryCode:"IT",zipCode:"20125"},"IT-II":{countryCode:"IT",zipCode:"09121"},"ES-ML":{countryCode:"ES",zipCode:"28004"},
"ES-BI":{countryCode:"ES",zipCode:"07003"},"ES-CI":{countryCode:"ES",zipCode:"35005"},"BR-SP":{countryCode:"BR",zipCode:"01319900"}};return{getRegions:function(){return f},mapLocationDataToRegionCode:function(a){return g(a)},mapRegionCodeToLocationData:function(a){a=f.hasOwnProperty(a)?b.extend({},{addressLabel:e[a],countryCode:f[a].countryCode,zipCode:f[a].zipCode,state:f[a].state,city:f[a].city,locationType:h.locationTypes.region}):null;return a}}});i.when("A","jQuery","ready").register("LUXRegionConfig",
function(){var c="AE,AR,AT,AU,BE,BG,BH,BM,BR,CA,CH,CL,CN,CO,CR,CY,CZ,DE,DK,EC,EE,EG,ES,FI,FR,GB,GP,GR,HK,HU,ID,IE,IL,IN,IS,IT,JO,JP,KE,KR,KW,KZ,LI,LT,LU,LV,MC,MO,MT,MX,MY,NG,NL,NO,NZ,OM,PA,PE,PH,PL,PT,QA,RO,RS,RU,SA,SE,SG,SI,SK,TH,TR,TT,TW,US,UY,VE,ZA".split(","),b=[],h=[],e=[],g=/^\d{5}([ \-]\d{4})?$/,f=/^[ \t]*([AFD](\.?)([ \t]?)P(\.?)([ \t]?)O(\.?)[ \t]*[A-Z]{2}[ \t]*[0-9]{5}([ \-][0-9]{4})?)[ \t]*$/;return{getPrimarySelections:function(){return c.concat(h)},getSecondarySelections:function(){return b.concat(e)},
getZipCodePattern:function(){return g},getMilitaryZipCodePattern:function(){return f},preprocessZipCode:function(a){return a.toUpperCase().trim().substring(0,5)}}});i.declare("RegionNames",{"GB-ML":"UK - Mainland","GB-BF":"UK - BFPO","GB-JE":"UK - Channel Islands","GB-IS":"UK - Islands","GB-NI":"UK - Northern Ireland","GB-HI":"UK - Scottish Highlands","DE-ML":"Germany - Mainland","DE-GI":"German Islands","FR-ML":"France - Mainland","FR-CH":"Corsica","FR-GP":"Guadeloupe","FR-GY":"Guyane","FR-MC":"Monaco",
"FR-MQ":"Martinique","FR-NC":"New Caledonia","FR-PF":"French Polynesia","FR-RE":"Reunion","FR-SB":"Saint Barthélemy","FR-SM":"Saint Martin","FR-SP":"Saint Pierre and Miquelon","FR-WF":"Wallis and Futuna Islands","FR-YT":"Mayotte","IT-ML":"Italy - Mainland","IT-II":"Italian Islands","ES-ML":"Spain - Mainland","ES-BI":"Spain - Balearic Islands","ES-CI":"Spain - Canary Islands, Ceuta and Melilla","BR-SP":"Brazil"});i.declare("CountryNames",{AD:"Andorra",AE:"United Arab Emirates",AF:"Afghanistan",AG:"Antigua and Barbuda",
AI:"Anguilla",AL:"Albania",AM:"Armenia",AN:"Netherlands Antilles",AO:"Angola",AQ:"Antarctica",AR:"Argentina",AS:"American Samoa",AT:"Austria",AU:"Australia",AW:"Aruba",AX:"Aland Islands",AZ:"Azerbaijan",BA:"Bosnia and Herzegovina",BB:"Barbados",BD:"Bangladesh",BE:"Belgium",BF:"Burkina Faso",BG:"Bulgaria",BH:"Bahrain",BI:"Burundi",BJ:"Benin",BL:"Saint Barthelemy",BM:"Bermuda",BN:"Brunei Darussalam",BO:"Bolivia",BQ:"Bonaire, Saint Eustatius and Saba",BR:"Brazil",BS:"Bahamas, The",BT:"Bhutan",BV:"Bouvet Island",
BW:"Botswana",BY:"Belarus",BZ:"Belize",CA:"Canada",CC:"Cocos (Keeling) Islands",CD:"Congo, The Democratic Republic of the",CF:"Central African Republic",CG:"Congo",CH:"Switzerland",CI:"Cote D'ivoire",CK:"Cook Islands",CL:"Chile",CM:"Cameroon",CN:"China",CO:"Colombia",CR:"Costa Rica",CS:"Serbia and Montenegro",CU:"Cuba",CV:"Cape Verde",CW:"Curaçao",CX:"Christmas Island",CY:"Cyprus",CZ:"Czech Republic",DE:"Germany",DJ:"Djibouti",DK:"Denmark",DM:"Dominica",DO:"Dominican Republic",DZ:"Algeria",EC:"Ecuador",
EE:"Estonia",EG:"Egypt",EH:"Western Sahara",ER:"Eritrea",ES:"Spain",ET:"Ethiopia",FI:"Finland",FJ:"Fiji",FK:"Falkland Islands (Malvinas)",FM:"Micronesia, Federated States of",FO:"Faroe Islands",FR:"France",GA:"Gabon",GB:"United Kingdom",GD:"Grenada",GE:"Georgia",GF:"French Guiana",GG:"Guernsey",GH:"Ghana",GI:"Gibraltar",GL:"Greenland",GM:"Gambia, The",GN:"Guinea",GP:"Guadeloupe",GQ:"Equatorial Guinea",GR:"Greece",GS:"South Georgia and the South Sandwich Islands",GT:"Guatemala",GU:"Guam",GW:"Guinea-Bissau",
GY:"Guyana",HK:"Hong Kong",HM:"Heard Island and the McDonald Islands",HN:"Honduras",HR:"Croatia",HT:"Haiti",HU:"Hungary",ID:"Indonesia",IE:"Ireland",IL:"Israel",IM:"Isle of Man",IN:"India",IO:"British Indian Ocean Territory",IQ:"Iraq",IR:"Iran, Islamic Republic of",IS:"Iceland",IT:"Italy",JE:"Jersey",JM:"Jamaica",JO:"Jordan",JP:"Japan",KE:"Kenya",KG:"Kyrgyzstan",KH:"Cambodia",KI:"Kiribati",KM:"Comoros",KN:"Saint Kitts and Nevis",KP:"Korea, Democratic People's Republic of",KR:"Korea, Republic of",
KW:"Kuwait",KY:"Cayman Islands",KZ:"Kazakhstan",LA:"Lao People's Democratic Republic",LB:"Lebanon",LC:"Saint Lucia",LI:"Liechtenstein",LK:"Sri Lanka",LR:"Liberia",LS:"Lesotho",LT:"Lithuania",LU:"Luxembourg",LV:"Latvia",LY:"Libya",MA:"Morocco",MC:"Monaco",MD:"Moldova, Republic of",ME:"Montenegro",MF:"Saint Martin",MG:"Madagascar",MH:"Marshall Islands",MK:"Macedonia, The Former Yugoslav Republic of",ML:"Mali",MM:"Myanmar",MN:"Mongolia",MO:"Macao",MP:"Northern Mariana Islands",MQ:"Martinique",MR:"Mauritania",
MS:"Montserrat",MT:"Malta",MU:"Mauritius",MV:"Maldives",MW:"Malawi",MX:"Mexico",MY:"Malaysia",MZ:"Mozambique",NA:"Namibia",NC:"New Caledonia",NE:"Niger",NF:"Norfolk Island",NG:"Nigeria",NI:"Nicaragua",NL:"Netherlands",NO:"Norway",NP:"Nepal",NR:"Nauru",NU:"Niue",NZ:"New Zealand",OM:"Oman",PA:"Panama",PE:"Peru",PF:"French Polynesia",PG:"Papua New Guinea",PH:"Philippines",PK:"Pakistan",PL:"Poland",PM:"Saint Pierre and Miquelon",PN:"Pitcairn",PR:"Puerto Rico",PS:"Palestinian Territories",PT:"Portugal",
PW:"Palau",PY:"Paraguay",QA:"Qatar",RE:"Reunion",RO:"Romania",RS:"Serbia",RU:"Russian Federation",RW:"Rwanda",SA:"Saudi Arabia",SB:"Solomon Islands",SC:"Seychelles",SD:"Sudan",SE:"Sweden",SG:"Singapore",SH:"Saint Helena, Ascension and Tristan da Cunha",SI:"Slovenia",SJ:"Svalbard and Jan Mayen",SK:"Slovakia",SL:"Sierra Leone",SM:"San Marino",SN:"Senegal",SO:"Somalia",SR:"Suriname",SS:"South Sudan",ST:"Sao Tome and Principe",SV:"El Salvador",SX:"Sint Maarten",SY:"Syria",SZ:"Swaziland",TC:"Turks and Caicos Islands",
TD:"Chad",TF:"French Southern Territories",TG:"Togo",TH:"Thailand",TJ:"Tajikistan",TK:"Tokelau",TL:"Timor-leste",TM:"Turkmenistan",TN:"Tunisia",TO:"Tonga",TR:"Turkey",TT:"Trinidad and Tobago",TV:"Tuvalu",TW:"Taiwan",TZ:"Tanzania, United Republic of",UA:"Ukraine",UG:"Uganda",UM:"United States Minor Outlying Islands",US:"United States",UY:"Uruguay",UZ:"Uzbekistan",VA:"Holy See",VC:"Saint Vincent and the Grenadines",VE:"Venezuela",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",VN:"Vietnam",VU:"Vanuatu",
WF:"Wallis and Futuna",WS:"Samoa",XK:"Kosovo",YE:"Yemen",YT:"Mayotte",YU:"Yugoslavia",ZA:"South Africa",ZM:"Zambia",ZW:"Zimbabwe"});i.when("A","jQuery","LUXController","LUXRegionData","LUXRegionConfig","LUXContext","CountryNames","RegionNames").register("LUXUtils",function(c,b,h,e,g,f,a,d){function i(b){return!c.objectIsEmpty(b)&&b.countryCode&&a.hasOwnProperty(b.countryCode)?c.equals(b.locationType,h.locationTypes.country)?b.countryCode:c.equals(b.locationType,h.locationTypes.region)?e.mapLocationDataToRegionCode(b):
e.mapLocationDataToRegionCode(b)||b.countryCode:null}function k(b){return a.hasOwnProperty(b)?a[b]:d.hasOwnProperty(b)?d[b]:null}function l(a){var b={};if(!c.objectIsEmpty(a))for(var d=a.length,e=0;e<d;e++)b[k(a[e])]=a[e];return b}return{getNameForCode:function(a){return k(a)},mapCodeToLocationData:function(b){b=b?a.hasOwnProperty(b)?{countryCode:b,locationType:h.locationTypes.country}:e.mapRegionCodeToLocationData(b):null;return b},mapLocationDataToCode:function(a){return i(a)},generateLocationLabel:function(a){var b=
"";return b=a.addressLabel?a.addressLabel:a.locationType!==h.locationTypes.region&&a.locationType!==h.locationTypes.country&&(a.city||a.state)&&a.zipCode?(a.city?a.city+", ":"")+(a.state?a.state+" ":"")+a.zipCode:k(i(a))},prepareCountrySelectionGeneratorInput:function(){return{deviceType:f.deviceType,primarySelections:JSON.stringify(l(g.getPrimarySelections())),secondarySelections:JSON.stringify(l(g.getSecondarySelections()))}},validateZipCode:function(a){return!c.objectIsEmpty(a)&&g.getZipCodePattern().test(a.toUpperCase())},
preprocessZipCode:function(a){return g.preprocessZipCode(a)},isMilitaryZipCode:function(a){return!c.objectIsEmpty(a)&&g.getMilitaryZipCodePattern().test(a.toUpperCase())}}});i.when("A","jQuery","LUXContext","ready").register("LUXMetrics",function(c,b,h){function e(b,c){k.ueLogError&&b&&k.ueLogError({message:b},{logLevel:c||"ERROR",attribution:a})}function g(a){k.ue?k.ue.count(a,(k.ue.count(a)||0)+1):e("Failed to increment metrics counter: "+a+" because window.ue is not present.","ERROR")}function f(){var a;
if(a=k.ue_pty)a:{a=k.ue_pty;for(var b in d)if(d.hasOwnProperty(b)&&c.indexOfArray(d[b],a)!==-1){a=!0;break a}a=!1}return a?k.ue_pty:"unrecognizedPage"}var a="LocationUX",d={detail:["Detail","DetailAW","DetailWebView","TabletUDP"],search:["Search","SearchAW"],offerListing:["OfferListing","OfferListingAW","OfferListingMobileAppAW"]},n={click:{signIn:"click.signIn",seeMore:"click.seeMore",manageAddressBook:"click.manageAddressBook"},view:{page:"view.page",addressSelector:"view.addressSelector",countrySelector:"view.countrySelector"},
selection:"selection",override:"override"};return{getPageType:function(){return f()},getEvents:function(){return n},logLocationChange:function(b){i.when("LUXController").execute(function(e){var i=f(),k=a+"."+i;k+=c.equals(b,e.locationTypes.locationInput)||c.equals(b,e.locationTypes.realmDefault)||c.equals(b,e.locationTypes.ip2location)?"."+n.override+"."+b:"."+n.selection+"."+b;!c.equals(b,e.locationTypes.defaultAddress)&&!c.equals(b,e.locationTypes.accountAddress)&&!c.equals(b,e.locationTypes.lockerAddress)&&
(k+="."+(h.isRecognizedCustomer?"recognized":"unrecognized"));c.indexOfArray(d.detail,i)!==-1&&h.isRecognizedCustomer&&(k+="."+(h.isOneClick?"1Click":"Non1Click"));g(k)})},logPageView:function(b){i.when("LUXController").execute(function(e){var i=f(),k=a+"."+i+"."+n.view.page+"."+b;!c.equals(b,e.locationTypes.defaultAddress)&&!c.equals(b,e.locationTypes.accountAddress)&&!c.equals(b,e.locationTypes.lockerAddress)&&(k+="."+(h.isRecognizedCustomer?"recognized":"unrecognized"));c.indexOfArray(d.detail,
i)!==-1&&h.isRecognizedCustomer&&(k+="."+(h.isOneClick?"1Click":"Non1Click"));g(k)})},logWidgetView:function(b){var e=f(),b=a+"."+e+"."+b+"."+(h.isRecognizedCustomer?"recognized":"unrecognized");c.indexOfArray(d.detail,e)!==-1&&h.isRecognizedCustomer&&(b+="."+(h.isOneClick?"1Click":"Non1Click"));g(b)},logEvent:function(b){b=a+"."+f()+"."+b;g(b)},logError:function(a,b){e(a,b)}}})})})(function(){var i=window.AmazonUIPageJS||window.P,k=i._namespace||i.attributeErrors;return k?k("DeliveryStatic"):i}(),
window);
/* ******** */
(function(b){b.execute(function(){b.when("A","afx-update-cart-count","prime-fresh-upsell","ready").register("fresh-dp-add-to-cart",function(c,a,f){return{init:function(){b.when("fresh-atc-handler").execute(function(a){a.addToFreshCart({success:function(){f.handlePrimeFreshUpsell()},error:function(){b.log("Error adding to Cart on Fresh Detail Page","Error")}})});c.$("#addToCart").submit(function(a){a.preventDefault()})}}});b.when("A","afx-utils","ready").register("fresh-show-atc-changeover",function(b,
a){var f=b.$,d=f("#afx-atc-changeover");return function(g){if(g&&d.length>0&&a.isFunction(d.find)){var e=b.state("fresh-atc-toast-text");if(e&&e.atcToastTextString&&(g=e.atcToastTextString.replace("FreshATCToastQuantity",g),(e=d.find(".a-changeover-inner"))&&a.isFunction(e.text)))e.text(g),a.isFunction(d.show)&&d.show()}}});b.when("A").register("afx-uatc-proxy",function(b){return function(a){b.post("/gp/add-to-cart/json",{timeout:5E3,params:{"session-id":a.sessionID,clientName:"SharedFreshHandler",
nextPage:"cart",ASIN:a.asin,offerListingID:a.offerListingID,useUber:"1",source:"Fresh",ruleSet:"FreshGet",quantity:a.quantity},success:a.success,error:a.error})}});b.when("A").register("afx-get-cart-count",function(b){return function(a){b.get("/gp/api/cart/1.0/get-cart-count.json",{timeout:5E3,params:{sessionID:a.sessionID,clientName:"sharedFreshHandler"},success:a.success,error:a.error})}});b.when("A","afx-get-cart-count").register("afx-update-cart-count",function(c,a){return function(c){var d=function(a){b.when("nav.setCartCount").execute(function(b){b(a)});
b.when("aw-mash").execute(function(b){b.cart&&typeof b.cart.didUpdate==="function"&&b.cart.didUpdate({newCartQuantity:a})})};a({sessionID:c,success:function(a){a&&a.isOK&&a.total&&a.total.numActiveItem?d(a.total.numActiveItem):b.log("Failed to get cart count","Error",c)},error:function(){b.log("Failed to get cart count","Error",c)}})}});b.when("A","jQuery","a-button","fresh-show-atl-changeover","ready").register("FreshAddToShoppingList",function(c,a,f,d){function g(b){c.post("/afx/lists/json/shoppinglists/additem",
{cache:!1,timeout:5E3,params:{asin:b.asin,listID:b.shoppingListID},success:function(a){b.addButtonInstance.enable();a.successful?(b.$modalParent.find("#"+b.cancelButtonID).click(),d()):a.errorCodes[0]===1?b.$alreadyInMessage.removeClass("aok-hidden"):e(b)},error:function(){b.addButtonInstance.enable();e(b)}})}function e(a){a.$errorMessage.removeClass("aok-hidden");b.log("Failed to add asin "+a.asin+" to shopping list "+a.shoppingListID,"ERROR")}c.declarative("add-to-list","click",function(a){var c=
a.$currentTarget.closest(".a-popover-wrapper");if(c.length<1)b.log("Could not find the element that parents this modal (it should contain class a-popover wrapper)","FATAL");else{var d=c.find("#"+a.data.addButtonID),e;d.length<1?(b.log("Could not find the button that will add the item. This is required for preventing double clicks","ERROR"),e=!1):a.data.asin?e=!0:(b.log("ASIN was blank. Please supply the ASIN you wish to add to the list.","ERROR"),e=!1);e&&(d=f(d),d.isEnabled()&&(d.disable(),a={asin:a.data.asin,
addButtonInstance:d,$modalParent:c,cancelButtonID:a.data.cancelButtonID,shoppingListID:c.find("#"+a.data.asin+"-afx-atl-dropdown").val(),$alreadyInMessage:c.find("#afx-atl-already-in"),$errorMessage:c.find("#afx-atl-service-error")},a.$alreadyInMessage.addClass("aok-hidden"),a.$errorMessage.addClass("aok-hidden"),g(a)))}})});b.when("A","afx-utils","ready").register("fresh-show-atl-changeover",function(b,a){var f=b.$,d=f("#afx-atl-changeover");return function(){d.length>0&&a.isFunction(d.show)&&d.show()}});
b.when("A","ready").register("prime-fresh-upsell",function(c){var a=function(a){a.isOk||b.log("prime-fresh-upsell: prime fresh upsell call encountered error","ERROR")},f=function(){b.log("prime-fresh-upsell: prime fresh upsell call failed","ERROR")};return{handlePrimeFreshUpsell:function(){c.$("#primeFreshUpsellCheckbox").is(":checked")&&c.post("/afx/detailpage/primefreshupsell",{success:a,timeout:500,error:f})}}});b.when("jQuery").register("fresh-dp-availability",function(b){return{init:function(){var a=
b("#fresh-merchant-info a");a.replaceWith(a.text())}}})})})(function(){var b=window.AmazonUIPageJS||window.P,c=b._namespace||b.attributeErrors;return c?c("FreshDetailPageDesktopAssets"):b}(),window);
/* ******** */
(function(a,b,c){a.execute(function(){a.when("A","jQuery","a-modal","afx-uatc-proxy","afx-update-cart-count","a-dropdown","fresh-dp-double-click","afx-csm-metrics-utils","fresh-show-atc-changeover","fresh-dp-quantity","ready").register("fresh-atc-handler",function(d,e,n,i,j,f,o,g,k,q){var l;a.when("EWC").execute("add-to-cart-refresh",function(a){l=a});a.when("nav.getFlyout").execute(function(a){a("ewc")});return{addToFreshCart:function(f){var h,s,v,w,p,t,z,x,m,A,y,E,D,B,C;function u(a,d,b,e){F(a);
f.error(a,d,b,e)}function F(d,b){var j=d.data.title,m=d.data.asin,i=d.data.offerListingID,f=d.data.sessionID,y=b!==c?b.itemStatusCode:c,o=b!==c?b.availableQuantity:c,I=b!==c?b.requestedQuantity:c;switch(y){case h:g.increment(w);a.log("fresh-atc-handler: Item not available.","INFO");break;case s:g.increment(p);a.log("fresh-atc-handler: Item partially available.","INFO");break;case v:g.increment(t);a.log("fresh-atc-handler: Item not available for reservation.","INFO");break;default:g.increment(z),a.log("fresh-atc-handler: No error status code.",
"ERROR")}n.create(d.$currentTarget,{name:"fresh-add-to-cart-modal",sessionID:f,url:"/afx/cart/reservation_conflict?"+e.param({reasonCode:y,title:j,asin:m,offerListingID:i,sessionID:f,quantityAdded:o,quantityRequested:I})}).show()}function G(c,j,n){n||(n=function(){});try{var f=c.data.asin;if(f)if(c.data.title){var h=c.data.offerListingID;if(h){var o=c.data.sessionID;if(o){var k=q.val();k||(a.log('fresh-atc-handler: "quantity" action parameter is missing.',"ERROR"),k=1);g.setWidgetClickTimestamp(A);
i({asin:f,offerListingID:h,sessionID:o,quantity:k,success:function(f){try{if(g.sendWidgetMetrics(A),f&&f.isOK){var m=f.extraErrorInfos;if(m.constructor!==Array)g.increment(y);else if(m.length===0)g.increment(E),j(f,o,k);else for(f=0;f<m.length;f++){var i=c,h=m[f];if(h)h.statusCode==="ADDRESS_NOT_SELECTED"?(g.increment(x),a.log("fresh-atc-handler: Address is not selected.","INFO"),b.location.href="/afx/nc/chooseaddress?"+e.param({asin:i.data.asin,offerId:i.data.offerListingID,quantity:1,redirectURL:b.location.href})):
F(i,h)}}else g.increment(D),u(c,"","","No response or isOK is false in UATC")}catch(l){g.increment(B),a.log("fresh-atc-handler exception: "+l,"ERROR")}finally{d.delay(n,C)}},error:function(b,e,f){try{g.sendWidgetMetrics(A),g.increment(D),u(c,b,e,f)}catch(j){g.increment(B),a.log("fresh-atc-handler exception: "+j,"ERROR")}finally{d.delay(n,C)}}})}else a.log('fresh-atc-handler: Required "sessionID" action parameter is missing.',"ERROR"),g.increment(m),u(c)}else a.log('fresh-atc-handler: Required "offerListingID" action parameter is missing.',
"ERROR"),g.increment(m),u(c)}else a.log('fresh-atc-handler: Required "title" action parameter is missing.',"ERROR"),g.increment(m),u(c);else a.log('fresh-atc-handler: Required "asin" action parameter is missing.',"ERROR"),g.increment(m),u(c)}catch(l){g.increment(B),a.log("fresh-atc-handler exception: "+l,"ERROR"),d.delay(n,C)}}function J(b){d.post("/afx/slotselection/cancel",{timeout:5E3,success:function(){G(b,function(){location.reload()})},error:function(){a.log("Failed to clear reservation","ERROR")}})}
function H(a){l&&typeof l.refresh==="function"?l.refresh():j(a)}C=1E3;m="freshAddToCartMissingParameterCount";B="freshAddToCartExceptionCount";A="freshUATCCall";E="freshUATCSuccessCount";D="freshUATCFailureCount";y="freshUATCInvalidErrorResponseCount";x="freshUATCAddressNotSelectedErrorCount";p="freshUATCItemPartiallyAvailableErrorCount";w="freshUATCItemNotAvailableErrorCount";t="freshUATCItemNotAvailableForReservationErrorCount";z="freshUATCEmptyItemStatusCodeErrorCount";h="ITEM_NOT_AVAILABLE";s=
"ITEM_PARTIALLY_AVAILABLE_FOR_RESERVATION";v="ITEM_NOT_AVAILABLE_FOR_RESERVATION";var K=function(a,d,b){k(b);H(d);f.success(a)};d.declarative("fresh-clear-slot","click",function(a){J(a)});d.declarative("fresh-atc-handler","click",o(function(a,d){q.valid()?(g.increment("freshAddToCartClickCount"),G(a,K,d)):d()}));d.on("a:popover:afterHide:fresh-add-to-cart-modal",function(a){H(a.popover.sessionID);n.remove(a.popover)})}}});a.when("A","jQuery","a-dropdown").register("fresh-dp-quantity",function(a,b,
c){var i=/^\d+$/;return function(){var j,f,o,g,k,q,l,r,h,s,v,w,p,t=function(){if(!j){f=b("#freshCartButton");k=c.getSelect("quantity");if(o=!!k){g=b("#quantitySelect");var a=k.getOptions().size();a&&(l=a-1)}r=b("#quantityText");if(q=r.length!==0)h=b("#quantityTextInput"),s=b("#quantityTextErrors > div"),v=b("#quantityFreeTextErrorMsgMin"),w=b("#quantityFreeTextErrorMsgMax")}},z=function(){a.on("a:dropdown:selected:quantity",function(a){b(a.nativeItemNode).index()===l?(h.attr("validValue",p),h.val(p),
r.show(),s.hide(),g.hide(),h.focus().select()):p=k.val()});var c=function(){var a=h.attr("validValue");a&&(k.val(a),k.val()===a?(p=a,g.show(),r.hide()):f.focus())},j=function(){var a=x(h.val());h.attr("validValue",a?a:"")};h.change(j);h.keyup(j);h.keypress(function(a){if(a.which===0||a.which===8||a.ctrlKey||a.altKey)return!0;if(i.test(String.fromCharCode(a.which)))return!0;a.which===13&&(c(),f.click());return!1});h.blur(c)},x=function(){var a;a:{a=h.val();if(i.test(a)&&(a=parseInt(a,10),!isNaN(a)))break a;
a=!1}s.hide();if(a===!1||a<=0)v.show();else if(a>=1E3)w.show();else return String(a);return!1};return{init:function(){j=!1;t();j=!0;if(q){r.hide().removeClass("aok-hidden");s.hide().removeClass("aok-hidden");var a=k.getOption(l),d=a.info()[0].text;a.update({value:"0",text:b.trim(d)+"+"});p=k.val();z()}},valid:function(){t();return q&&r.is(":visible")?x()!==!1:!0},val:function(){t();return q&&r.is(":visible")?h.attr("validValue"):o?k.val():1}}}()});a.register("fresh-dp-constants",function(){return{actionPanelDataSelector:"#apos",
actionPanelStateData:"apstate",actionPanelFreshState:"fresh",navFreshNodeId:"10329849011",mobileNavSearchFormSelector:'#nav-search-form, form[role="search"]'}});a.when("jQuery","fresh-dp-constants").register("fresh-dp-access-panel",function(a,b){var c=a(b.actionPanelDataSelector).data(b.actionPanelStateData);return{state:c,isFresh:b.actionPanelFreshState===c}});a.register("afx-csm-metrics-utils",function(){return{setWidgetClickTimestamp:function(a){b.ue&&b.uet&&a&&b.uet("tc",a,{wb:1})},setWidgetTimestamp:function(a,
c){b.ue&&b.uet&&a&&c&&b.uet(a,c,{wb:1})},increment:function(a){b.ue&&b.ue.count&&a&&b.ue.count(a,(b.ue.count(a)||0)+1)},setCount:function(a,c){b.ue&&b.ue.count&&a&&c&&b.ue.count(a,c)},sendWidgetMetrics:function(a){b.ue&&b.uex&&a&&b.uex("ld",a,{wb:1})}}});a.when("A","jQuery","a-button","ready").register("fresh-dp-double-click",function(a){return function(b){var c={disabled:"true"},i={};return function(j){var f=a.state("fresh-atc-status");if(!f||!f.disabled)f&&a.state("fresh-atc-status",c),b(j,function(){(f=
a.state("fresh-atc-status"))&&a.state.replace("fresh-atc-status",i)})}}});a.register("afx-utils",function(){return{isFunction:function(a){return typeof a==="function"},isDefined:function(a){return typeof a!=="undefined"}}})})})(function(){var a=window.AmazonUIPageJS||window.P,b=a._namespace||a.attributeErrors;return b?b("FreshDetailPageCommonAssets"):a}(),window);
/* ******** */
(function(h){h.execute(function(){if(!window.alohaBuyBoxUSLoadDone)window.alohaBuyBoxUSLoadDone=!0,h.when("A","a-dropdown","alohaBuyBoxJS","aloha-base","ready").execute(function(d,e,c){var b=d.$,a=this;a.buyboxJs=new c;a.buyboxRefreshDone=!1;a.pricingRefreshDone=!1;a.availabilityRefreshDone=!1;d.on("aloha:buyboxRefreshComplete",function(){a.buyboxRefreshDone=!0;a.updateWidgets()});d.on("aloha:pricingRefreshComplete",function(){a.pricingRefreshDone=!0;a.updateWidgets()});d.on("aloha:availabilityRefreshComplete",
function(){a.availabilityRefreshDone=!0;a.updateWidgets()});a.updateWidgets=function(){if(a.pricingRefreshDone&&a.buyboxRefreshDone&&a.availabilityRefreshDone){var i=a.selectedTransaction,f=a.selectedContractType!==void 0?a.selectedContractType:a.selectedConditionType;/^financing.+/.test(f)&&(f="financing");var c=b("#alohaBuyBoxWidget #contract-container-"+i),g;switch(f){case "m2m":g=b("#alohaBuyBoxWidget #"+i+"-m2m-info");break;case "twoYear":g=b("#alohaBuyBoxWidget #"+i+"-info");break;case "financing":g=
b("#alohaBuyBoxWidget #financing-contract-"+i+" ."+a.selectedContractType);break;case "new":g=b("#alohaBuyBoxWidget #DEVICE_ONLY-new-info");break;case "used":g=b("#alohaBuyBoxWidget #DEVICE_ONLY-used-info");break;case "refurbished":g=b("#alohaBuyBoxWidget #DEVICE_ONLY-refurbished-info")}a.selectedTransaction=a.selectedContractType=a.selectedConditionType=void 0;c!==void 0&&c.length&&e.getSelect("transaction-selector").setValue(i);g!==void 0&&g.length&&g.trigger("click");a.pricingRefreshDone=a.buyboxRefreshDone=
a.availabilityRefreshDone=!1}};b(document).delegate("li[id^='transaction-selector'] a.a-active","click",function(){var a=b("#alohaBuyBoxWidget div .contract-container:visible .selected");a!==void 0&&a.length&&a.trigger("click")});d.declarative("select-transaction","change click",function(c){var f=e.getSelect("transaction-selector").val();if(!(f===""||f===void 0))a.buyboxJs.hideTransactionAlertMessage(),a.buyboxJs.displayTransactionContainer(f),a.buyboxJs.updatePricingContainer(f),a.buyboxJs.updateTaxInfoForTransaction(f),
c.type==="change"?(a.buyboxJs.disableAddToCartButton(f),a.selectedTransaction=f,a.selectedContractType=a.selectedConditionType=void 0,b("#alohaBuyBoxWidget #contract-container-"+f+" .selected").trigger("click")):c.type==="click"&&a.buyboxJs.showMorePricingOption()});d.declarative("select-contract","click",function(c){var f=c.data.transaction,d=c.data.discriminator;b("#contract-container-"+f+" .selected").removeClass("selected");c.$currentTarget.addClass("selected");var g=c.data.offerListingType;a.buyboxJs.hideAvailabilityMessage();
if(g==="PURCHASABLE"){a.buyboxJs.showFastTrackMessage();a.buyboxJs.hideLinkOffButton();var e=c.data.financingContract==="true"?!0:!1,k=c.data.twoYearContract==="true"?!0:!1,h=c.data.m2mContract==="true"?!0:!1;a.selectedContractType=c.data.contractType;a.buyboxJs.updateM2MSelectedField("false");a.buyboxJs.updateFinancingOptionField("");e?(c=c.data.asin,a.buyboxJs.updateFinancingOptionField(c),a.buyboxJs.updateTaxInfoForFinancingTerm(c),a.buyboxJs.enableAddToCartButton(f,c)):k?(a.buyboxJs.updateTaxInfoForTransaction(f),
a.buyboxJs.enableAddToCartButton(f)):h&&(a.buyboxJs.updateM2MSelectedField("true"),a.buyboxJs.enableAddToCartButton(f,"",h));a.buyboxJs.hideMorePricingOption()}else g==="ADVERTISEMENT"&&(a.buyboxJs.hideFastTrackMessage(),a.buyboxJs.hideAddToCartButton(),a.buyboxJs.showLinkOffButton(),a.buyboxJs.hideMorePricingOption());a.buyboxJs.updatePricingContainer(f,g,d);a.buyboxJs.updateAvailabilityMessage(f,g,d)});d.declarative("select-device-only","click",function(c){var f=c.data.transaction,d=c.data.condition,
g=c.data.discriminator,e=c.data.offerListingType;a.selectedConditionType=d;a.buyboxJs.hideAddToCartButton();a.buyboxJs.toggleAddToCartWithoutContractButton(d);b("#device-only-container .selected, #contract-container-DEVICE_ONLY .selected").removeClass("selected");d==="new"&&(a.buyboxJs.hideAvailabilityMessage(),a.buyboxJs.updatePricingContainer(f,e,g),a.buyboxJs.updateAvailabilityMessage(f,e,g));c.$currentTarget.addClass("selected")});d.declarative("add-to-cart","click",function(c){var b=c.data.transaction,
e=c.data.vid,g=a.buyboxJs.buildExternalAlohaPath("/rbi/aloha/buyboxHandler");d.ajax(g,{method:"post",params:c.data,success:function(c){a.buyboxJs.handleAddToCartAjaxSuccess(c,b,e)},error:function(){a.buyboxJs.handleAjaxFailure()}})});d.declarative("checkout-with-popover","click",function(){var c=[];b("#aloha-cart-details .deviceContainer").each(function(){var a=b(this);c.push(a.find(".lineId").val())});var f={"operations[]":["REMOVE_DEVICE","ADD_DEVICE"]};f["lineid[]"]=c;var e=b("#aloha-atc-fields");
b.extend(f,a.buyboxJs.serializeInputs(e));e=a.buyboxJs.buildExternalAlohaPath("/rbi/aloha/alohaCartPopoverHandler");d.ajax(e,{method:"post",params:f,success:function(c){a.buyboxJs.handleAddToCartAjaxSuccess(c,f.transaction)},error:function(){a.buyboxJs.handleAjaxFailure()}})});d.declarative("tax-info-popup","click",function(a){var c=a.data.id,a="/gp/help/customer/display.html/ref="+a.data.refTag+"?ie=UTF8&pop-up=1&nodeId=",d=800,g=540,e=(window.screenX?window.screenX:window.screenLeft)+(b(window).width()-
d)/2,k=(window.screenY?window.screenY:window.screenTop)+(b(window).height()-g)/2;window.outerWidth&&window.innerWidth&&(e+=(window.outerWidth-window.innerWidth)/2);window.outerHeight&&window.innerHeight&&(k+=window.outerHeight-window.innerHeight);d-=16;g-=172;window.open(a+c,"newwindow","height="+g+",width="+d+",left="+e+",top="+k+",location=no,scrollbars=yes,toolbar=no,menubar=no,directories=no,status=yes,resizable=yes")});d.declarative("add-to-cart-with-no-contract","click",function(){a.buyboxJs.resetTransactionDropdown()})}),
h.when("A","a-modal","aloha-base").register("alohaBuyBoxJS",function(d,e){return function(){var c=d.$,b=this;b.settings={DEFAULT_ERROR_HEADER_MESSAGE:c("#alohaBuyBoxWidget input[name=aloha-default-error-message-header]").val(),DEFAULT_ERROR_MESSAGE:c("#alohaBuyBoxWidget input[name=aloha-error-message").val(),TRANSACTION_ALERT_SELECTOR:".select-transaction-alert",ADD_TO_CART_BUTTON_WITH_CONTRACT:"#add-to-cart-with-contract-btn",ADD_TO_CART_NEW_WITHOUT_CONTRACT_FORM_CONTAINER:"#new-add-to-cart",ADD_TO_CART_USED_WITHOUT_CONTRACT_FORM_CONTAINER:"#used-add-to-cart",
ADD_TO_CART_REFURBISHED_WITHOUT_CONTRACT_FORM_CONTAINER:"#refurbished-add-to-cart",CONTRACT_SALES_TAX_INFO_DIV:"#aloha-bb-contract-links",FINANCING_SALES_TAX_INFO_DIV:"#aloha-bb-financing-links",LINKOFF_URL_SECTION:"#alohaBuyBoxWidget #linkOffSection",ADD_TO_CART_BUTTON:"#alohaBuyBoxWidget .add-to-cart",EXISTING_ADD_TO_CART_POPOVER_LABEL:"#existingCartPopoverLabel",DP_ADD_TO_CART_ERROR_LABEL:"#dpAddToCartErrorLabel",FASTRACK_MESSAGE_DIV:c("#dpFastTrack_feature_div")};b.hideFastTrackMessage=function(){c(b.settings.FASTRACK_MESSAGE_DIV).addClass("aok-hidden")};
b.showFastTrackMessage=function(){c(b.settings.FASTRACK_MESSAGE_DIV).removeClass("aok-hidden")};b.getExistingAddToCartLabel=function(){return c(b.settings.EXISTING_ADD_TO_CART_POPOVER_LABEL).val()};b.getDPAddToCartErrorLabel=function(){return c(b.settings.DP_ADD_TO_CART_ERROR_LABEL).val()};b.hideAddToCartButton=function(){c(b.settings.ADD_TO_CART_BUTTON).addClass("a-hidden")};b.showAddToCartButton=function(){c(b.settings.ADD_TO_CART_BUTTON).removeClass("a-hidden")};b.hideLinkOffButton=function(){c(b.settings.LINKOFF_URL_SECTION).addClass("a-hidden")};
b.showLinkOffButton=function(){c(b.settings.LINKOFF_URL_SECTION).removeClass("a-hidden")};b.displayTransactionContainer=function(a){c(".contract-container").addClass("a-hidden");c("#contract-container-"+a).removeClass("a-hidden")};b.hideTransactionAlertMessage=function(){c(b.settings.TRANSACTION_ALERT_SELECTOR).addClass("a-hidden")};b.enableAddToCartButton=function(a,d,f){c(b.settings.ADD_TO_CART_BUTTON_WITH_CONTRACT).hasClass("a-hidden")&&c(b.settings.ADD_TO_CART_BUTTON_WITH_CONTRACT).removeClass("a-hidden");
c(b.settings.ADD_TO_CART_BUTTON_WITH_CONTRACT).hasClass("a-button-disabled")&&c(b.settings.ADD_TO_CART_BUTTON_WITH_CONTRACT).removeClass("a-button-disabled");b.setTransactionType(a);b.updateM2MSelectedField(f);d!==void 0&&d!==""?(b.setFinancingOptionAsin(d),b.setM2MContractSelected("")):f!==void 0&&f!==""&&(b.setM2MContractSelected(f),b.setFinancingOptionAsin(""))};b.setTransactionType=function(a){c(b.settings.ADD_TO_CART_BUTTON_WITH_CONTRACT).find("input").data("add-to-cart").transaction=a;c("#aloha-atc-fields input#transactionTypeSelected").val(a)};
b.setFinancingOptionAsin=function(a){c(b.settings.ADD_TO_CART_BUTTON_WITH_CONTRACT).find("input").data("add-to-cart").financingOptionAsin=a};b.setM2MContractSelected=function(a){c(b.settings.ADD_TO_CART_BUTTON_WITH_CONTRACT).find("input").data("add-to-cart").m2mSelected=a};b.updatePricingContainer=function(a,b,f){c(".pricing-info").addClass("a-hidden");b!==void 0&&f!==void 0?c("#"+f+"-"+b).removeClass("a-hidden"):c(".pricing-detail-"+a).removeClass("a-hidden")};b.hideMorePricingOption=function(){c(".more-pricing-option").addClass("a-hidden")};
b.showMorePricingOption=function(){c(".more-pricing-option").removeClass("a-hidden")};b.updateFinancingOptionField=function(a){c("input[name=financingOptionAsin]").val(a)};b.updateM2MSelectedField=function(a){c("input[name=m2mSelected]").val(a)};b.disableAddToCartButton=function(a){c(b.settings.ADD_TO_CART_BUTTON_WITH_CONTRACT).hasClass("a-button-disabled")||c(b.settings.ADD_TO_CART_BUTTON_WITH_CONTRACT).addClass("a-button-disabled");a==="ALL"||a==="DEVICE_ONLY"?c(b.settings.ADD_TO_CART_BUTTON_WITH_CONTRACT).addClass("a-hidden"):
(c(b.settings.ADD_TO_CART_NEW_WITHOUT_CONTRACT_FORM_CONTAINER).addClass("a-hidden"),c(b.settings.ADD_TO_CART_USED_WITHOUT_CONTRACT_FORM_CONTAINER).addClass("a-hidden"),c(b.settings.ADD_TO_CART_REFURBISHED_WITHOUT_CONTRACT_FORM_CONTAINER).addClass("a-hidden"))};b.hideDeviceOnlyAddToCartButton=function(){c("#alohaBuyBoxWidget .aloha-no-contract-cart-button").addClass("a-hidden")};b.updateAvailabilityMessage=function(a,b,f){c("#availabilityInfo").removeClass("a-hidden");c("#availabilityInfo-"+f+"-"+
b).removeClass("a-hidden")};b.hideAvailabilityMessage=function(){c(".availability").addClass("a-hidden")};b.handleAddToCartAjaxSuccess=function(a,d,f){var j="http://"+location.host+"/wl/rbi/puc",g="https://"+location.host+"/wl/co/uew",h=d==="INDIVIDUAL_NEW"?!1:!0;a.status==="SUCCESS"?(a=h===!0?g:j,b.resetTransactionDropdown(),location.href=a):a.cartAdditionConflictOccurred?(j=c("#alohaShortDeviceTitle").val(),g={},g.conflictType=a.cartAdditionConflictType,g.deviceTitle=j,g.transaction=d,g.requiresAui=
"true",g.vid=f,a=b.buildExternalAlohaPath("/rbi/aloha/existingOrderInAlohaCartPopover")+"?"+c.param(g),d=b.getExistingAddToCartLabel(),f=c("#aloha-cart-popover-trigger"),e.create(f,{url:a,position:"triggerTop",width:900,hiddenOnClick:"true",popoverLabel:d}).show()):b.handleAjaxFailure(a.errorType,a.errorDetailMessage)};b.handleAjaxFailure=function(a,d){var f=c("#aloha-cart-error-failure-message-trigger"),j=b.getDPAddToCartErrorLabel();e.create(f,{header:a!==void 0?a:b.settings.DEFAULT_ERROR_HEADER_MESSAGE,
inlineContent:d!==void 0?d:b.settings.DEFAULT_ERROR_MESSAGE,position:"triggerVertical",width:400,popoverLabel:j}).show()};b.updateTaxInfoForTransaction=function(a){a==="ALL"||a==="DEVICE_ONLY"?(c(b.settings.CONTRACT_SALES_TAX_INFO_DIV).addClass("a-hidden"),c(b.settings.FINANCING_SALES_TAX_INFO_DIV).addClass("a-hidden")):(c(b.settings.CONTRACT_SALES_TAX_INFO_DIV).removeClass("a-hidden"),c(b.settings.FINANCING_SALES_TAX_INFO_DIV).removeClass("a-hidden"))};b.updateTaxInfoForFinancingTerm=function(a){a!==
void 0&&a!==""?(c(b.settings.CONTRACT_SALES_TAX_INFO_DIV).addClass("a-hidden"),c(b.settings.FINANCING_SALES_TAX_INFO_DIV).removeClass("a-hidden")):(c(b.settings.CONTRACT_SALES_TAX_INFO_DIV).removeClass("a-hidden"),c(b.settings.FINANCING_SALES_TAX_INFO_DIV).addClass("a-hidden"))};b.serializeInputs=function(a){var c={};a.find("input").each(function(a,b){c[b.name]=b.value});return c};b.buildExternalAlohaPath=function(a){return"/wl"+a};b.toggleAddToCartWithoutContractButton=function(a){c("#alohaBuyBoxWidget .aloha-no-contract-cart-button").addClass("a-hidden");
c("#alohaBuyBoxWidget #"+a+"-add-to-cart").removeClass("a-hidden")};b.resetTransactionDropdown=function(){c("#transaction-selector-dropdown").prop("selectedIndex",-1);c("#transaction-selector").prop("selectedIndex",-1)}}});h.when("aloha.carriercompatibility.model","aloha.dp.carriercompatibility.view").execute(function(d,e){this.carrierCompatibilityModel=new d;this.carrierCompatibilityView=new e(this.carrierCompatibilityModel);this.carrierCompatibilityModel.setDefaultCarriersByCountry()});h.when("A",
"ready").execute("aloha.carrierCompatibility.onStart",function(d){var e=function(c){return!d.$.isEmptyObject(d.state(c))};e("current-asin")&&e("default-country")&&e("all-carriers-by-country-and-asin")&&e("top-carriers-by-country-and-asin")&&h.declare("aloha.carrierCompatibility.ready")});h.when("A","aloha.carrierCompatibility.ready").register("aloha.carriercompatibility.model",function(d){return function(){var e=this;e.selectedData={currentAsin:d.state("current-asin").asin,defaultCountry:d.state("default-country").country,
allCarriersByCountryAndAsin:d.state("all-carriers-by-country-and-asin"),topCarriersByCountryAndAsin:d.state("top-carriers-by-country-and-asin"),allCarriersByCountryForCurrentAsin:null,topCarriersByCountryForCurrentAsin:null};e.setDefaultCarriersByCountry=function(){e.selectedData.allCarriersByCountryForCurrentAsin=e.selectedData.allCarriersByCountryAndAsin[e.selectedData.currentAsin];e.selectedData.topCarriersByCountryForCurrentAsin=e.selectedData.topCarriersByCountryAndAsin[e.selectedData.currentAsin]};
e.updateCurrentAsin=function(c){e.selectedData.currentAsin=c;e.setDefaultCarriersByCountry()};return e}});h.when("jQuery","A","a-dropdown").register("aloha.dp.carriercompatibility.view",function(d,e,c){return function(b){var a=this,i=window.ue;a.carrierCompatibilityModel=b;e.on("a:dropdown:aloha-carrier-compatibility-country-dropdown-overview:select",function(b){a.updateWidget(b.value);c.getSelect(a.selectors.modalDropdownId).setValue(b.value)});e.on("a:dropdown:aloha-carrier-compatibility-country-dropdown-modal:select",
function(b){a.updateWidget(b.value);c.getSelect(a.selectors.overviewDropdownId).setValue(b.value)});e.declarative("a-modal-helpful-yes","click",function(){a.$webElements.modalFeedback.hide();a.$webElements.modalConfirmFeedback.show();i&&i.count&&i.count(a.csmKeys.widgetHelpful,1)});e.declarative("a-modal-helpful-no","click",function(){a.$webElements.modalFeedback.hide();a.$webElements.modalConfirmFeedback.show();i&&i.count&&i.count(a.csmKeys.widgetNotHelpful,1)});e.declarative("a-modal","click",function(){i&&
i.count&&i.count(a.csmKeys.modalDisplayed,1)});e.declarative("swatchthumb-action","click",function(){var b=window.DetailPage.StateController.getState().current_asin;a.carrierCompatibilityModel.updateCurrentAsin(b);a.carrierCompatibilityModel.selectedData.allCarriersByCountryForCurrentAsin===void 0?a.$webElements.compatibilityWidget.hide():(a.$webElements.compatibilityWidget.show(),c.getSelect(a.selectors.overviewDropdownId).getOptions().remove(),c.getSelect(a.selectors.modalDropdownId).getOptions().remove(),
b=d.map(a.carrierCompatibilityModel.selectedData.allCarriersByCountryForCurrentAsin,function(a,b){return b}),b.sort().reverse(),d.each(b,function(b,d){c.getSelect(a.selectors.overviewDropdownId).addOption({text:d,value:d});c.getSelect(a.selectors.modalDropdownId).addOption({text:d,value:d})}),b=a.carrierCompatibilityModel.selectedData.defaultCountry,c.getSelect(a.selectors.overviewDropdownId).setValue(b),c.getSelect(a.selectors.modalDropdownId).setValue(b),a.updateWidget(b))});a.csmKeys={modalDisplayed:"alohaCarrierCompatibilityModalDisplayed",
widgetHelpful:"alohaCarrierCompatibilityWidgetHelpful",widgetNotHelpful:"alohaCarrierCompatibilityWidgetNotHelpful"};a.selectors={overviewDropdownId:"aloha-carrier-compatibility-country-dropdown-overview",modalDropdownId:"aloha-carrier-compatibility-country-dropdown-modal",carrierNameClass:".carrier-name",carrierRatingSummaryClass:".carrier-rating-summary",carrierRatingSummary:"carrier-rating-summary",colorClass:"a-color-",textBoldClass:"a-text-bold",compatibleVoiceTextClass:".compatible-voice-text",
compatible2GClass:".compatible-2G",compatible3GClass:".compatible-3G",compatible4GLTEClass:".compatible-4GLTE",checkClass:"aloha-carrier-compatibility-check-icon"};a.$webElements={compatibilityWidget:d("#aloha-carrier-compatibility-widget"),overviewTableRows:d(".aloha-carrier-compatibility-overview-table-row"),modalTableRows:d(".aloha-carrier-compatibility-modal-table-row"),modalFeedback:d("#aloha-carrier-compatibility-modal-feedback"),modalConfirmFeedback:d("#aloha-carrier-compatibility-confirm-feedback")};
a.updateWidget=function(b){var c=a.carrierCompatibilityModel.selectedData.topCarriersByCountryForCurrentAsin[b],e=a.carrierCompatibilityModel.selectedData.allCarriersByCountryForCurrentAsin[b];a.$webElements.overviewTableRows.each(function(b,f){if(b<c.length){var e=c[b];d(f).show();d(f).find(a.selectors.carrierNameClass).text(e.carrierName);a.updateCarrierRatingSummary(e,f)}else d(f).hide()});a.$webElements.modalTableRows.each(function(b,c){if(b<e.length){var f=e[b];d(c).show();d(c).find(a.selectors.carrierNameClass).text(f.carrierName);
a.updateCarrierRatingSummary(f,c);a.updateTechRating(c,f.compatibleVoiceText,a.selectors.compatibleVoiceTextClass);a.updateTechRating(c,f.compatible2G,a.selectors.compatible2GClass);a.updateTechRating(c,f.compatible3G,a.selectors.compatible3GClass);a.updateTechRating(c,f.compatible4GLTE,a.selectors.compatible4GLTEClass)}else d(c).hide()})};a.updateCarrierRatingSummary=function(b,c){var e=d(c).find(a.selectors.carrierRatingSummaryClass);d(e).removeClass();d(e).addClass(a.selectors.carrierRatingSummary);
d(e).text(b.compatibilityRatingSummary);d(e).addClass(a.selectors.colorClass+b.compatibilityRatingSummaryColor);b.compatibilityRatingIsBold&&d(e).addClass(a.selectors.textBoldClass)};a.updateTechRating=function(b,c,e){c==="Check"?(d(b).find(e).addClass(a.selectors.checkClass),d(b).find(e).empty()):(d(b).find(e).removeClass(a.selectors.checkClass),d(b).find(e).text(c))};return a}});h.when("A","a-modal").register("aloha.utils",function(d,e){return{showAjaxErrorModal:function(c,b,a){var d=e.get(c);d===
null?d=e.create(c,{content:a,header:b}):d.update({content:a,header:b});d.show().refresh()}}})})})(function(){var h=window.AmazonUIPageJS||P,d=h.attributeErrors;return d?d("DetailPageAlohaAssets"):h}());
/* ******** */
(function(a){a.execute(function(){})})(function(){var a=window.AmazonUIPageJS||window.P,b=a._namespace||a.attributeErrors;return b?b("HLCXDetailPageAssets"):a}(),window);
/* ******** */
(function(e){e.execute(function(){e.when("A","a-button","a-modal","a-util").register("tradein-self-grading",function(e,b,a,c){function d(a){return e.reduce(t,function(b,c,d){b[d]=e.reduce(a,function(a,b){return Math.abs(t[a]-c)>=Math.abs(t[b]-c)&&t[b]>=c?b:a},"Unacceptable");return b},{})}function m(){return a.get(o(".tradein-grading-header").closest(".a-popover-modal"))}function i(a){var b=function(a,b){if(b==="Unacceptable")return j(a,!1),!0;j(a,!0);var d=s[a][b];h(a+"-condition",b);var e=o("#"+
u+"-graded-"+a+"-price"),f=c.trim(e.html().replace(/[0-9.,]/g,"")),d=Number(d).toFixed(2);e.html(f+d);return!1},d=z[a],a=A[a],g=parseFloat(s.trade[d]);e.trigger("set-tradein-condition-tiv",d,g);d=b("trade",d);b=b("sell",a);return d&&b}function h(a,b){o('input[name="'+a+'"]',o("#tradein-grading-form")).val(b)}function l(a){p!==a&&(p&&o(".tradein-sell-type-"+p).removeClass("tradein-active"),o(".tradein-sell-type-"+a).addClass("tradein-active"),p=a,h("sell-type",p),o("input",o("#sell_type_"+a)).click(),
k("sell_type",!0))}function g(a,d,c){d?(o(".tradein-grade-button").removeClass("shorted"),b(".tradein-grade-button").enable(),o(".tradein-question-text").removeClass("disabled").removeClass("shorted"),o(".tradein-gate").removeClass("disabled")):(o(".tradein-grade-button-"+a).addClass("shorted"),o("#tradein-question-text-"+a).addClass("shorted"),o(".tradein-question-text:not(.shorted)").addClass("disabled"),c==="unacceptable"&&o(".tradein-gate").addClass("disabled"),b(".tradein-grade-button:not(.shorted)").disable())}
function j(a,b){o(".tradein-sell-type-"+a).toggleClass("tradein-hidden",!b);p===a&&k("sell_type",b)}function n(a,b){o("#"+u+"-graded-"+a).toggleClass("tradein-hidden",!b);a==="acceptable"?k("form_complete",b):a==="unacceptable"&&e.trigger("graded_unacceptable",b);m()&&m().updatePosition()}function k(a,b){var d=e.state(x);a in d&&(d[a]=b,e.state(x,d))}function v(a){a=e.reduce(q,function(a,b){return t[b]>t[a]?b:a},a);return i(a)}var o=e.$,q,t,s={},u,p,r,y,z,A,w,x="tradein-grading-gates";return{getQuestionnaire:function(){return q},
configureQuestionnaire:function(a){u=a.asin;t=a.questionnaire.conditions;var b=a.tradein_conditions;b.push("Unacceptable");z=d(b);b=a.sell_conditions;b.push("Unacceptable");A=d(b);y=0;r=a.questionnaire.questions.length;q={};s.trade=a.tradein_offers;s.sell=a.sell_offers;w={Unacceptable:{show:"unacceptable",hide:"acceptable"},New:{show:"acceptable",hide:"unacceptable"},memo:{}};p=null;e.state.replace(x,a.gates);e.trigger("load-saved-tradein-questionnaire-state");l("trade");o(".tradein-grading-header").closest(".a-popover-wrapper").addClass("no-border")},
setQuestionnaire:function(a){q=a},handleAnswer:function(a,b){q[a]||y++;q[a]=b;o("#tradein-question-text-"+a).addClass("a-color-secondary").removeClass("a-color-state");h("question-"+a,b);var d;d=w[b];var c=w.memo;!d&&c[a]?(n(w[c[a]].show,!1),g(a,!0),delete c[a],d=!1):d?(c[a]=b,d.show==="acceptable"&&i(b),n(d.hide,!1),n(d.show,!0),g(a,!1,d.show),d=!0):d=!1;y<r||d||(v(b)?(n("acceptable",!1),n("unacceptable",!0)):(n("acceptable",!0),n("unacceptable",!1)))},setSellType:l,gradeQuestionnaire:v,gateKey:x,
setGate:k}});e.when("A","tradein-self-grading","a-button").execute("registering self-grading actions",function(e,b,a){var c=e.$;e.state.bind(b.gateKey,function(b){var b=e.reduce(b,function(a,b){return a&&b},!0),c=a(".tradein-grade-continue"),i=a("#tradein-grade-next"),h=a("#tradein-grade-skip"),l=a("#tradein-grade-close");b?(c.enable().show(),i.enable().show(),h.disable().hide(),l.disable().hide()):(i.disable(),c.disable())});e.declarative("verify-graded-isbn","click",function(a){a=c("#"+a.data.selector);
b.setGate("isbn_verify",a.is(":checked"))});e.declarative("tradein-question-answer","click",function(a){a=a.data;b.handleAnswer(a.question,a.answer)});e.declarative("choose-graded-item-type","click",function(a){b.setSellType(a.data.sell_type)});e.declarative("add-graded-item","click",function(a){c(":input",a.$currentTarget).is(":disabled")||c("#"+a.data.form_id).submit()});e.on("set-tradein-sellType",function(a){b.setSellType(a)})});e.when("A","tipp-conditions").execute("registering self-grading actions with multi-select",
function(e,b){var a=e.$;e.on("graded_unacceptable",function(c){var d=b.getContinueButton(),e=b.getNextButton(),f=b.getSkipButton(),h=b.getCloseButton(),l=b.getSubtotal(),g=a(".tradein-grade-continue").length===1;c?(g?l>0?(f.enable().show(),h.disable().hide()):(f.disable().hide(),h.enable().show()):(f.enable().show(),h.disable().hide()),d.disable().hide(),e.disable().hide()):(f.disable().hide(),h.disable().hide(),d.show(),e.show())})})})})(function(){var e=window.AmazonUIPageJS||window.P,f=e._namespace||
e.attributeErrors;return f?f("TradeInSelfGradingAssets"):e}(),window);
/* ******** */
(function(a){a.execute(function(){})})(function(){var a=window.AmazonUIPageJS||P,b=a.attributeErrors;return b?b("DetailPageOffersMulticlickAssets"):a}());(function(a){a.execute(function(){})})(function(){var a=window.AmazonUIPageJS||P,b=a.attributeErrors;return b?b("DetailPageDesktopOffersAssets"):a}());
/* ******** */
(function(a){a.execute(function(){})})(function(){var a=window.AmazonUIPageJS||P,b=a.attributeErrors;return b?b("GoldboxUDPAssets"):a}());
/* ******** */
(function(C){C.execute(function(){C.declare("sd_dp_weblab_dependency");C.when("A","jQuery","sd_dp_weblab_dependency").execute(function(H,r){var I,J;function F(a){F.prototype.popoverRangeDisplay=function(c,d){var b=[];b.push(a[c.getUTCMonth()].substr(0,3),"&nbsp;",c.getUTCDate(),", ",c.getUTCFullYear());b.push(" - ");b.push(a[d.getUTCMonth()].substr(0,3),"&nbsp;",d.getUTCDate(),", ",d.getUTCFullYear(),"&nbsp;","&nbsp;","&nbsp;");return b.join("")};F.prototype.timeRangeDisplay=function(a,d){return a+
" - <br/>"+d}}function v(a,c){a="__"+a;c=c&&o.isDebugEnabled();return function(d){function b(a,b,d,f){if(!a[b]||!f)a[b]=d,c&&o.debug("     key "+b+" = "+d)}this[a]||(this[a]={});if(d.data)for(var f in d.data)d.data.hasOwnProperty(f)&&b(this[a],f,d.data[f],d.optional);else if(d.key)if(d.value!==void 0)b(this[a],d.key,d.value,d.optional);else return this[a][d.key]}}function D(a,c,d){var b='<option value="';a&&(b+=a);b+='"';d&&(b+='selected="selected" ');b+=">";b+='<span class="sd-timeslot-rowindex-date">';
c&&(b+=c);b+="</span>";b+="</option>";return b}function G(a){var c=["__",a,"Fn"].join("");return function(a){var b;if(a.register&&a.fn)this[c]||(this[c]=[]),this[c][a.register]=a.fn;if(a.nil&&this[c])for(b in this[c])if(this[c].hasOwnProperty(b))this[c][b]();if(a.arg&&this[c])for(b in this[c])if(this[c].hasOwnProperty(b))this[c][b](a.arg)}}function B(a,c){var d="__dom"+c+"_"+a,b="__dom_cached"+c+"_"+a;return function(){if(this[b]){if(this[d])return this[d]}else{this[b]=!0;var f=this.config({key:a});
f||window.console&&window.console.firebug&&console.warn(["no",c,a,"configured"].join(" "));if(f=SDFramework.jq("#"+f))return this[d]=f;else window.console&&window.console.firebug&&console.warn(["no",c,"DOM element found"].join(" "))}}}function N(a){var c={};c.config=v("region_config");a&&c.config(a);c.add=function(a){if(a)this.__regions=a};c.load=function(a){if(!this.__loadedRegions)this.__loadedRegions=!0,this.__regions?this._insert(a)(this.__regions):this._ajaxLoad(a)};c.pick=function(a){return function(){var b=
SDFramework.jq(["#",this.id," option:selected"].join("")).val();a.config({key:"region",value:b});a.selectCalendar()}};c._insert=function(a){var b=this;return function(c){b.__regions=c;var g="";b.config({key:"str_selectRegion"})&&(g=D("",b.config({key:"str_selectRegion"}),!0));var h=!1,i;for(i in c)c[i].oK&&c[i].oV&&(h=!0,g+=D(c[i].oK,c[i].oV,!1));b._loading(!1);if(c=(c=b.config({key:"dom_regionList"}))?SDFramework.jq("#"+c):0)h?(c.html(g).attr("disabled",!1),c.change(b.pick(a)),c.focus(b.pick(a))):
(c.attr("disabled",!0),(g=b.config({key:"str_noRegions"}))&&c.html(D("",g,!0)))}};c._ajaxLoad=function(a){var b=this._insert(a),a={merchant:a.config({key:"id_merchant"}),marketplace:a.config({key:"id_marketplace"}),ASIN:a.config({key:"id_asin"}),SKU:a.config({key:"id_sku"}),FMID:a.config({key:"id_fmid"}),regionRequest:1};if(this.config({key:"load_url"})){this._loading(!0);var c=SDFramework.jq.getJSON(this.config({key:"load_url"}),a,b);SDFramework.jq().ajaxError(function(){return function(a,d){d===
c&&b()}}())}else b()};c._loading=function(a){var b=this.config({key:"dom_regionLoading"});(b=b?SDFramework.jq("#"+b):0)&&b.css("display",a?"inline":"none");this.config({key:"dom_regionList"})&&SDFramework.jq("#"+this.config({key:"dom_regionList"})).css("display",a?"none":"inline")};return c}function O(a,c,d){var b={pickenabled:0,clickenabled:0};b.config=v("zipcode");a&&b.config(a);b._zi=B("dom_zipInput","zipcode");b.enable=function(a){if(this._zi()&&!this.pickenabled)this._zi().unbind("keyup"),this._zi().bind("keyup",
this.pick(a)),this._zi().bind("keypress",function(a){if(a.keyCode==13)return a.preventDefault(),a.stopPropagation(),!1}),this.pickenabled=1,this._zi().unbind("focus"),this._zi().bind("focus",this.focus(a)),this._zi().unbind("blur"),this._zi().bind("blur",this.blur(a));var b=this.config({key:"dom_zipGo"});if(b&&(b=SDFramework.jq("#"+b))&&!this.clickenabled)b.bind("click",this.click(a)),this.clickenabled=1};b.click=function(a){var b=this,c=this._zi();return function(){b.select(c.val(),a,!0,b.config({key:"postal_code_length"}));
return!1}};b.focus=function(){var a=this;this._zi();return function(){var b=a.config({key:"dom_zipDefaultClass"}),c="#"+a.config({key:"dom_zipInput"}),d="#"+a.config({key:"dom_zipValue"}),j="#"+a.config({key:"dom_zipLabel"});r(c+"."+b).size();d=r(d).html();r(c).val(d);r(c).removeClass(b);r(j).hide()}};b.blur=function(){var a=this;this._zi();return function(){var b="#"+a.config({key:"dom_zipInput"}),c="#"+a.config({key:"dom_zipEmpty"}),d=a.config({key:"dom_zipDefaultClass"}),j="#"+a.config({key:"dom_zipLabel"});
""===r(b).val()&&(c=r(c).html(),r(b).addClass(d),r(b).val(c),r(j).html(c),r(j).show())}};b.selectCallback=function(a,b){this.selectTimer=void 0;a.config({key:"zipcode",value:b});a.selectCalendar()};b.invalidate=function(a,b){var c=this;this.selectTimer&&clearTimeout(this.selectTimer);this.selectTimer=setTimeout(function(){c.selectCallback(a,b)},500)};b.select=function(a,b,c){this&&(this._enter_err&&this._enter_err().css("display","none"),this._valid_err&&this._valid_err().css("display","none"));var d=
"#"+this.config({key:"dom_zipValue"});r(d).html(a);(d=this.is_valid_zip_code(a,this.config({key:"postal_code_length"})))?c&&(this[d]().css("display","block"),b.config({key:"zipcode",value:void 0}),b.unselectCalendar()):this.invalidate(b,a)};b.pick=function(a){var b=this;return function(c){if(this){var i=SDFramework.jq(this).val(),j="#"+b.config({key:"dom_zipPrefix"}),e="#"+b.config({key:"dom_zipEmpty"}),m="#"+b.config({key:"dom_zipValue"}),j=SDFramework.jq(j).html(),e=SDFramework.jq(e).html(),c=r(m).html()!=
i||c.keyCode==13;i&&(i=SDFramework.jq.trim(i.replace(j,"")),i=SDFramework.jq.trim(i.replace(e,"")));d&&c&&b.select(i,a,!0,6)}}};b.validate_zipcode=function(a){function b(a){a||(a="");if(!d.config({key:"postal_format"}).test(a))return"_valid_err"}function c(a){if(!a)return"_enter_err"}var d=this;return a>1?b:c};b._enter_err=B("dom_zipEntError","entererror");b._valid_err=B("dom_zipValError","validerror");b.is_valid_zip_code=b.validate_zipcode(c,b._enter_err,b._valid_err);return b}function Q(a){function c(a,
c,d){function h(a){var b=a.inputs;b&&b.clearSlotFields();if(b=a.message)b.clear(),b.parent&&b.parent()&&b.parent().hide();a.shoppingCart&&a.__setCanPlaceSdOrder(!1);(a=a.cutoff)&&a.enable(!1)}function i(a){var b={};a!==void 0&&a.today!==void 0&&a.c_m_id!==void 0&&a.tmr_m!==void 0&&a.tmr_d!==void 0?(b.today_m=a.c_m_id,b.today_d=a.today,b.tmr_m=a.tmr_m,b.tmr_d=a.tmr_d):(a=new Date,b.today_m=a.getMonth(),b.today_d=a.getDate(),a=new Date(a.getTime()+864E5),b.tmr_m=a.getMonth(),b.tmr_d=a.getDate());return b}
return function(j){if(j)if(c.hasRes(j,d)){var e=c.getRes(j,d);if(e)if(SDUtils.isEmptyObject(e))h(a);else{var m=a.inputs;m&&m.updateSlotFields(e);if(m=a.message){var l=0,w=a.config({key:"sd_calendar"}),n=a.config({key:"id_offerlist_id"});calID=a.zipcode?"Z:"+a.config({key:"zipcode"})+"\nO:"+n:"R:1\nO:"+n;var n=w.calData.getCal(calID),q,s;for(s in n.days)if(n.days.hasOwnProperty(s)){var p=n.days[s];p[0]===j&&(q=p[1])}if((j=a.message.config({key:"timeslotDeterminationFn"}))&&j(n))l=1,m.serviceCharges=
n.serviceCharges;j=w.config({key:"dateDisplay"});m.serviceDisplay=n.serviceDisplay;m.update(e.ultStart,e.ultEnd,l,e,q,j,i(n))}q=a.cutoff;e=e.ultCutoff;q&&e?q.hasTimeLeft(e)?(q.update(e),a.__setCanPlaceSdOrder(!0)):(q.enable(!0,!0),a.__setCanPlaceSdOrder(!1)):a.__setCanPlaceSdOrder(!0)}else h(a)}else h(a);else h(a)}}var d={};d.config=v("config");d.shoppingCart=new I;d.oneClick=new J;d.cutoff=null;d.inputs=new ScheduledDelivery.Data.FormPersistence;d.checkbox=new ScheduledDelivery.BuyBox.SDIntentCheckbox;
d.slotInput=new ScheduledDelivery.BuyBox.SlotStorage(a?a.slotInputClass:"sd_slot_input",a?a.widgetRoot:"sd_div");d.initMessage=function(){this.message=L();this.message.showDropdown=0;this.message.showServices=1};d.noSlotNotSureMessagePresent=!1;d.noSlotUnknownMessagePresent=!1;d.unselectCalendar=function(){var a=this.config({key:"sd_calendar"});a&&(a.deactivateCalendar(),this.onCalendarUnselected())};d.onCalendarUnselected=function(){this.message&&this.message.clear();this.cutoff&&this.cutoff.hasOwnProperty("enable")&&
this.cutoff.enable(!1);var a=this.config({key:"sd_calendar"});if(a)a=a.active,this.slotInput.storeSlotInput(a),this.slotInput.clearSlotInput(a);this.shoppingCart&&this.shoppingCart.hasOwnProperty("enable")&&this.checkbox.isChecked()&&this.__setCanPlaceSdOrder(!1)};d.__setCanPlaceSdOrder=function(a){this.checkbox&&this.checkbox.exists()&&this.checkbox.isChecked()&&this.shoppingCart&&this.shoppingCart.enable(a)};d.selectCalendar=function(){var a=this.config({key:"sd_calendar"});if(a)if(this.config({key:"id_offerlist_id"})===
void 0||this.zipcode&&this.config({key:"zipcode"})===void 0)a.calendar();else if(this.config({key:"id_address"})===void 0&&(this.config({key:"id_marketplace"})==="A1PA6795UKMFR9"||this.config({key:"zipcode"})===void 0))a.buyboxNoAddrMessage(),a.calendar();else{var d=this.config({key:"shipoption"})||0,g=this.config({key:"id_offerlist_id"}),d={merchant:this.config({key:"id_merchant"}),marketplace:this.config({key:"id_marketplace"}),asin:this.config({key:"id_asin"}),quantity:this.config({key:"id_quantity"})?
this.config({key:"id_quantity"}):1,SKU:this.config({key:"id_sku"}),FMID:this.config({key:"id_fmid"}),offerListingID:g,shipoption:d};if(this.zipcode){var h=this.config({key:"zipcode"});d.id="Z:"+h+"\nO:"+g;this.config({key:"isAFN"})===1&&this.config({key:"id_address"})?d.address=this.config({key:"id_address"}):(d.zipcode=h,d.address=h)}else d.id="R:1\nO:"+g,d.region=1;(g=a.config({key:"load_url"}))||(g="/gp/product/features/scheduled-delivery/get-slots-json.html?powerbar=0");a.config({key:"load_url",
value:g});a.config({key:"load_payload",value:d});a.selectCalled({register:"buyboxUI",fn:c(this,a,d.id)});a.calendar(d.id)}};d.initializeDOM=function(a){function c(a){var b=a.config({key:"sd_calendar"}),d=a.slotInput.repopulateSlotInput(b.active),e=a.config({key:"dom_mainElement"}),f=a.config({key:"dom_notSureError"}),g=a.config({key:"dom_unknownError"}),w=a.config({key:"isAFN"});if(e)SDFramework.jq("#"+e).show(),(e=a.shoppingCart)&&a.checkbox&&a.checkbox.exists()&&a.checkbox.isChecked()&&e.enable(d),
(d=a.cutoff)&&d.enable(!1),(d=a.oneClick)&&d.enable(!1),a.regions&&(a.regions.config({key:"load_url",value:"jurisdictions.json"}),a.regions.load(a),a.regions.pick(a)),a.zipcode&&(a.zipcode.enable(a),SDFramework.jq("#sd_zipcode_go").click(),(d=a.config({key:"dom_zipInput"}))&&SDFramework.jq("#"+d).keyup()),b.popup&&b.popup.logClientSideMetrics&&b.popup.logClientSideMetrics(b.popup.clientSideMetrics.selectSD);w===1&&a.noSlotNotSureMessagePresent&&f&&SDFramework.jq("#"+f).show();w===1&&a.noSlotUnknownMessagePresent&&
g&&SDFramework.jq("#"+g).show()}function d(a){var b=a.config({key:"dom_mainElement"}),c=a.config({key:"dom_notSureError"}),e=a.config({key:"dom_unknownError"});b&&(SDFramework.jq("#"+b).hide(),a.shoppingCart&&a.shoppingCart.enable(!0),a.oneClick&&a.oneClick.enable(!0));if(c)a.noSlotNotSureMessagePresent=SDFramework.jq("#"+c).is(":visible"),SDFramework.jq("#"+c).hide();if(e)a.noSlotUnknownMessagePresent=SDFramework.jq("#"+e).is(":visible"),SDFramework.jq("#"+e).hide();b=a.config({key:"sd_calendar"});
c=b.active;b.popup&&b.popup.logClientSideMetrics&&b.popup.logClientSideMetrics(b.popup.clientSideMetrics.unselectSD);a.slotInput.storeSlotInput(c);a.slotInput.clearSlotInput(c)}return function(){var h=a.checkbox;h&&((!h.exists()||h.isChecked())&&c(a),h.bindDOM(),h.onCheck.handlers.add(function(){c(a)}),h.onClear.handlers.add(function(){d(a)}),h.setChecked(!1),h.exists()&&d(a))}}(d);return d}function R(){function a(a,b){if(!a||a.length===0)return 0;var a=a.get(0),c=SDFramework.jq.data(a,"mutex");return b?
c?c+1:1:c&&c>0?c-1:0}var c={};c.config=v("continue");c.enable=function(c){var b=this.config({key:"enabledButton"}),f=this.config({key:"disabledButton"}),b=b?SDFramework.jq("input[name="+b+"]"):null,f=f?SDFramework.jq("#"+f):null;c?a(f,0)||(b&&b.length>0&&b.css("display","block"),f&&f.length>0&&f.css("display","none")):(f&&f.length>0&&(a(f,1),f.css("display","block")),b&&b.length>0&&b.css("display","none"))};return c}function L(){var a={};a.config=v("message");a._dom_container=B("element_container",
"message");a._dom=B("element","message");a._dom_service=B("element_service","message");a.clear=function(){this._dom()&&(this._dom().html(""),this._dom_container().hide());this._dom_service()&&this._dom_service().html("")};a.hide=function(){this._dom()&&(this._dom().hide(),this._dom().parent().hide());this._dom_service()&&(this._dom_service().hide(),this._dom_service().parent().hide())};a.show=function(){this._dom()&&(this._dom_container().show(),this._dom().show());this._dom_service()&&(this._dom_container().show(),
this._dom_service().show())};a.update=function(a,d,b,f,g,h,i){if(!a&&!d)window.console&&window.console.firebug&&window.console.log("message update called with no start or end"),this.clear();else{if(!a||!d)b=!1;if(this._dom()){var j=a?b?this.dateDisplay.slotDisplayDateFn(new Date(a*1E3)):this.dateDisplay.displayDateFn(new Date(a*1E3)):null,h=d?b?this.dateDisplay.slotDisplayDateFn(new Date(d*1E3)):this.dateDisplay.displayDateFn(new Date(d*1E3)):null;b&&f&&(j="&nbsp;"+f.localStartTime,h=f.localEndTime+
" "+this.dateDisplay.displayDateFn(new Date(d*1E3)));d=b?this.config({key:"str_slot"}):this.config({key:"str_date"});b&&f?(b=new Date(a*1E3),b.getUTCDay(),(d=this.showDropdown===0&&this.config({key:"sd_item_delivery_message"})!==void 0?this.config({key:"sd_item_delivery_message"}):this.config({key:"str_slot_message"}))||(d=""),this.showDropdown===0&&(h="",i&&b.getUTCMonth()===i.today_m&&b.getUTCDate()===i.today_d?h=this.config({key:"sd_today"})+",":i&&b.getUTCMonth()===i.tmr_m&&b.getUTCDate()===i.tmr_d&&
(h=this.config({key:"sd_tomorrow"})+","),d=d.replace("%dot",h)),d=d.replace("%dts",f.localStartTime),d=d.replace("%dday",""),d=d.replace("%dte",f.localEndTime),d=d.replace("%dd",g)):(g=d,i=(i=j)?i:"",h=h?h:"",b=b?[i,"-",h].join(" "):i!==""?i:h,d=g+b);this._dom().html(d);this._dom().parent().show();this.showDropdown===0&&this.updateServiceMessage(this.getServices(f.reservationId));this.showServices===1&&this.showAvailableServices()}else window.console&&window.console.firebug&&window.console.warn("No message element available")}};
a.showAvailableServices=function(){this._dom_service().parent().hide();if(!(this.serviceCharges===void 0||this.serviceCharges===null||SDUtils.isEmptyObject(this.serviceCharges))){var a="",d;for(d in this.serviceCharges)if(this.serviceCharges.hasOwnProperty(d)){if(d.indexOf(":")===-1)msg_str=this.serviceDisplay[d].services===void 0?this.serviceDisplay[d].serviceDisplay:this.serviceDisplay[d].services.OLD.serviceDisplay;else{var b=d.split(":");msg_str=this.serviceDisplay[b[0]].services[b[1]].serviceDisplay}msg_str=
msg_str.replace("%formattag_start",'<li class="sd_bb_services">');msg_str=msg_str.replace("%formattag_end","</li>");msg_str=msg_str.replace("%formatCost_start",'<span class="a-color-price">');msg_str=msg_str.replace("%formatCost_end","</span>");msg_str=msg_str.replace("%service_cost",this.serviceCharges[d]);a+=msg_str}this._dom_service().html(a);this._dom_service().parent().show()}};a.updateServiceMessage=function(a){this._dom_service().parent().hide();var d=this.config({key:"sd_item_delivery_service_message"});
if(!(a===null||a.length<1||d===void 0)){for(var b="",f=0;f<a.length;f++)if(a[f].indexOf(":")===-1)b=this.serviceDisplay[a[f]].services===void 0?b+"<br> - "+this.serviceDisplay[a[f]].serviceAbbr:b+"<br> - "+this.serviceDisplay[a[f]].services.OLD.serviceAbbr;else var g=a[f].split(":"),b=b+"<br> - "+this.serviceDisplay[g[0]].services[g[1]].serviceAbbr;d=d.replace("%services",b);this._dom_service().html(d);this._dom_service().parent().show()}};a.getServices=function(a){if(a===null||a===void 0)return null;
a=a.split(";");if(a.length<4||a[3].length<1)return null;for(var a=a[3].split("^"),d=[],b=0;b<a.length;b++)if(a[b].indexOf(":")!==-1)for(var f=a[b].split(":")[1],g=0;g<f.length;g++)d.push(a[b].charAt(0).toUpperCase()+":"+f.charAt(g));else{f=a[b].split("");for(g=0;g<f.length;g++)this.serviceDisplay[f[g].toUpperCase()]!==void 0&&d.push(f[g].toUpperCase())}return d};return a}function S(a){function c(a){var b=a.inputs;b&&b.clearSlotFields();if(b=a.message)b.clear(),b.parent&&b.parent()&&b.parent().hide();
(a=a.cbutton)&&a.enable(0)}function d(a){var b=window.console;b&&b.firebug&&b.warn(a)}function b(a){var b={};a!==void 0&&a.today!==void 0&&a.c_m_id!==void 0&&a.tmr_m!==void 0&&a.tmr_d!==void 0?(b.today_m=a.c_m_id,b.today_d=a.today,b.tmr_m=a.tmr_m,b.tmr_d=a.tmr_d):(a=new Date,b.today_m=a.getMonth(),b.today_d=a.getDate(),a=new Date(a.getTime()+864E5),b.tmr_m=a.getMonth(),b.tmr_d=a.getDate());return b}function f(a,e,f){return function(g){if(g&&!g.nil)if(e.hasRes(g,f)){var h=e.getRes(g,f);SDUtils.isEmptyObject(h)&&
(c(a),d("No reservation selected for "+g));var i=a.inputs;i&&i.updateSlotFields(h);if(i=a.message){var q=0,s=a.config({key:"sd_calendar"}),p=s.calData.getCal(404),o=a.message.config({key:"timeslotDeterminationFn"});o&&o(p)&&(q=1);var u,k;for(k in p.days)p.days.hasOwnProperty(k)&&(o=p.days[k],o[0]===g&&(u=o[1]));g=s.config({key:"dateDisplay"});i.serviceDisplay=p.serviceDisplay;i.update(h.ultStart,h.ultEnd,q,h,u,g,b(p))}(h=a.cbutton)&&h.enable(1)}else c(a),d("Time UI time")}}function g(a,b){if(b){var c=
b.config({key:"sd_calendar"});if(c)if(a){var d;if(ScheduledDelivery.Debug.forceNoSlots)d={};else{d=b.config({key:"id_merchant"});var g=b.config({key:"id_marketplace"}),h=b.config({key:"id_asin"}),i=b.config({key:"id_sku"}),s=b.config({key:"id_fmid"}),p=b.config({key:"id_quantity"}),o=b.config({key:"id_offerlist_id"}),u=b.config({key:"id_address"}),k=b.config({key:"id_itemList_id"}),x=b.config({key:"id_shipoption"}),t;t=r.browser;if(t===null)t="";else{var z="unknown";t.mozilla?z="mozilla":t.msie?z=
"msie":t.webkit?z="webkit":t.safari?z="safari":t.opera&&(z="opera");t=z+":"+t.version}d={merchant:d,marketplace:g,asin:h,sku:i,FMID:s,quantity:p,offerListingID:o,address:u,itemListId:k,shipoption:x,browserType:t,templateSlotID:b.config({key:"id_template_slot"}),ie:"UTF8"}}c.config({key:"load_payload",value:d});(d=c.config({key:"load_url"}))||(d="/gp/product/features/scheduled-delivery/get-slots-json.html?powerbar=0");c.config({key:"load_url",value:d});c.calData.clearCals();c.calendar(404);c.selectCalled({register:"shipoptionUI",
fn:f(b,c,404)})}else c.calendar()}}function h(a){return function(){var b=a.config({key:"id_is_selected"});g(0,a);b&&g(1,a)}}var i={};i.config=v("config");i.inputs=new ScheduledDelivery.Data.FormPersistence;i.message=L();i.cbutton=R();a?r("body").bind(a,h(i)):window.console&&console.warn("Unable to bind load fn to dom element.");return i}function T(){function a(){}function c(a){var c,g,h="";g=0;h+='<table id="sd-timeslot">';h+="<thead>";g="";g+='<tr><td colspan="9"><table class="sd-legend"><tr class="sd-legend">';
g+="<td><table><tr>";g+='<td class="sd-timeslot-weekday-date-small">&nbsp;</td><td><span class"sd-legend">'+d.config({key:"not_available_key"})+"</span></td>";g+="</tr></table></td>";g+="<td><table><tr>";g+='<td class="sd-timeslot-highlight-date-small">&nbsp;</td><td><span class"sd-legend">'+d.config({key:"available_key"})+"</span></td>";g+="</tr></table></td>";g+="<td><table><tr>";g+='<td class="sd-timeslot-selected-date-small">&nbsp;</td><td><span class"sd-legend">'+d.config({key:"selected_key"})+
"</span></td>";g+="</tr></table></td>";g+="</tr></table></td></tr>";h+=g;var i=a.ids;g=new Date;var j=new Date(3E3,0,1);for(c in i)i.hasOwnProperty(c)&&(new Date(i[c].su*1E3)<j&&(j=new Date(i[c].su*1E3)),new Date(i[c].eu*1E3)>g&&(g=new Date(i[c].eu*1E3)));c=j;h+='<tr class="sd-timeslot-scroll-title">';h+='<th><span class="sd-timeslot-scroll-title">'+d.config({key:"months"})[a.c_m_id]+" "+c.getUTCFullYear()+"</span></th>";h+='<th><span class="sd-timeslot-scroll-title">'+d.config({key:"months"})[a.n_m_id]+
" "+g.getUTCFullYear()+"</span></th>";h+="</tr>";h+="</thead>";h+="<tbody>";h+="<tr>";h+='<td valign="top">';h+='<div id="sdcal-curr-month">';h+='<table class="sdcal-table" cellpadding="0" cellspacing="0" width=224px style="table-layout: fixed;">';for(g=0;g<7;g++)h+='<col width="32px"/>';h+='<thead class="sdcal-head">';h+="<tr>";for(g=0;g<7;g++)h+='<td class="sd-timeslot-index-date">'+d.config({key:"days"})[g]+"</td>";h+="</tr>";h+="</thead>";h+="<tbody>";h+="</tbody>";h+="</table>";h+="</div> <\!-- sdcal-curr-month --\>";
h+="</td>";h+='<td valign="top">';h+='<div id="sdcal-next-month" style="float:right;">';h+='<table class="sdcal-table" cellpadding="0" cellspacing="0" width=224px style="table-layout: fixed;">';for(g=0;g<7;g++)h+='<col width="32px"/>';h+='<thead class="sdcal-head">';h+="<tr>";for(g=0;g<7;g++)h+='<td class="sd-timeslot-index-date">'+d.config({key:"days"})[g]+"</td>";h+="</tr>";h+="</thead>";h+="<tbody>";h+="</tbody>";h+="</table>";h+="</div> <\!-- sdcal-next-month --\>";h+="</td>";h+="</tr>";h+="</table>";
return h}var d={};d.config=v("config");d._dom=B("element","popup");d.popupInitialized=!1;d.popupContent=[];d.enable=function(a){a?(a=this.config({key:"linkId"}),a=SDFramework.jq("#"+a),a.show()):((a=this._dom())&&a.hide(),a=this.config({key:"linkId"}),a=SDFramework.jq("#"+a),a.hide())};d.onSelect=function(){var a=this.config({key:"available"}),c=this.config({key:"element"});SDFramework.jq("#"+c+" ."+a).click(function(a){return function(){var b=SDFramework.jq(this).attr("id"),b=a._dateId({parse:b});
a.select(b);b?a.selectCalled({arg:b}):a.selectCalled({nil:!0})}}(this))};d.click=function(){return function(){}};d.setup=function(b){function f(a){var b=Math.ceil((a.c_m_len+a.c_m_delta)/7),a=Math.ceil((a.n_m_len+(a.c_m_delta+a.c_m_len)%7)/7);return Math.max(b,a)}function g(a,b,c){function d(a,b){if(a<1||a>h)return SDFramework.jq("<td>&nbsp;</td>").addClass(b.config({key:"notaday"}));var c=SDFramework.jq("<td>"+a+"</td>");c.addClass(b.config({key:"day"}));c.addClass(b.config({key:"notavailable"}));
c.attr("id",b._dateId({date:a+i}));return c}var g,h,i;c?(g=b.config({key:"next_month_id"}),h=a.n_m_len,i=a.c_m_len,c=(a.c_m_delta+a.c_m_len)%7):(g=b.config({key:"current_month_id"}),h=a.c_m_len,i=0,c=a.c_m_delta);g=["#",b.config({key:"element"})," #",g," table.sdcal-table tbody"].join("");a=f(a);g=SDFramework.jq(g);g.html("");for(var j=0;j<a;++j){for(var o=SDFramework.jq("<tr></tr>"),u=1;u<=7;++u)o.append(d(j*7+u-c,b));g.append(o)}}if(this._dom()){if(!this.popupInitialized){var h=this.config({key:"linkId"}),
i=SDFramework.jq("#"+h);this.popupInitialized=!0}if(h=function(a,b){var c=["c_m_len","c_m_delta","n_m_len"],d;for(d in c)if(c.hasOwnProperty(d)){if(!a.hasOwnProperty(c[d]))return["No",d,"data value"].join(" ");if(a[c[d]]<0)return["Negative",d,"data value",c[d]].join(" ")}c=["next_month_id","current_month_id"];for(d in c)if(!b.config({key:c[d]}))return["No",c[d],"configured"].join(" ")}(b,this))window.console&&window.console.firebug&&console.warn("Invalid data: "+h);else{var j=this.config({key:"element"}),
h=SDFramework.jq("#"+j);h[0]?h[0].innerHTML=c(b):window.console&&window.console.firebug&&console.warn("No "+j+" element");g(b,this,0);g(b,this,1);b.today&&this.config({key:"today"})&&SDFramework.jq(this._dateId({id:b.today})).addClass(this.config({key:"today"}));C.when("jQuery","legacy-popover").execute(function(){i.removeAmazonPopoverTrigger();i.amazonPopoverTrigger({width:540,location:["left","bottom","right"],locationAlign:"middle",localContent:"#"+j,title:'<span class="sd-timeslot-calendar-title">'+
d.config({key:"popup_date_title"})+"</span>",modal:!0,semiStatic:!0,onHide:a,draggable:!0,closeText:d.config({key:"closeText"}),closeEventInclude:["CLICK_OUTSIDE","CLICK_TRIGGER"]})})}}};d._dateId=function(a){if(this.config({key:"prefix"})){if(a.parse)return a.parse.split("-").pop();if(a.date)return[this.config({key:"prefix"}),a.date].join("-");if(a.id){var c=this.config({key:"element"});c&&(c=["#",c," "].join(""));a=[this.config({key:"prefix"}),a.id].join("-");return c+"#"+a}}};d.add=function(a){a=
SDFramework.jq(this._dateId({id:a}));a.removeClass(this.config({key:"notavailable"}));a.addClass(this.config({key:"available"}))};d.selectCalled=G("select");d.select=function(a){var c=this.config({key:"current_month_id"}),d=this.config({key:"next_month_id"}),h=this.config({key:"selected"}),i=this.config({key:"element"}),c=["#",i," #",c," .",h].join(""),d=["#",i," #",d," .",h].join(""),i=SDFramework.jq(c),d=SDFramework.jq(d);i.removeClass(h);d.removeClass(h);a&&(a=this._dateId({id:a}),SDFramework.jq(a).addClass(h))};
return d}function U(){function a(a){return function(){var b=SDFramework.jq(["select#",this.id," option:selected"].join(""));b.val()?a.selectCalled({arg:b.val()}):a.selectCalled({nil:!0})}}var c={};c.config=v("config");c._dom=B("element","dropdrown");c.__slots=[];c.__slotIds={};c.enable=function(c){if(this._dom()){var b=this.config({key:"str_disable"});c?(b&&this.make(),this._dom().attr("disabled",!1),a(this)()):(this._dom().attr("disabled",!0),b&&this._dom().html(D("",b,!0)))}else window.console&&
window.console.firebug&&console.warn("no dropdown DOM element found")};c.make=function(){var a=this.config({key:"str_select"});if(a){this._dom()||window.console&&window.console.firebug&&console.warn("Unable to find DOM element for makeDropdown");a=D("",a,!0);if(this.__slots.length>0){this.__slots.sort(function(a,b){if(a.details.startDateUTC&&a.details.endDateUTC&&b.details.startDateUTC&&b.details.endDateUTC){var c=a.details,d=b.details,f=c.startDateUTC-d.startDateUTC;if(f!==0)return f;f=c.endDateUTC-
d.endDateUTC;return f!==0?f:(c.services!==void 0?c.services:"").length<=(d.services!==void 0?d.services:"").length}var c=a.id,d=b.id,g=f=0,h=0,i=0;c.indexOf("-")>=0?(f=parseInt(c.substring(0,c.indexOf("-")),10),g=parseInt(c.substring(c.indexOf("-")+1),10)):f=parseInt(c,10);d.indexOf("-")>=0?(h=parseInt(d.substring(0,d.indexOf("-")),10),i=parseInt(d.substring(d.indexOf("-")+1),10)):h=parseInt(d,10);return(f-h)*100+(g-i)});for(var b=0;b<this.__slots.length;b++){var c=this.__slots[b],g=c.id,c=c.details,
h=c.name,i="";c.services&&c.services.length>0&&(i=c.services.sort().join(""));a+=D(g,h,!1,i)}}this._dom().html(a)}else window.console&&window.console.firebug&&console.warn("Missing str_select for makeDropdown")};c.clear=function(){this.__slots=[];this.__slotIds={}};c.add=function(a,b,c,g,h){if(!this.__slotIds[a]){this.__slotIds[a]=1;var i={};i.name=b;i.startDateUTC=g;i.endDateUTC=h;i.services=c?c:"";b={};b.id=a;b.details=i;this.__slots.push(b)}};c.selectCalled=G("select");c.select=function(a){try{this._dom().val(a)}catch(b){}};
c.onSelect=function(){this._dom().change(a(this));this._dom().focus(a(this))};return c}function V(){function a(a,b){var c=a.ids[b];if(!c)return!1;var g=a.shipOfferingID,h=a.carrierFss,i;if(h){i=(new ScheduledDelivery.Data.ReservationIdParser(c.id)).getCarriers();for(var j=[],e=0;e<i.length;e++)j.push(h[i[e]]);i=ScheduledDelivery.Data.FulfillmentServiceSubclass.pickTightestSla.apply(void 0,j)}SDFramework.jq("#sd_buybox_root").trigger("slotSelected");return{slotId:c.srsids,reservationId:c.id,reservationType:c.rt,
start:c.su,ultStart:c.s,mltStart:c.sm,localStartTime:c.sut,end:c.eu,ultEnd:c.e,mltEnd:c.em,localEndTime:c.eut,cutoff:c.cu,ultCutoff:c.c,mltCutoff:c.cm,timeZone:c.t,tz:c.tz,minShip:c.minShip,maxShip:c.maxShip,shipOffer:g,fss:i}}var c={};c.calendarData=v("calendar_data");c.clearCals=function(){this.__calendar_data=null;this.calendarData=v("calendar_data")};c.getCal=function(a){return this.calendarData({key:a})};c.hasCal=function(a){return this.calendarData({key:a})?!0:!1};c.hasRes=function(c,b){if(!c)return!1;
if(!this.hasCal(b))return o.debug("no cal for "+b),!1;var f=this.getCal(b);if(!f.ids)return o.debug("no ids in cal "+b),!1;f=a(f,c);return SDUtils.isEmptyObject(f)?(o.debug("No res data for "+c),!1):!0};c.getRes=function(c,b){if(!this.hasRes(c,b))return{};var f=this.getCal(b);return!f.ids[c]?(o.warn("getRes messup"),{}):a(f,c)};c.load=function(a,b){b._loading(!0);var c=b.config({key:"load_url"});window.console&&window.console.firebug&&console.warn("loading URL : "+c);var g=b.config({key:"load_payload"}),
c={url:c,type:"POST",dataType:"json",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:g,traditional:!0,success:function(a,b,c){return function(d){c.calendarData({key:b,value:d});a._loading(!1);a.calendar(b);SDFramework.jq("#sd_buybox_root").trigger("slotsReturned")}}(b,a,this),error:function(a){return function(){window.console&&window.console.firebug&&console.warn("unable to get calendar");a._loading(!1,1);a.deactivateCalendar();SDFramework.jq("#sd_buybox_root").trigger("slotsErrored")}}(b,
a,this),timeout:2E4};SDFramework.jq.ajax(c)};return c}function K(a,c,d,b,f,g,h,i){var j={};j.identifier=a;j.startDate=c;j.startDateUTC=c;j.endDate=d;j.endDateUTC=d;j.key=f;j.selected=!1;j.textDisplay=g;j.cost=0;j.areNonVisibleServices=!1;j.config=v("config");j.showAsterisk=function(){return this.areNonVisibleServices&&i};j.getServices=function(a){for(var b=[],a=a.split("^"),c=0;c<a.length;c++){var d=a[c];if(d.indexOf(":")!==-1)for(var g=d.split(":"),d=g[0],g=g[1],f=0;f<g.length;f++)b.push(d+":"+g.charAt(f));
else for(g=0;g<d.length;g++)b.push(d.charAt(g))}return b};j.initializeWithScheduledDelivery=function(a){this.identifier=a.id;this.startDate=new Date(a.s*1E3);this.endDate=new Date(a.e*1E3);this.startDateUTC=new Date(a.su*1E3);this.endDateUTC=new Date(a.eu*1E3);this.startTimeDisplay=a.sut;this.endTimeDisplay=a.eut;this.promotion=a.prom;this.cost=a.costDisplay;this.services=this.getServices(a.service);this.areNonVisibleServices=!1;this.serviceDisplay="";for(var b in this.services)if(this.services.hasOwnProperty(b))a=
this.services[b].charAt(0),h[a]?this.serviceDisplay+=h[a].serviceAbbr+", ":this.areNonVisibleServices=!0;this.serviceDisplay=this.serviceDisplay.length>0?this.serviceDisplay.substring(0,this.serviceDisplay.length-2):""};b&&j.initializeWithScheduledDelivery(b);j.selectSlot=function(a){this.selected=a};j.timePlacement=function(a,b,c){var d=a.getTime(),g=this.startDate.getTime(),f,h;switch(c){case "D":f=d/864E5|0;h=g/864E5|0;break;case "H":f=a.getUTCHours();h=this.startDate.getUTCHours();break;case "M":f=
a.getUTCMinutes(),h=this.startDate.getUTCMinutes()}return(h-f)/b|0};j.slotPlacement=function(a,b,c,d){return{timeSpot:this.timePlacement(a,c,d),daySpot:this.timePlacement(a,b,"D")}};j.toString=function(){var a=this.startTimeDisplay,b=this.endTimeDisplay,a=this.textDisplay?a+"-"+b+" "+this.textDisplay:this.dateDisplay&&this.dateDisplay.displayDateFn?a+"-"+b+" "+this.dateDisplay.displayDateFn(this.endDate):a+"-"+b+" "+this.endDate.toDateString(),b=!this.cost||this.cost.match(/^\s*$/)||this.cost=="open"||
this.cost=="&nbsp;"?"&nbsp;":"("+this.cost+")",c="";this.showAsterisk()&&(c="*");return[a," ",this.serviceDisplay," ",b,c].join("")};return j}function W(a,c){function d(a,b){var c=null;a.indexOf(":")!==-1?(c=a.split(":"),c=b[c[0]].services[c[1]]):c=b[a];return c}function b(a){if(a===void 0)return"";for(var b=[],c=0;c<a.length;c++)if(a[c].indexOf("^")!==-1)b.push(a[c]);else for(var d=a[c].split(""),e=0;e<d.length;e++)b.push(d[e]);b.sort();return b.join("^")}var f={};f.config=v("config");f.parent=a;
f.uiOwner=c;f.slots=[];f.allSlots=[];f.currentServices=[];f.slotsPerService=[];f.slotsForServiceCombinations=[];f.services=[];f.serviceStrings=[];f.pivotDateTime=null;f.pivotDay=3;f.nightSlotEndTimeLimit=19;f.initialized=!1;f.initialize=function(a,b){if(!this.initialized){if(!this.daySpan)this.daySpan=this.uiOwner.config({key:"daySpan"});if(!this.dayLength)this.dayLength=this.uiOwner.config({key:"dayLength"});this.setPivotDate(a);this.initializeServiceType("",!0);this.defaultSlotId=b;this.initialized=
!0}};f.getDefaultBaseSlot=function(){if(this.serviceStrings===void 0)return this.sortedSlotList()[0];for(var a=0;a<this.sortedSlotList().length;a++){var b=this.sortedSlotList()[a],c=b.services;if(c===void 0||c.length<1)return b;if(!this.containVisibleService(c))return b}return this.sortedSlotList()[0]};f.containVisibleService=function(a){for(var b=0;b<a.length;b++)if(this.serviceStrings[a[b]]!==void 0)return!0;return!1};f.getDefaultSlot=function(a){if(this.defaultSlotId)return this.defaultSlotId===
"NO_DEFAULT"?null:this.getSlotByKey(this.defaultSlotId);if(a===0)return this.getDefaultBaseSlot();for(var b=a=null,c=0;c<this.sortedSlotList().length;c++){var d=this.sortedSlotList()[c];if(parseInt(d.endTimeDisplay.split(":")[0],10)>=this.nightSlotEndTimeLimit){if(a===null||a.startDateUTC>d.startDateUTC)a=d}else if(b===null||b.startDateUTC>d.startDateUTC)b=d}return b!==null?b:a};f.setSlots=function(a,b){var c=new Date,f=a.getCal(b);this.initialize(c,f.defaultSlotId);if(f){var e=this.uiOwner.config({key:"surcharge_message"}),
e=e&&e.indexOf("*")>=0,m;for(m in f.ids)if(f.ids.hasOwnProperty(m)){var l=void 0,w=void 0;for(w in f.days)f.days[w][0]&&f.days[w][0]==m&&(l=f.days[w][1]);l=K(null,null,null,f.ids[m],m,l,f.serviceDisplay,e);w=f.serviceDisplay;if(l.endDate>new Date){var n=l,q=this.parent.config({key:"dateDisplay"});n.dateDisplay=q;this.allSlots.push(l);var n=l.services,q=w,s=[],p=void 0;for(p in n)(n[p].indexOf(":")!==-1||q[n[p]])&&s.push(n[p]);s.length===0&&s.push("");n=s;q=null;if(n.length>1){n.sort();s=n.join("");
p=void 0;for(p in n)n.hasOwnProperty(p)&&(this.currentServices[n[p]]=!1,(q=d(n[p],w))||(n[p]=""),n[p]===""&&(this.slots.push(l),this.currentServices[""]=!0),this.services[n[p]]=n[p]);this.slotsForServiceCombinations[s]||(this.slotsForServiceCombinations[s]=[]);this.slotsForServiceCombinations[s].push(l)}else n.length==1&&(n=n[0],this.currentServices[n]=!1,(q=d(n,w))||(n=""),n===""&&(this.slots.push(l),this.currentServices[""]=!0),this.slotsPerService[n]||(this.slotsPerService[n]=[]),this.slotsPerService[n].push(l),
this.services[n]=n)}}this.copyServiceStrings(f.serviceDisplay);this.formatServiceChargesString(f.serviceCharges)}f=c;m=this.uiOwner.config({key:"dayLength"});e=m/2|0;f=this.sortedSlotList()[0].startDate;this.orderDayAsFirstDay===1&&(f=c);this.setPivotDay((f.getUTCDay()+e)%m);this.setPivotDate(f)};f.copyServiceStrings=function(a){for(var b in a)if(a.hasOwnProperty(b)&&(this.serviceStrings[b]={serviceString:a[b].serviceString,serviceLearnMore:a[b].serviceLearnMore},a[b].services)){var c=a[b].services,
d;for(d in c)c.hasOwnProperty(d)&&(this.serviceStrings[b+":"+d]={serviceString:c[d].serviceString,serviceLearnMore:c[d].serviceLearnMore})}};f.formatServiceChargesString=function(a){for(var b in a)if(a.hasOwnProperty(b)&&this.serviceStrings.hasOwnProperty(b)&&this.serviceStrings[b].serviceString)this.serviceStrings[b].serviceString=this.serviceStrings[b].serviceString.replace("%service_cost",a[b])};f.initializeServiceType=function(a,b){this.currentServices[a]=b};f.setServiceType=function(a,b){this.currentServices[a]===
void 0&&(a="");this.currentServices[a]=b;var c=[],d;for(d in this.currentServices)typeof d!="undefined"&&d!==""&&this.currentServices[d]&&c.push(d);c.length===0?this.slots=this.slotsPerService[""]:c.length==1?this.slots=this.slotsPerService[c[0]]:(c.sort(),this.slots=this.slotsForServiceCombinations[c.join("")])};f.lastGrid=null;f.setPivotDay=function(a){if(a>=0&&a<=6)this.pivotDay=a};f.setPivotDate=function(a){this.pivotDateTime=a?new Date(a.getTime()):new Date;this.pivotDateTime.setUTCHours(0,0,
0,0);var b=this.pivotDateTime.getUTCDay();this.pivotDateTime.setUTCDate(this.pivotDateTime.getUTCDate()+this.pivotDay-b);this.pivotDateTime.setUTCDate(this.pivotDateTime.getUTCDate());var b=this.uiOwner.config({key:"dayLength"}),c=+b/2|0,d=new Date(this.pivotDateTime.getTime());d.setUTCDate(d.getUTCDate()-c);var e=new Date(this.pivotDateTime.getTime());e.setUTCDate(e.getUTCDate()+c);e.setUTCHours(23,59,59,999);a.getTime()>e.getTime()?this.pivotDateTime.setUTCDate(this.pivotDateTime.getUTCDate()+b):
a.getTime()<d.getTime()&&this.pivotDateTime.setUTCDate(this.pivotDateTime.getUTCDate()-b)};f.slotsInRange=function(){var a=+this.uiOwner.config({key:"dayLength"})/2|0,b=new Date(this.pivotDateTime);b.setUTCDate(b.getUTCDate()-a);a=[];this.sortedSlotList();if(this.slots)for(var c=0;c<this.slots.length;c++){var d=this.slots[c].timePlacement(b,this.daySpan,"D");d>=0&&d<this.dayLength&&(a[d]||(a[d]=[]),a[d].push(this.slots[c]))}return this.lastGrid=a};f.sortedSlotList=function(){this.initialize(new Date);
return this.allSlots.sort(function(a,b){return a.startDate-b.startDate===0?a.endDate-b.endDate:a.startDate-b.startDate})};f.orderedRowKeys=function(){var a=[],b=[],c=0;for(c in this.lastGrid)if(c==parseInt(c,10))for(var d in this.lastGrid[c])d==parseInt(d,10)&&a.push({start:this.lastGrid[c][d].startDate.getUTCHours()*60+this.lastGrid[c][d].startDate.getUTCMinutes(),end:this.lastGrid[c][d].endDate.getUTCHours()*60+this.lastGrid[c][d].endDate.getUTCMinutes(),stime:this.lastGrid[c][d].startTimeDisplay,
etime:this.lastGrid[c][d].endTimeDisplay});a.sort(function(a,b){return a.start==b.start?a.end-b.end:a.start-b.start});a.length>0&&b.push(a[0]);for(c=1;c<a.length;c++)(a[c-1].start!=a[c].start||a[c-1].end!=a[c].end)&&b.push(a[c]);return b};f.getSlotById=function(a){if(!a)return null;for(var b=0;b<this.allSlots.length;b++)if(this.allSlots[b].identifier==a)return this.allSlots[b];return null};f.getSlotByTimes=function(a,c,d){if(!a||!c||!d||!this.allSlots)return null;var f=d.split(";"),d=[];f.length>=
4&&(d=f[3].split("^"));for(f=0;f<this.allSlots.length;f++){var e=this.allSlots[f];if(e.startDate.getTime()==a*1E3&&e.endDate.getTime()==c*1E3&&b(e.services)===b(d))return e}return null};f.getCurrentSlotByTimes=function(a,b){if(!a||!b||!this.slots)return null;for(var c=0;c<this.slots.length;c++){var d=this.slots[c];if(d.startDate.getTime()==a&&d.endDate.getTime()==b)return d}return null};f.getSlotByKey=function(a){for(var b=0;b<this.allSlots.length;b++)if(this.allSlots[b].key===a)return this.allSlots[b];
return null};return f}function X(a){function c(a,b){var c,d=e.config({key:"notavailable"});c=e.config({key:"slotButton"});var f="",g="";if(a===-1&&b===-1)return d=e.config({key:"notavailable"}),c='<td class="'+c+'" rowspan="1">',c+='<div class="'+d+'">',c+="</div>",c+="</td>",c;var h=1;if(e.model.lastGrid[b])for(var i=0;i<e.model.lastGrid[b].length;i++)if(a.start==e.model.lastGrid[b][i].startDate.getUTCHours()*60+e.model.lastGrid[b][i].startDate.getUTCMinutes()&&a.end==e.model.lastGrid[b][i].endDate.getUTCHours()*
60+e.model.lastGrid[b][i].endDate.getUTCMinutes()){d=e.config({key:"available"});e.model.lastGrid[b][i].promotion&&(d+=" "+e.config({key:"promotionavailable"}));f=e.model.lastGrid[b][i].key;g=e.model.lastGrid[b][i].cost;e.model.lastGrid[b][i].showAsterisk()&&(g+="*");var j=e.model.lastGrid[b][i],k=e.selected_id;if(!k&&j.selected||k==j.key)d+=" "+e.config({key:"selected"});if(e.model.lastGrid[b][i].rowspan!==void 0)h=e.model.rowspan}[e.config({key:"prefix"}),f].join("-");c='<td id="'+f+'" class="'+
c+" "+d+' ap_custom_close" rowspan="'+h+'">';c+=d===e.config({key:"notavailable"})?"&nbsp;":g;c+="</td>";return c}function d(a,b){var c=a+"Nav"+b,d="";d+='<td class="'+e.config({key:c+"Class"})+'">';d+=e.config({key:c+"Inner"});d+="</td>";return d}function b(){function b(){var c=e.model.pivotDateTime.getUTCMonth(),d=e.model.pivotDateTime.getUTCFullYear(),f=e.model.pivotDateTime.getUTCDate();if(e.selected_id===void 0)e.selected_id=SDFramework.jq("#"+e.config({key:"element"})+" ."+e.config({key:"selected"})).attr("id");
e.navigateLateralSlots(0,f,c,d);c=e.selected_id;d=d=null;c&&(d=e.model.getSlotByKey(c),d=e.model.getCurrentSlotByTimes(d.startDate.getTime(),d.endDate.getTime()));if(d)a.enableInconsistentWithBuybox(!1),e.selected_id=d.key,j(e,d.key)}function c(){var b=this.id;SDFramework.jq(this).bind("click",function(){a.enableInconsistentWithBuybox(!1);e.selected_id=b;j(e,b)});SDFramework.jq(this).dblclick(function(){SDFramework.jq(".ap_close").click()})}var d=SDFramework.jq(".sd-timeslot-scroll-title-left-enabled"),
f=SDFramework.jq(".sd-timeslot-scroll-title-right-enabled"),g=SDFramework.jq("td."+e.config({key:"available"})),h=SDFramework.jq("td."+e.config({key:"selected"}));d.bind("click",function(){var a=e.model.pivotDateTime.getUTCMonth(),b=e.model.pivotDateTime.getUTCFullYear(),c=e.model.pivotDateTime.getUTCDate();e.navigateLateralSlots(-1,c,a,b)});f.bind("click",function(){var a=e.model.pivotDateTime.getUTCMonth(),b=e.model.pivotDateTime.getUTCFullYear(),c=e.model.pivotDateTime.getUTCDate();e.navigateLateralSlots(1,
c,a,b)});SDFramework.jq(".sdServiceType").click(function(){var a=SDFramework.jq(this),c=a.is(":checked"),a=a.attr("servicetype");e.selectService(a,c);b()});SDFramework.jq(".sdHSelectServiceType").change(function(){SDFramework.jq(".sdHServiceType",this).each(function(){var a=SDFramework.jq(this),b=a.is(":selected"),a=a.attr("servicetype");e.selectService(a,b)});setTimeout(b,0)});g.each(c);h.each(c)}function f(a,b,c){for(var d=0;d<c.length;d++)if(a==c[d].startDate.getUTCHours()*60+c[d].startDate.getUTCMinutes()&&
b==c[d].endDate.getUTCHours()*60+c[d].endDate.getUTCMinutes())return d;return-1}function g(a){var b=0;if(a.length<3)return null;for(var c=-1,b=0;b<a.length-2;b++)if(a[b].start==a[b+1].start){c=b;break}if(c<0)return null;for(var d=a[c].end,e=a[c+1].end,b=c+2;b<a.length;b++){if(a[b].start!=d||a[b].end>e)break;else if(a[b].end==e)return[c,b];d=a[b].end}return null}function h(){var a=e.config({key:"rootWidgetId"});SDFramework.jq("#"+a).attr("alreadyShowingPopup",1);e.showDropdown===0&&SDFramework.jq("#"+
a).parents("td").eq(0).prev().find("input[type=radio]").click();window.popoverTimer&&(a=window.popoverTimer[e.config({key:"widgetIndex"})],a!==void 0&&clearTimeout(a));e.logClientSideMetrics(e.clientSideMetrics.openCalendar);for(var a=e.selectedSlot!==null?e.selectedSlot.services:[],c=0;c<a.length;c++)e.model.setServiceType(a[c],1);a=e.config({key:"element"});a=SDFramework.jq("#"+a);c=e.getCalendarHtml();if(a&&a[0])a[0].innerHTML=c;b();SDFramework.jq("#ap_overlay").bind("touchend",function(){this.click()})}
function i(){e.select(e.selected_id);e.logClientSideMetrics(e.clientSideMetrics.closeCalendar);var a=e.config({key:"rootWidgetId"});SDFramework.jq("#"+a).attr("alreadyShowingPopup",0)}function j(a,b){var c=a.config({key:"element"}),d=a.config({key:"selected"});a.config({key:"available"});SDFramework.jq("#"+c+" ."+d).removeClass(d);b&&(SDFramework.jq("#"+b).addClass(d),c=a.model.getSlotByKey(b),a.logClientSideMetricsForSlot(a.clientSideMetrics.selectSlot,c))}var e={};e.config=v("config");e._dom=B("element",
"popup");e.popupInitialized=!1;e.model=W(a,e);e.selectedSlot=null;e.enable=function(a){a?(a=this.config({key:"linkId"}),a=SDFramework.jq("#"+a),a.show()):(this._dom()&&this._dom().hide(),a=this.config({key:"linkId"}),a=SDFramework.jq("#"+a),a.hide())};e.onSelect=function(){};e.click=function(){};e.colorSwatch=function(){var a=[];a.push('<div class="calendar-header">');a.push('<span class="calendar-swatch calendar-not-available">&nbsp;</span><span class="calendar-legend">'+e.config({key:"not_available_key"})+
"</span>");a.push('<span class="calendar-swatch calendar-available">&nbsp;</span><span class="calendar-legend">'+e.config({key:"available_key"})+"</span>");a.push('<span class="calendar-swatch calendar-selected">&nbsp;</span><span class="calendar-legend">'+e.config({key:"selected_key"})+"</span>");this.promotionAvailable&&a.push('<span class="calendar-swatch calendar-promotion-available">&nbsp;</span><span class="calendar-legend">'+e.config({key:"promotion_available_key"})+"</span>");a.push("</div>");
return a.join("")};e.refreshSlots=function(){for(var a in this.model.allSlots)if(this.model.allSlots.hasOwnProperty(a)){var b=this.model.allSlots[a];if(b.originalEndDate)b.endDate=b.originalEndDate;if(b.originalEndTimeDisplay)b.endTimeDisplay=b.originalEndTimeDisplay;b.rowspan=void 0;if(b.promotion!==void 0)this.promotionAvailable=!0}};e.getCalendarHtml=function(){var a=this.config({key:"days"}),b,f,h,i,j,p,o=this.config({key:"dayLength"}),u=+o/2|0;b=f=0;var k="";this.model.initialize(new Date);this.refreshSlots();
this.model.slotsInRange();k+=this.colorSwatch();k+='<table class="sd-timeslot-header" border=0 cellpadding=2 cellspacing=0 width="470">';k+="<thead>";j=new Date(this.model.pivotDateTime.getTime());j.setUTCDate(j.getUTCDate()-u);p=new Date(this.model.pivotDateTime.getTime());p.setUTCDate(p.getUTCDate()+u);b=j.getUTCDay();h=this.model.pivotDateTime.getUTCMonth();i=this.model.pivotDateTime.getUTCFullYear();f=this.model.pivotDateTime.getUTCDate();var x;x=this.config({key:"surcharge_message"});var t=[];
t.push('<tr class="sd_notice">');t.push('<td colspan="3">');t.push('<span class="sd_notice">');t.push(x);t.push("</span>");t.push("</td>");t.push("</tr>");t.push("<tr>");t.push('<td colspan="3">');t.push('<hr class="sd_dashed" />');t.push("</td>");t.push("</tr>");x=t.join("");k+=x;x="";t=e.config({key:"months"});t=new F(t);x+='<tr class="sd-timeslot-scroll-title">';x+=d("left",e._canMove(-1,f,h,i)?"Enabled":"Disabled");x+='<td class="sd-timeslot-scroll-title">';x+='<span class="sd-timeslot-scroll-title">';
x+=t.popoverRangeDisplay(j,p);x+="</span>";x+="</td>";x+=d("right",e._canMove(1,f,h,i)?"Enabled":"Disabled");x+="</tr>";k+=x;k+="</thead>";k+="</table>";k+='<table class="sd-timeslot-table" width="470px" style="table-layout: fixed;">';k+="<tbody>";this.model.monthOfDays=[];this.model.dayOfDays=[];h=new Date;k+='<tr class="sd-timeslot-index-date">';k+='<th class="sd-timeslot-index-date sdleft">&nbsp;</th>';for(f=i=0;f<=u*2;f++)p=new Date(j.getTime()),p.setDate(p.getUTCDate()+f),k+='<th class="sd-timeslot-index-date">',
x=(b+f)%7,x=x<0?7+x:x,k+='<span class="sd-timeslot-index-date">',k+=this.model.orderDayAsFirstDay===1&&e.config({key:"sd_today"})!==void 0&&h.getFullYear()===p.getFullYear()&&h.getUTCMonth()===p.getUTCMonth()&&h.getUTCDate()===p.getUTCDate()?e.config({key:"sd_today"}):a[x],k+="<br />"+p.getDate(),k+="</span>",k+="</th>",this.model.monthOfDays[i]=p.getUTCMonth(),this.model.dayOfDays[i]=p.getUTCDate(),i++;k+="</tr>";a=this.model.orderedRowKeys(!0);if(a.length===0){k+="<tr>";for(b=-u;b<=u;b++)k+=c(-1,
-1);k+="</tr>";k+="<tr>";k+='<td class="sd-timeslot-index-date sdleft"></td>';k+='<td class="sd-message" colspan='+o+'><span class="sd-message">'+e.config({key:"no_slots_for_week"})+"</span></td>";k+="</tr>"}this.model.cellsToMerge=g(a);this.model.availableDay=void 0;this.model.hideCells={};this.model.cellsToMerge!==null&&e.checkSlots(a);if(this.model.availableDay!==void 0&&this.model.availableDay<=0)a.splice(this.model.cellsToMerge[0]+1,1),this.model.rowspan=this.model.cellsToMerge[1]-this.model.cellsToMerge[0];
u=new F(e.config({key:"months"}));for(f=0;f<a.length;f++){j=a[f];b=[j.stime,j.etime];k+="<tr>";k+='<td class="sd-timeslot-rowindex-date sdleft"><span class="sd-timeslot-rowindex-date">'+u.timeRangeDisplay(b[0],b[1])+"</span></td>";for(b=0;b<o;b++)e.isHidden(f,b)===void 0&&(k+=c(j,b));k+="</tr>"}k+="</tbody>";k+="</table>";var u={},o={},r;for(r in this.model.services)r.indexOf(":")!==-1&&(a=r.split(":"),o[a[0]]!==void 0?o[a[0]].push(a[1]):(o[a[0]]=[],o[a[0]].push(a[1]),u[a[0]]=1));for(var v in this.model.services)if(this.model.services.hasOwnProperty(v)&&
v.indexOf(":")===-1)u[v]?o[v].push("OLD"):(r=k,k=v,e.config({key:"strings"}),e.model.serviceStrings[k]?(a=e.model.serviceStrings[k].serviceString,b=e.model.serviceStrings[k].serviceLearnMore,j=[],j.push('<div class="sd_notice">'),a&&(j.push('<input type="checkbox" class="sdServiceType" ',e.model.currentServices[k]?"checked":"",' serviceType="',k,'" />'),j.push(a)),b&&(j.push(" "),j.push(b)),j.push("</div>"),k=j.join("")):k="",k=r+k);for(var A in o)if(o.hasOwnProperty(A)){k+='<div class="sd_notice">';
k+="<br />";k+=e.model.serviceStrings[A].serviceString;e.model.serviceStrings[A].serviceLearnMore&&(k+=" "+e.model.serviceStrings[A].serviceLearnMore);k+="<br />";k+='<select class="sdHSelectServiceType">';k+='<option value="none">-</option>';for(v=0;v<o[A].length;v++)r=o[A][v],u=A+":"+r,a=!1,b="",a=r==="OLD"?e.model.currentServices[A]:e.model.currentServices[u],b=e.model.serviceStrings[u].serviceString,k+='<option class="sdHServiceType" servicetype="',k+=r==="OLD"?A:u,k+='"',a&&(k+='selected="selected"'),
k+=">",k+=b,k+="</option>";k+="</select>";k+="</div>"}return k};e.checkSlots=function(a){var b=this.config({key:"dayLength"});this.model.availableDay=0;this.model.matchingDays=[];for(var c=0;c<b;c++)this.model.lastGrid[c]&&e.processMatchingColumn(e.checkColumn(a,c),a,c);e.hideRow(b)};e.hideRow=function(){if(!(this.model.availableDay<=0))for(var a=0;a<this.model.matchingDays.length;a++)e.hideOneCell(this.model.cellsToMerge[1],this.model.matchingDays[a])};e.processMatchingColumn=function(a,b,c){if(!(a<
0)){a=this.model.lastGrid[c][a];a.originalEndDate=new Date(a.endDate.getTime());a.originalEndTimeDisplay=a.endTimeDisplay;a.endDate.setUTCHours(b[this.model.cellsToMerge[0]].end/60|0);a.endDate.setUTCMinutes(b[this.model.cellsToMerge[0]].end%60);a.endTimeDisplay=b[this.model.cellsToMerge[0]].etime;a.rowspan=1;for(b=this.model.cellsToMerge[0]+1;b<this.model.cellsToMerge[1];b++)e.hideOneCell(b,c);this.model.rowspan=this.model.cellsToMerge[1]-this.model.cellsToMerge[0]+1}};e.checkColumn=function(a,b){var c=
this.model.cellsToMerge[0],d=f(a[c+1].start,a[c+1].end,this.model.lastGrid[b]);if(d<0)return-1;this.model.availableDay++;if(f(a[c].start,a[c].end,this.model.lastGrid[b])>=0)return-1;for(c+=2;c<a.length&&c<=this.model.cellsToMerge[1];c++)if(f(a[c].start,a[c].end,this.model.lastGrid[b])>=0)return-1;this.model.availableDay--;this.model.matchingDays.push(b);return d};e.isHidden=function(a,b){return this.model.hideCells['"'+this.model.monthOfDays[b]+"-"+this.model.dayOfDays[b]+"-"+a+'"']};e.hideOneCell=
function(a,b){this.model.hideCells['"'+this.model.monthOfDays[b]+"-"+this.model.dayOfDays[b]+"-"+a+'"']=1};e.clientSideMetrics={};e.clientSideMetrics.selectSD="1";e.clientSideMetrics.loadSlots="2";e.clientSideMetrics.openCalendar="3";e.clientSideMetrics.selectSlot="4";e.clientSideMetrics.closeCalendar="5";e.clientSideMetrics.nextPageCalendar="6";e.clientSideMetrics.prevPageCalendar="7";e.clientSideMetrics.unselectSD="8";e.clientSideMetrics.selectionChanged="9";e.logClientSideMetrics=function(a){this.logClientSideMetricsForSlot(a,
this.selectedSlot)};e.logClientSideMetricsForSlot=function(a,b){var c="",d="",e="",f="",g="",h="",i="",j="DP",o="";if(this.model){if(this.model.parent){if(e=this.model.parent.config({key:"load_payload"}))c=e.marketplace,d=e.asin,h=e.shipoption,o=e.address;this.model.parent.isSpc&&this.model.parent.isSpc()?j="SPC":(e=this.model.parent.config({key:"id_select_fn"}))&&(e.substring(0,20)==="shipoptionselectpage"?j="SOSP":e==="emptySetSOCallback"&&(j="YA"))}e=this.model.getDefaultBaseSlot().startDate.getTime()}if(b)f=
b.startDate.getTime(),g=b.services,i=b.identifier;if(d instanceof Array)for(var t=0;t<d.length;t++)ue.log(["mpid=",c,"&asin=",d[t],"&a=",a,"&fas=",e,"&ss=",f,"&svc=",encodeURIComponent(g),"&so=",encodeURIComponent(h),"&sid=",encodeURIComponent(i),"&page=",j,"&addr=",o].join(""),"scheduled-delivery",null);else ue.log(["mpid=",c,"&asin=",d,"&a=",a,"&fas=",e,"&ss=",f,"&svc=",encodeURIComponent(g),"&so=",encodeURIComponent(h),"&sid=",encodeURIComponent(i),"&page=",j,"&addr=",o].join(""),"scheduled-delivery",
null)};e.setup=function(a){if(!this.popupInitialized){var c=this.config({key:"linkId"}),d=SDFramework.jq("#"+c);this.popupInitialized=!0}var f=this;if(this._dom())if((c=function(a,b){var c=["c_m_len","c_m_delta","n_m_len","timeslots"],d;for(d in c)if(c.hasOwnProperty(d)){if(!a.hasOwnProperty(c[d]))return["No",d,"data value"].join(" ");if(a[c[d]]<0)return["Negative",d,"data value",c[d]].join(" ")}c=["next_month_id","current_month_id"];for(d in c)if(!b.config({key:c[d]}))return["No",c[d],"configured"].join(" ")}(a,
this))&&window.console&&window.console.firebug)console.warn("Invalid data: "+c);else{a.today&&this.config({key:"today"})&&SDFramework.jq(this._dateId({id:a.today})).addClass(this.config({key:"today"}));var g=f.config({key:"element"});C.when("jQuery","legacy-popover").execute(function(){d.removeAmazonPopoverTrigger();d.unbind("touchend.sd");d.bind("touchend.sd",function(){this.click()});d.unbind("click.sd");d.bind("click.sd",function(){return!SDUtils.protectAgainstDoubleAction("calendarButton")});
d.amazonPopoverTrigger({width:545,location:["left","bottom","right","top","centered"],locationAlign:"middle",localContent:"#"+g,title:'<span class="sd-timeslot-calendar-title">'+e.config({key:"popup_time_title"})+"</span>",modal:!0,semiStatic:!0,onShow:h,onHide:i,draggable:!0,closeText:e.config({key:"closeText"}),closeEventInclude:["CLICK_OUTSIDE","CLICK_TRIGGER"]})});(function(){var a=f.config({key:"element"}),a=SDFramework.jq("#"+a),c=f.getCalendarHtml();if(a&&a[0])a[0].innerHTML=c;b()})()}};e._dateId=
function(a){if(this.config({key:"prefix"})){if(a.parse)return a.parse.split("-").pop();if(a.date)return[this.config({key:"prefix"}),a.date].join("-");if(a.id){var b=this.config({key:"element"});b&&(b=["#",b," "].join(""));a=[this.config({key:"prefix"}),a.id].join("-");return b+"#"+a}}};e.add=function(){};e.selectCalled=G("select");e.selectService=function(a,b){this.model.setServiceType(a,b)};e.select=function(a){var b=this.config({key:"element"}),c=this.config({key:"selected"});this.config({key:"available"});
this.config({key:"slotButton"});SDFramework.jq("#"+b+" ."+c).removeClass(c);if(a&&(SDFramework.jq("#"+a).addClass(c),this.selectCalled({arg:a}),b=!1,c="",this.selectedSlot?(c=this.selectedSlot.key,this.selectedSlot.selected=!1):b=!0,this.selectedSlot=this.model.getSlotByKey(a)))this.selectedSlot.selected=!0,b?this.logClientSideMetrics(this.clientSideMetrics.loadSlots):c!==this.selectedSlot.key&&this.logClientSideMetrics(this.clientSideMetrics.selectionChanged);this.selectedSlot&&this.model.setPivotDate(this.selectedSlot.startDate)};
e._canMove=function(a,b,c,d){var e=this.model.sortedSlotList(),f=e[0],e=e[e.length-1],g=new Date,h=this.config({key:"dayLength"});if(!f||!e)return!1;var i=+h/2|0;g.setUTCFullYear(2004);g.setUTCMonth(0);g.setUTCDate(1);g.setUTCFullYear(d);g.setUTCMonth(c);g.setUTCDate(b);g.setUTCHours(0,0,0,0);g.setUTCDate(g.getUTCDate()+a*h);a=new Date(g.getTime());a.setUTCDate(a.getUTCDate()-i);a.setUTCHours(0,0,0,0);b=new Date(g.getTime());b.setUTCDate(b.getUTCDate()+i);b.setUTCHours(23,59,59,999);return b<new Date?
!1:b<f.endDate?!1:a>e.startDate?!1:!0};e.navigateLateralSlots=function(a,c,d,e){if(this._canMove(a,c,d,e)){var f=SDFramework.jq("#"+this.config({key:"element"})),g=new Date,h=this.config({key:"dayLength"});g.setUTCFullYear(2004);g.setUTCMonth(0);g.setUTCDate(1);g.setUTCFullYear(e);g.setUTCMonth(d);g.setUTCDate(c);g.setUTCHours(0,0,0,0);g.setUTCDate(g.getUTCDate()+a*h);this.model.setPivotDate(g);this.model.slotsInRange();c=this.getCalendarHtml();f.html(c);b();f=a===-1?this.clientSideMetrics.prevPageCalendar:
this.clientSideMetrics.nextPageCalendar;a!==0&&this.logClientSideMetrics(f);return c}};return e}function Y(){function a(a,b,c,d){var e=SDUtils.isBeacon(a);c?e&&b>0?a.slideDown(b):a.show():e&&b>0?a.slideUp(b):a.hide();a=a.parents(".sd_widget_root").find(".sd_controls");d?a.show():a.hide()}function c(a,b){a.each(function(){m(this).amazonPopoverTrigger({location:["right","auto"],locationAlign:"top",locationMargin:-10,width:null,skin:null,hoverHideDelay:0,hoverShowDelay:0,showOnHover:!0,showCloseButton:!1,
literalContent:b})})}function d(a){a.css("cursor","not-allowed");a.addClass("sd-disabled")}function b(a){a.css("cursor","");a.removeClass("sd-disabled")}function f(a,b){var c={noSlotNotSure:m("#"+a.config({key:"dom_noslotsNotSure"})),noSlotUnknown:m("#"+a.config({key:"dom_noslotsUnknown"})),ineligibleZip:m("#"+a.config({key:"dom_slotsContent"})),slotsContent:m("#"+a.config({key:"dom_slotsContent"}))},d;for(d in c)d===b?c[d].show():c[d].hide()}function g(g,h,i){if(g.config({key:"hideWidgetOnError"})){var j=
i?i.slotQualityInfo:null,i=j?j.slotQualityDetail:"",j=j?j.errorCode:"";h||(i="NORMAL");h="noSlotUnknown";switch(i){case "SYSTEM_UNKNOWN_PROMISE":h="noSlotUnknown";"JurisdictionNotFound"===j&&(h="slotsContent");break;case "BUSINESS_UNKNOWN_PROMISE":case "CAPACITY_FULL":h="noSlotUnknown";break;case "SD_INVENTORY_STATE_RESTRICTED":h="noSlotNotSure";break;case "NORMAL":h="slotsContent"}f(g,h);var h={JurisdictionNotFound:m("#"+g.config({key:"dom_zipEntError"}))},l;for(l in h)l===j?h[l].show():h[l].hide();
e(g,"NORMAL"===i)}else{if(g.config({key:"load_payload"}).marketplace=="ATVPDKIKX0DER"&&h){switch(i.slotQualityInfo.slotQualityDetail){case "CAPACITY_FULL":l=".sd_call_date_msg";break;case "SD_INVENTORY_STATE_RESTRICTED":l=".sd_estimate_msg";break;default:l=".sd_no_promise_msg"}m(".sd_phone_number").css("position","static");l=m(l).html();m(".sd_change_phone_number").length!==0&&(l+=m(".sd_change_phone_number").html())}else l=i?i.errorMsg:"";var j=g.config({key:"dom_noslots"}),j=m("#"+j),n=g.config({key:"dom_reload"}),
n=m("#"+n),q=g.config({key:"message_hook"}),o=m("#calendarLink"+g.popup.__config.widgetIndex),r;q&&q.length>0&&(r=q.add(o).add("#sd_dummy_click_div_"+g.popup.__config.widgetIndex));h?(r?(h=r,c(h,'<div class="sdWarn"><span class="swSprite s_alertSm"></span>'+l+"</div>"),d(h)):(l&&(h=j.find("div.sd_err_from_result_content"),h.html(l),SDUtils.isBeacon(j)&&(h=h.find("h6"),h.contents().replaceAll(h).wrap("<h4/>"))),a(j,w,!0,!1),d(o)),n.show(),g.disableAndDeselect(i)):(r?(h=r,h.removeAmazonPopoverTrigger(),
b(h)):b(o),a(j,0,!1,!0),n.hide(),g=m("#"+g.config({key:"dom_widget_root"})).parents("td").eq(0).prev().find("input[type=radio]"),g.removeAttr("disabled"),g.parents("div.fake-label.a-box").removeClass("sd-disabled"))}}function h(a){if(a.isSpc()){var b=a.config({key:"dom_widget_root"}),a=a.config({key:"dom_no_widget_root"});m("#"+b+" .sd_widget").show();m("#"+b).show();m("#"+a).hide()}}function i(a){if(a.isSpc()){var b=a.config({key:"id_is_selected"}),c=a.config({key:"dom_widget_root"}),a=a.config({key:"dom_no_widget_root"});
b?(m("#"+c+" .sd_widget").show(),m("#"+c).show(),m("#"+a).hide()):(m("#"+c+" .sd_widget").show(),m("#"+c).hide(),m("#"+a).show())}}function j(a,b){var c=new ScheduledDelivery.Data.ReservationIdParser(a),d=new ScheduledDelivery.Data.ReservationIdParser(b),e=c.getCharges(),f=d.getCharges();return e.currencyCode===f.currencyCode&&Math.abs(f.perItem-e.perItem)<0.01&&Math.abs(f.perShipment-e.perShipment)<0.01&&c.getEncodedServices()===d.getEncodedServices()}function e(a,b){var c=m("#"+a.config({key:"dom_slotTrigger"}));
c.prop?c.prop("disabled",!b):b?c.removeAttr("disabled"):c.attr("disabled","disabled");b?c.parents("."+n).removeClass(q):c.parents("."+n).addClass(q)}var m=SDFramework.jq,l={},w=300,n="sd-button",q="sd-button-disabled";l.icon=v("icon");l.config=v("config");l.calData=V(this);l.popup={};l.popup.config=v("config");l.popup.selectCalled=G("select");l.dropdown=U();l.active=void 0;l.enableInconsistentWithBuybox=function(b){var c=this.config({key:"dom_inconsistent"});a(m("#"+c),200,b,!0)};l.buyboxNoAddrMessage=
function(){f(this,"noSlotUnknown")};l.isSpc=function(){var a=this.config({key:"id_select_fn"});return a&&a.substring(0,7)==="spcpage"};l.isSosp=function(){var a=this.config({key:"id_select_fn"});return a&&a.substring(0,20)==="shipoptionselectpage"};l.isSpcSd=function(){if(this.isSpc()){var a=this.config({key:"message_hook"});return a&&a.length>0&&a.attr("src").indexOf("radio-on")>=0}return!1};l.spcThrowCvIfSelected=function(){if(this.isSpcSd()){r("#"+this.config({key:"dom_widget_root"})+" input[type=hidden]").attr("value",
"");var a=this.config({key:"id_select_fn"});(a=a&&eval(a))&&a({},this.config({key:"dom_widget_root"}))}};l.handleNoSlotSelection=function(){if(this.isSosp()){var a=this.config({key:"dom_widget_root"}),a=SDFramework.jq("#"+a);a.find(".sd_change_phone_number").show();a.find(".sd_promises").show();a.find(".sd_promise_msg").show();a.find(".sd_promise_msg >span").addClass("sd_no_slot_selection_msg")}};l.calendar=function(a){if(a)if(this.calData.hasCal(a)){this._loading(!1);this._enableIcon(!0);e(this,
!0);var b=this.config({key:"dom_retry"}),c=this;m("#"+b).click(function(){f(c,"slotsContent")});b=null;if(!this.active||this.active!=a){var d=this.calData.getCal(a),k=this.popup.__config,n=this.popup.__selectFn;if(!d||!d.days||d.days.length===0){h(this);g(this,!0,d);this.deactivateCalendar();this.active=0;this.spcThrowCvIfSelected();return}else g(this,!1),i(this);var w=this.config({key:"timeslotDeterminationFn"});if(w&&w(d)){this.popup=X(this);this.popup.__config=k;this.popup.__selectFn=n;C.when("scheduledDelivery",
"ready").execute(l.getDocLoadFn());this.popup.showDropdown=this.showDropdown;this.popup.model.orderDayAsFirstDay=this.orderDayAsFirstDay;this.popup.model.setSlots(this.calData,a);b=this.popup.model.getSlotByTimes(this.config({key:"selectedStart"}),this.config({key:"selectedEnd"}),this.config({key:"selectedSlot"}));!b&&this.config({key:"selectedStart"})&&this.config({key:"selectedEnd"})?(this.enableInconsistentWithBuybox(!0),b=this.popup.model.getDefaultSlot(this.daySlotAsDefaultSlot),this.spcThrowCvIfSelected()):
b?this.enableInconsistentWithBuybox(!1):b=this.popup.model.getDefaultSlot(this.daySlotAsDefaultSlot);var q=m("#sd_dummy_click_div_"+k.widgetIndex);q&&q.length>0&&q.click(function(a){var b=r("#sd_widgets_"+k.widgetIndex).parents("td").eq(0).prev().find("input[type=image]");b&&b.length>0&&b.click();a.stopPropagation()})}else{this.popup=T();this.popup.__config=k;this.popup.__selectFn=n;d=this.calData.getCal(a).ids;n=this.config({key:"selectedStart"});w=this.config({key:"selectedEnd"});for(q in d)if(d[q].hasOwnProperty("s")&&
d[q].hasOwnProperty("e")){var o=d[q].s,v=d[q].e,A=d[q].eu;d[q].su==n&&A==w&&(b||(b=K(null,null,null,d[q],q)));o==n&&v==w&&(b||(b=K(null,null,null,d[q],q)))}b?this.enableInconsistentWithBuybox(!1):(this.enableInconsistentWithBuybox(!0),this.spcThrowCvIfSelected());m(document).ready(l.getDocLoadFn())}this.active=a;this._changeCalendar()}this.dropdown&&this.dropdown.hasOwnProperty("enable")&&this.dropdown.enable(!0);this.popup&&this.popup.hasOwnProperty("enable")&&this.popup.enable(!0);b?(this.isSpcSd()&&
!j(b.identifier,this.config({key:"selectedSlot"}))&&this.config({key:"existing",value:"populating this field here will force a resubmit on the following call"}),this.popup.select(b.key),this.dropdown&&(this.dropdown.select(b.key),this.dropdown.selectCalled({arg:b.key}),this.dropdown._dom().change(function(){}))):this.handleNoSlotSelection()}else this._loadCalendar(a);else this.deactivateCalendar()};l.deactivateCalendar=function(){this._enableIcon(!1);e(this,!1);this.dropdown&&this.dropdown.hasOwnProperty("enable")&&
this.dropdown.enable(!1);this.popup&&this.popup.hasOwnProperty("enable")&&this.popup.enable(!1);var a=this.config({key:"clientCallbacks"});a&&a.calendarDisabled&&a.calendarDisabled()};l._changeCalendar=function(){var a=this.calData.getCal(this.active);this.popup&&this.popup.setup(a);this.dropdown&&this.dropdown.clear();if(!a||!a.days)window.console&&window.console.firebug&&console.warn("no calendar data"),this.deactivateCalendar();else{var b=this.config({key:"timeslotDeterminationFn"});if(b&&b(a)){var a=
this.popup.model.sortedSlotList(),c;for(c in a)if(c){var d=a[c];this.popup&&this.popup.add(d.key);this.dropdown&&this.dropdown.add(d.key,d.toString(),d.services,d.startDateUTC,d.endDateUTC)}}else for(d in a.days)a.days.hasOwnProperty(d)&&(c=a.days[d][0],b=a.days[d][1],this.popup&&this.popup.add(c),this.dropdown&&this.dropdown.add(c,b,""));this.dropdown&&(this.dropdown.make(),this.dropdown.onSelect());if(this.popup)this.popup.onSelect();a=function(){};c=function(){};this.dropdown&&(a=function(a){var b=
a.dropdown;return function(a){b.select(a)}});this.popup&&(c=function(a){var b=a.popup;return function(a){b.select(a)}});if(this.dropdown||this.popup){this.popup.selectCalled({register:"dropdown",fn:a(this)});this.dropdown&&this.dropdown.selectCalled({register:"popup",fn:c(this)});var e=this,a=function(a){if(!a||!e.config({key:"existing"})||e.config({key:"existing"})==a)e.config({key:"existing",value:a});else{e.config({key:"existing",value:a});var a=e.config({key:"id_select_fn"}),b={};r("#"+e.config({key:"dom_widget_root"})+
" input[type=hidden]").each(function(){var a=r(this).attr("key"),c=r(this).attr("value");a&&(b[a]=c)});var c;a&&(c=eval(a));a=e.config({key:"dom_widget_root"});c&&c(b,a)}};window.$&&this.config({key:"message_hook"})&&$(this.config({key:"message_hook"}).get(0)).unbind("click");(c=this.config({key:"message_hook"}))&&c.length>0&&c.attr("src").indexOf("radio-on")==-1&&c.bind("click",a);this.popup&&this.popup.selectCalled({register:"rcxCallback",fn:a});this.dropdown&&this.dropdown.selectCalled({register:"rcxCallback",
fn:a})}}};l.selectCalled=function(a){this.dropdown&&this.dropdown.selectCalled(a);this.popup&&this.popup.selectCalled&&this.popup.selectCalled(a)};l.hasRes=function(a,b){return this.calData.hasRes(a,b)};l.getRes=function(a,b){return this.calData.getRes(a,b)};l._loadCalendar=function(a){this.calData.hasCal(a)&&this.calendar(a);this.calData.load(a,this)};l._enableIcon=function(a){var b=this.icon({key:"dom_disabled"}),c=this.icon({key:"dom_enabled"});b?(b=m(b),a?b.hide():b.show()):window.console&&window.console.firebug&&
console.warn("no disabled calendar icon configured");c?(c=m(c),a?c.show():c.hide()):window.console&&window.console.firebug&&console.warn("no active calendar icon configured")};l._getConfigDOM=function(a){a=this.config({key:a});return m(a?"#"+a:[])};l.disableAndDeselect=function(a){var b=m("#"+this.config({key:"dom_widget_root"})).parents("td").eq(0).prev().find("input:radio"),c=m("input[name='csm.scheduledDelivery']");(c.length===0||m("input[name="+b.attr("name")+"]:radio:not(:disabled)").length>
1)&&this.config({key:"load_payload"}).marketplace!="ATVPDKIKX0DER"?(b.attr("disabled","disabled"),b.is(":checked")&&m("input[name="+b.attr("name")+"]:radio:not(:disabled):first").attr("checked",!0)):(a=a?a.defaultDates:{ultStart:2E5,ultEnd:200001,timeZone:"PST",minShip:1,maxShip:2},c.attr("value",encodeURIComponent(ScheduledDelivery.Data.Json.serialize({refdataVersion:"AFN",slot:{reservationId:"X",start:a.ultStart,mltStart:a.ultStart,end:a.ultEnd,mltEnd:a.ultEnd,timeZone:a.timeZone,tz:"America/Los_Angeles",
minShip:a.minShip,maxShip:a.maxShip,fss:"NOT_FAST_TRACK"},qualityInfo:{slotQuality:"DEFERRED",slotQualityDetail:"BUSINESS_UNKNOWN_PROMISE"}}))));b.parents("div.fake-label.a-box").addClass("sd-disabled")};l._loading=function(b,c){var d=this._getConfigDOM("dom_loadbar"),e=this._getConfigDOM("dom_reload"),f=this._getConfigDOM("dom_failbar"),g=this._getConfigDOM("dom_bar");b?(g.hide(),a(f,100,!1,!1),e.hide(),d.show()):c?(d.hide(),g.hide(),a(f,100,!0,!1),e.show(),this.disableAndDeselect()):(d.hide(),a(f,
100,!1,!0),e.hide(),g.show())};l.getDocLoadFn=function(){var a=this;return function(){var b=a.icon({key:"dom_enabled"});b&&(b=m(b),a.popup.hasOwnProperty("click")&&b.click(a.popup.click()))}};m(document).ready(l.getDocLoadFn());return l}function A(a){A.prototype.months=[a.strings["assoc-january_5173"],a.strings["assoc-february_5174"],a.strings["assoc-march_5175"],a.strings["assoc-april_5176"],a.strings["assoc-may_5177"],a.strings["assoc-june_5178"],a.strings["assoc-july_5179"],a.strings["assoc-august_5180"],
a.strings["assoc-september_5181"],a.strings["assoc-october_5182"],a.strings["assoc-november_5183"],a.strings["assoc-december_5184"]];A.prototype.days=[a.strings.sd_sunday_short,a.strings.sd_monday_short,a.strings.sd_tuesday_short,a.strings.sd_wednesday_short,a.strings.sd_thursday_short,a.strings.sd_friday_short,a.strings.sd_saturday_short];A.prototype.weekdays=[a.strings.sd_sunday,a.strings.sd_monday,a.strings.sd_tuesday,a.strings.sd_wednesday,a.strings.sd_thursday,a.strings.sd_friday,a.strings.sd_saturday];
A.prototype.monthShort=[a.strings.sd_january_abbrev,a.strings.sd_february_abbrev,a.strings.sd_march_abbrev,a.strings.sd_april_abbrev,a.strings.sd_may_abbrev,a.strings.sd_june_abbrev,a.strings.sd_july_abbrev,a.strings.sd_august_abbrev,a.strings.sd_september_abbrev,a.strings.sd_october_abbrev,a.strings.sd_november_abbrev,a.strings.sd_december_abbrev];a.locale_date==97?(A.prototype.textDateFn=function(a){return a.getUTCFullYear()+" "+this.months[a.getUTCMonth()].substr(0,3)+" "+a.getUTCDate()},A.prototype.displayDateFn=
function(a){return this.weekdays[a.getUTCDay()]+", "+a.getUTCFullYear()+" "+this.months[a.getUTCMonth()]+" "+a.getUTCDate()}):a.locale_date==15?(A.prototype.textDateFn=function(a){return a.getUTCDate()+" "+this.months[a.getUTCMonth()].substr(0,3)+" "+a.getUTCFullYear()},A.prototype.displayDateFn=function(a){return this.weekdays[a.getUTCDay()]+", "+a.getUTCDate()+" "+this.months[a.getUTCMonth()]+" "+a.getUTCFullYear()}):(A.prototype.textDateFn=function(a){return this.months[a.getUTCMonth()].substr(0,
3)+" "+a.getUTCDate()+", "+a.getUTCFullYear()},A.prototype.displayDateFn=function(a){return this.weekdays[a.getUTCDay()]+", "+this.months[a.getUTCMonth()]+" "+a.getUTCDate()+", "+a.getUTCFullYear()});A.prototype.slotDisplayDateFn=function(a){var d;if(a){var b=a.getUTCHours();a.getUTCMinutes();d=b>11?"pm":"am";b%=12;b=b===0?12:b;b+=d;d=b}else d=null;return d+" "+this.displayDateFn(a)}}function M(a){function c(a,b){a&&(a.config({data:{day:b.strings.day_33013,days:b.strings.days_30885,hour:b.strings.hour_33014,
hours:b.strings.hours_30886,min:b.strings.minute_33015,mins:b.strings.minutes_30887,str_missed:"The time to place this order has passed.",str_gen_before:"Order within the next "}}),f?a.config({key:"str_gen_after",value:"to guarantee installation date."}):a.config({key:"str_gen_after",value:"to guarantee delivery date."}))}function d(a,b){a&&a.config({data:{str_noRegions:b.strings.sd_no_regions,str_selectRegion:b.strings.sd_select_region_37475}})}function b(a,b){a&&(b.marketplaceID=="ATVPDKIKX0DER"||
b.marketplaceID=="A1PA6795UKMFR9"||b.marketplaceID=="A13V1IB3VIYZZH"?a.config({key:"postal_format",value:/^\d{5}$/}):b.marketplaceID=="A1F83G8C2ARO7P"?a.config({key:"postal_format",value:/^[a-zA-Z]{1,2}[0-9rR][0-9a-zA-Z]? [0-9][abd-hjlnp-uw-zABD-HJLNP-UW-Z]{2}$/}):b.marketplaceID=="A1VC38T7YXB528"&&a.config({key:"postal_format",value:/^\d{3}-?\d{4}$/}),a.config({data:{str_length_error:b.strings.sd_zip_format_error,str_enter_error:b.strings.sd_postal_required_error,str_enter:b.strings.sd_enter_postal_code}}))}
var f=a.merchantType&&a.merchantType.indexOf("Installation")!==-1;if(a){var g=a.calendar,h=a.checkout,i=a.buybox,h=a.shipoption||h||i,j=new A(a);if(g){g.dateDisplay=j;g.config({key:"dateDisplay",value:j});g.popup.config({key:"months",value:j.months});g.popup.config({key:"days",value:j.days});j=a.strings.sd_popover_close;if(!j||j==="")j=a.strings.click_close_5690;g.popup.config({key:"closeText",value:j})}(function(b){if(!b||!b.message)return{};if(b=b.message)f?b.config({data:{str_date:a.strings.sd_install_order_date,
str_slot:a.strings.sd_install_order_time}}):(b.config({data:{str_date:a.strings.sd_delivery_order_date,str_slot:a.strings.sd_delivery_order_time,sd_item_delivery_message:a.strings.sd_item_delivery_message,sd_item_delivery_service_message:a.strings.sd_item_delivery_service_message,sd_installation:a.strings.sd_installation,sd_recycling:a.strings.sd_recycling,sd_haulaway:a.strings.sd_haulaway,sd_today:a.strings.sd_today,sd_tomorrow:a.strings.sd_tomorrow}}),a.strings.sd_for_these_items_range?b.config({key:"str_slot_message",
value:a.strings.sd_for_these_items_range}):b.config({key:"str_slot_message",value:a.strings.sd_for_this_item_range}));return b})(h).dateDisplay=new A(a);(function(b){if(b){var c=b.dropdown;c&&(c.config({key:"str_select",value:a.strings.select_date_34088}),a.buybox?c.config({key:"str_disable",value:a.strings.sd_select_postal_code}):c.config({key:"str_disable",value:a.strings.sd_select_option}));if(c=b.popup)c.config({key:"sd_today",value:a.strings.sd_today}),c.config({key:"not_available_key",value:a.strings.sd_capacity_notavailable_52061}),
c.config({key:"available_key",value:a.strings.sd_capacity_available_52060}),c.config({key:"promotion_available_key",value:a.strings.sd_capacity_promotion_available}),c.config({key:"selected_key",value:a.strings.sd_selected}),c.config({key:"no_slots_for_week",value:a.strings.sd_no_slots_for_week}),f?(c.config({key:"popup_time_title",value:a.strings.sd_select_install_time}),c.config({key:"popup_date_title",value:a.strings.sd_select_install_date})):(c.config({key:"popup_time_title",value:a.strings.sd_select_delivery_time}),
c.config({key:"popup_date_title",value:a.strings.sd_select_delivery_date})),c.config({key:"strings",value:a.strings}),c.config({key:"surcharge_message",value:a.sdUseCase==="MFN2013"&&a.strings.sd_surcharge_notice_mfn||a.strings.sd_surcharge_notice_afn||a.strings.sd_surcharge_notice});a.buybox?b.config({key:"pickDateText",value:a.strings.sd_select_postal_code}):b.config({key:"pickDateText",value:a.strings.sd_select_option});b.config({key:"showDropdown"})===0&&b.config({key:"sd_item_delivery_message",
value:a.strings.sd_item_delivery_message});b.config({key:"learnMoreText",value:a.strings.sd_learn_more});b.config({key:"reloadText",value:a.strings.sd_reload});f?(b.config({key:"noSlotsAddress",value:a.strings.sd_no_installation_times}),b.config({key:"retrieveError",value:a.strings.sd_install_retrieve_error}),a.merchantType.indexOf("Local")===-1?b.config({key:"noSlotsAddressBB",value:a.strings.sd_install_no_scheduled_error}):b.config({key:"noSlotsAddressBB",value:a.strings.sd_installation_not_available_for_zipcode})):
(b.config({key:"noSlotsAddress",value:a.strings.sd_no_delivery_times}),b.config({key:"retrieveError",value:a.strings.sd_delivery_retrieve_error}),b.config({key:"noSlotsAddressBB",value:a.strings.sd_delivery_no_scheduled_error}));b.config({key:"inconsistentWithBuybox",value:a.strings.sd_previous_slot_not_available});b.config({key:"tryAgain",value:a.strings.sd_try_again});b.config({key:"sd_select_another_date_and_time",value:a.strings.sd_select_another_date_and_time})}})(g);if(i)g=i.config,f?g({data:{str_select_date:a.strings.sd_select_install_date}}):
g({data:{str_select_date:a.strings.sd_select_delivery_date}}),c(i.cutoff,a),d(i.regions,a),b(i.zipcode,a)}}function E(a,c,d,b,f,g){c=c?c:{};this.UISettings=b=b?b:{};this.domSettings=f;this.dataField=g;this.UISettings.showDropdown=this.UISettings.showDropdown!==void 0&&this.UISettings.showDropdown===0?0:1;this.UISettings.orderDayAsFirstDay=this.UISettings.orderDayAsFirstDay!==void 0&&this.UISettings.orderDayAsFirstDay===1?1:0;this.UISettings.daySlotAsDefaultSlot=this.UISettings.daySlotAsDefaultSlot!==
void 0&&this.UISettings.daySlotAsDefaultSlot===1?1:0;this.calendarRef=Y();this.widgetIndex=a;this.calendarRef.orderDayAsFirstDay=this.UISettings.orderDayAsFirstDay;this.calendarRef.daySlotAsDefaultSlot=this.UISettings.daySlotAsDefaultSlot;this.calendarRef.showDropdown=this.UISettings.showDropdown;E.prototype.isTimeslot=function(a){if(!a||!a.hasOwnProperty("ids"))return!1;if(b.sdUseCase==="MFN2013")return!0;var c=0,d;for(d in a.ids)if(a.ids.hasOwnProperty(d)&&a.ids[d]){var e=a.ids[d];if(e.hasOwnProperty("e")&&
e.hasOwnProperty("s")&&(e.e-e.s)/3600<23){c=1;break}}return c||a.timeslots};this.calendarRef.config({key:"dateDisplay",value:this.dateDisplay});this.calendarRef.config({data:{id_merchant:"A1",id_marketplace:"M1",timeslotDeterminationFn:this.isTimeslot}});this.UISettings.showDropdown===1?this.calendarRef.dropdown.config({key:"element",value:"sduiDropdown"+a}):this.calendarRef.dropdown=null;this.calendarRef.popup.config({data:{element:"sdcal-popup"+a,current_month_id:"sdcal-curr-month",next_month_id:"sdcal-next-month",
notaday:"sdcal-notaday",day:"sdcal-day",notavailable:"sdcal-noavail",available:"sdcal-avail",promotionavailable:"sdcal-promavail",selected:"sdcal-select",today:"sdcal-today",prefix:"sdcal",closeText:"close",slotButton:"sd-timeslot-slot",daySpan:"1",dayLength:7,linkId:f?f.widgetRoot+" ."+f.calendarTrigger:"calendarLink"+a,rootWidgetId:f?f.widgetRoot:"sd_widgets_"+a,widgetIndex:a,leftNavEnabledClass:"sd-timeslot-scroll-title-left-enabled",leftNavEnabledInner:"&#8249;&#8249;",leftNavDisabledClass:"sd-timeslot-scroll-title-left-disabled",
leftNavDisabledInner:"&#8249;&#8249;",rightNavEnabledClass:"sd-timeslot-scroll-title-right-enabled",rightNavEnabledInner:"&#8250;&#8250;",rightNavDisabledClass:"sd-timeslot-scroll-title-right-disabled",rightNavDisabledInner:"&#8250;&#8250;"}},1);this.calendarRef.config({key:"selectedSlot",value:c.reservationId});this.calendarRef.config({key:"selectedStart",value:c.ultStart});this.calendarRef.config({key:"selectedEnd",value:c.ultEnd});this.calendarRef.config({key:"showDropdown",value:this.UISettings.showDropdown})}
function Z(a,c,d,b){function f(a){function b(a){var c=["custom-value"],a=SDFramework.jq("input[value='"+a+"']");a.length>0?(a=a.attr("name").match(/\.\d+\.\d+/),c.push(a[0])):c=[];return c.join("")}a&&a.setMappings({reservationId:[b("SD-ResID")||"custom-value.1.1"],mltStart:[b("SD-StartTime")||"custom-value.1.2"],mltEnd:[b("SD-EndTime")||"custom-value.1.3"],mltCutoff:[b("SD-CutoffTime")||"custom-value.1.5"],timeZone:[b("SD-WindowTZ")||"custom-value.1.4",b("SD-CutoffTZ")||"custom-value.1.6"],minShip:[b("SD-MinShipDtUTC")||
"custom-value.1.11"],maxShip:[b("SD-MaxShipDtUTC")||"custom-value.1.10"],shipOffer:[b("SD-ShipOfferID")||"custom-value.1.9"],fss:[b("SD-PromiseLFSS")||"custom-value.1.12"],data:[b("SD-Data")||"custom-value.1.13"],reservationType:[b("SD-ResType")],start:[b("SD-SlotStartLTZ")],end:[b("SD-SlotEndLTZ")],tz:[b("SD-SlotLongTZ")]})}function g(a,b,c){return a&&b&&c?(a.config({key:b,value:c}),!0):!1}function h(a){a.calendarRef.config({key:"clientCallbacks",value:{calendarDisabled:function(){if(a.bbSDUI)a.bbSDUI.onCalendarUnselected()}}})}
function i(a){if(this.bbSDUI=Q(a.dom)){if(a.zipcode){var b=a.dom,c=this.bbSDUI,d=a.zipcode;if(c)c.zipcode=O({data:{dom_zipInput:typeof b==="undefined"?"sd_zipcode":b.widgetRoot+" ."+b.postalInput,dom_zipGo:"sd_zipcode_go",dom_zipEntError:typeof b==="undefined"?"sd_zipcode_enter_err":b.widgetRoot+" ."+b.ineligiblePostal,dom_zipValError:typeof b==="undefined"?"sd_zipcode_valid_err":b.widgetRoot+" ."+b.invalidPostal,dom_zipDefaultClass:typeof b==="undefined"?"":b.postalDefault,dom_zipOverdisplay:typeof b===
"undefined"?"":b.widgetRoot+" ."+b.postalOverdisplay,dom_zipLabel:typeof b==="undefined"?"":b.widgetRoot+" ."+b.postalLabel,dom_zipValue:typeof b==="undefined"?"":b.widgetRoot+" ."+b.postalValue,dom_zipEmpty:typeof b==="undefined"?"":b.widgetRoot+" ."+b.postalEmpty,dom_zipPrefix:typeof b==="undefined"?"":b.widgetRoot+" ."+b.postalPrefix}},d,1)}else if(b=this.bbSDUI)b.regions=N({data:{dom_regionList:"sd_region",dom_regionLoading:"sd_region_loading"}});this.itemCache=new SDUtils.Cache(j);if((b=this.bbSDUI)&&
a)b.config({data:{dom_mainElement:a.dom?a.dom.widgetRoot+" ."+a.dom.content:"sd_divUI",dom_notSureError:a.dom?a.dom.widgetRoot+" ."+a.dom.notSureError:"",dom_unknownError:a.dom?a.dom.widgetRoot+" ."+a.dom.unknownError:"",dom_zipInput:a.dom?a.dom.widgetRoot+" ."+a.dom.postalInput:null,dom_loading:"sd_region_loading"}}),g(b.checkbox,"dom_sdCheckbox",a.dom?a.dom.widgetRoot+" ."+a.dom.enabled:"sd_intent"),a.isAFN&&(g(b,"isAFN",a.isAFN),a.addressId&&a.addressId.length>0&&g(b,"id_address",a.addressId)),
g(b,"id_merchant",a.merchantID),g(b,"id_marketplace",a.marketplaceID),g(b,"id_asin",a.asinID),g(b,"id_sku",a.msku),g(b,"id_fmid",a.fmID),g(b,"id_quantity",a.quantity),g(b,"id_offerlist_id",a.offerListingID),a.shipoption&&g(b,"shipoption",a.shipoption);f(this.bbSDUI.inputs);b=this.bbSDUI.shoppingCart;g(b,"disabledHTML",a.cartDisabledHTML);g(b,"element","#addToCartSpan, #twisterAddToCartOrig");g(b,"cursorDisabled","not-allowed");g(this.bbSDUI.oneClick,"element","#oneClickSingleClick, .oneClickDiv b, #oneClickDivId");
(b=this.bbSDUI.cutoff)&&b.config({data:{element:"sd_cutoff_div",fail:"sd_cutoff_missed_div",dom_replace:"sd_cutoff"}});a=a.dom;if(!this.calendarRef.config({key:"showDropdown"})){b=this.bbSDUI;b.initMessage();var c="sd_widgets_BB .sdMessage_buybox p",d="sd_widgets_BB .sdMessage_buybox",e="sd_widgets_BB .sdMessage_service_buybox p";a&&(c=a.widgetRoot+" ."+a.slotDisplay,d=a.widgetRoot+" ."+a.slotDisplayContainer,e=a.widgetRoot+" ."+a.serviceDisplay);b.message&&b.message.config({data:{element:c,element_container:d,
element_service:e,timeslotDeterminationFn:this.isTimeslot}})}h(this)}else o.warn("SD CFG BB noUI")}var j=["asin","merchantID","sku","fmid"],e=["asin","merchantID","heavyBulky","sku","fmid"],d=1;b&&b.sdShowDropdown!==void 0&&(d=b.sdShowDropdown?1:0);i.prototype=new E("BB",null,c,{showDropdown:d},a.dom);i.prototype.injectDom=function(a,b,c,d,e){this.currentSD=a;c=this.calendarRef.config({key:"pickDateText"});this.calendarRef.config({key:"learnMoreText"});var f=this.calendarRef.config({key:"noSlotsAddressBB"}),
g=this.calendarRef.config({key:"retrieveError"});this.calendarRef.config({key:"tryAgain"});var h=this.calendarRef.config({key:"showDropdown"}),i=SDFramework.jq("#sd_widgets_"+a),j=[];j.push('<span class="sd_Loading" style="display: none;">');j.push("<p>");j.push(b);j.push("</p>");j.push("</span>");h===1?(j.push('<div class="sdMessage_buybox" style="display: none;"></div>'),j.push('<div class="sdMessage_buybox" style="display: none;"><span class="swSprite s_notifySm"></span><p></p></div>')):(j.push('<div class="sdMessage_buybox" style="display: none;"><p></p></div>'),
j.push('<div class="sdMessage_service_buybox" style="display: none;"><p></p></div>'));j.push('<span class="sd_widget" style="display: none">');h===1?(j.push('<span class="sd_Active">'),j.push('<select id="sduiDropdown',a,'" class="sdbuybox" name="sduiDate" disabled >'),j.push('<option value="" selected>',c,"</option>"),j.push("</select>"),j.push("</span>"),j.push('<span class="sd_calicon sd_calicon_disabled">'),j.push(d),j.push("</span>"),j.push('<a href="#" id="calendarLink',a,'" onclick="return false;">'),
j.push('<span class="sd_calicon sd_calicon_enabled" style="display: none;">'),j.push(e)):(j.push('<span class="sd_calicon sd_calicon_disabled">'),j.push(d),j.push("</span>"),j.push('<a href="#" id="calendarLink',a,'" onclick="return false;">'),j.push('<span class="sd_calicon sd_calicon_enabled" style="display: none;">'),j.push(e),j.push(this.calendarRef.config({key:"sd_select_another_date_and_time"})));j.push("</span>");j.push("</a>");j.push("</span>");j.push('<div class="sd_err_noslots" style="display: none;">');
j.push('<span id="sd_bb_no_slots_message" style="color: #ff0000; font-weight: bold;">',f,"</span>");j.push("</div>");j.push('<div class="sd_err_connect" style="display: none;">');j.push('<span id="sd_bb_retrieve_error" style="color: #ff0000; font-weight: bold;">',g,"</span>");j.push("</div>");j.push('<div id="sdcal-popup',a,'" class="sdCalendarPopover" style="display: none"></div>');i.prepend(j.join(""))};i.prototype.establishDomHooks=function(b){var c=this.currentSD;g(this.bbSDUI,"sd_calendar",this.calendarRef);
(function(d){d.icon({key:"dom_disabled",value:".sd_calicon_disabled"});d.icon({key:"dom_enabled",value:".sd_calicon_enabled"});g(d,"dom_bar","sd_widgets_"+c+" .sd_calendar");g(d,"dom_failbar","sd_widgets_"+c+" .sd_err_connect");g(d,"dom_noslots","sd_widgets_"+c+" .sd_err_noslots");g(d,"dom_loadbar","sd_widgets_"+c+" .sd_Loading");typeof b!=="undefined"&&(g(d,"dom_bar",b.widgetRoot+" ."+b.content),g(d,"dom_noslots",b.widgetRoot+" ."+b.notSureError),g(d,"dom_loadbar",b.widgetRoot+" ."+b.loading),g(d,
"hideWidgetOnError",1),g(d,"dom_slotsContent",b.widgetRoot+" ."+b.content),g(d,"dom_noslotsNotSure",b.widgetRoot+" ."+b.notSureError),g(d,"dom_noslotsUnknown",b.widgetRoot+" ."+b.unknownError),g(d,"dom_zipEntError",b.widgetRoot+" ."+b.ineligiblePostal),g(d,"dom_slotDisplay",b.widgetRoot+" ."+b.slotDisplayContainer),g(d,"dom_retry",b.widgetRoot+" ."+b.retry),g(d,"dom_slotTrigger",b.widgetRoot+" ."+b.calendarTrigger));g(d,"load_url",a.load_url);g(d.dropdown,"element","")})(this.calendarRef)};i.prototype.initializeSpecificDom=
function(){this.bbSDUI.initializeDOM()};var m=[];i.prototype.getRequestItemIDForKey=function(a){var b=this.itemCache.operate(a,{},SDUtils.Cache.IF_EXISTS.PRESERVE,SDUtils.Cache.IF_NEW.ADD),c=b.requestItemID;if(c===void 0)c=m.length,b.requestItemID=c,m[c]=a;return c};i.prototype.getKeyForRequestItemID=function(a){return m[a]};i.prototype.getIsSDAvailableParams=function(a,b){for(var c={marketplaceID:a},d=0,f=0;f<b.length;f++){var g=b[f];if(g.isSDAvailable===void 0){c["requestItemID"+d]=this.getRequestItemIDForKey(g);
for(var h=0;h<e.length;h++){var i=e[h],j=g[i];j!==null&&j!==void 0&&(c[i+d]=j)}d++}}return c};i.prototype.getKeyFromConfig=function(){return{asin:this.bbSDUI.config({key:"id_asin"}),merchantID:this.bbSDUI.config({key:"id_merchant"}),sku:this.bbSDUI.config({key:"id_sku"}),fmid:this.bbSDUI.config({key:"id_fmid"})}};i.prototype.setIsSDAvailable=function(a,b){this.itemCache.update(a,{isSDAvailable:b});this.itemCache.keysAreEqual(a,this.getKeyFromConfig())&&(this.bbSDUI.config({key:"isSDAvailable",value:b}),
this.refreshAppearance())};i.prototype.onTwisterChildrenIsSDAvailableResponse=function(a){o.isDebugEnabled()&&o.debug("isSDAvailable:",a);for(var b in a)a.hasOwnProperty(b)&&this.setIsSDAvailable(this.getKeyForRequestItemID(b),a[b])};i.prototype.onTwisterChildrenIsSDAvailableError=function(a,b,c){o.isWarnEnabled()&&(o.warn("SD isSDAvailable AJAX error: "+b),c&&o.warn("(HTTP error: "+c+")"))};i.prototype.cacheChildData=function(a){for(var b=0;b<a.length;b++){var c=a[b];this.itemCache.update(c,c)}};
i.prototype.batchIsSDAvailable=function(a){var a=this.getIsSDAvailableParams(this.bbSDUI.config({key:"id_marketplace"}),a),b=this;SDFramework.jq.ajax({url:"/gp/product/features/scheduled-delivery/is-sd-available-json.html?powerbar=0",type:"POST",dataType:"json",data:a,success:function(a){b.onTwisterChildrenIsSDAvailableResponse(a)},error:function(a,c,d){b.onTwisterChildrenIsSDAvailableError(a,c,d)},timeout:2E4})};i.prototype.fetchTwisterData=function(a){this.cacheChildData(a);this.batchIsSDAvailable(a)};
return new i(a)}window.ScheduledDelivery={};window.SDUtils={};var o=function(){function a(){}function c(){return!1}for(var d=["log","info","debug","warn","error"],b={suppressDefaultConsole:a},f=0;f<d.length;f++){var g=d[f],h="is"+g.charAt(0).toUpperCase()+g.substr(1)+"Enabled";b[h]=c;b[g]=a}return b}();ScheduledDelivery.Debug={requiredArg:function(a){return a}};window.SDFramework={jq:r};(function(){SDFramework.Class=function(){function a(a){SDFramework.jq.extend(this.rep,a)}function c(a,b){return function(){return b.apply(a,
arguments)}}function d(a){var b=this.rep,d;for(d in a)a.hasOwnProperty(d)&&(this.interfaceInstance[d]=c(b,a[d]))}function b(a){SDFramework.jq.extend(this.interfaceInstance,a)}return function(c){function g(){}this.interfaceInstance=g.prototype=c;this.rep=new g;this.declarePrivate=a;this.declarePublic=d;this.declarePublicFinal=b}}();SDFramework.defineStruct=function(){var a=arguments;return function(){for(var c=0;c<a.length;c++)this[a[c]]=arguments[c]}};SDFramework.defineClass=function(a){var c=function(){var c=
a.initBase?a.initBase.apply(null,arguments):this,b=new SDFramework.Class(c);a.privateFunctions&&b.declarePrivate(a.privateFunctions);a.publicFunctions&&b.declarePublic(a.publicFunctions);a.publicFinal&&b.declarePublicFinal(a.publicFinal);if(a.events)for(var f=c,g=a.events,h=0;h<g.length;h++)f[g[h]]=new SDFramework.Event;a.init&&a.init.apply(b.rep,arguments);a.publicInit&&a.publicInit.apply(c,arguments);return c};a.publicStatic&&SDFramework.jq.extend(c,a.publicStatic);return c}})();(function(){SDUtils.isEmptyObject=
function(a){for(var d in a)if(a.hasOwnProperty(d))return!1;return!0};var a=SDFramework.defineClass({init:function(a){this.i=0;this.arr=a},publicFunctions:{hasNext:function(){return this.i<this.arr.length},next:function(){var a=this.arr[this.i];this.i++;return a}}});SDUtils.ArraySet=SDFramework.defineClass({init:function(){this.arr=[]},publicFunctions:{add:function(a){if(this.contains(a))return!1;this.arr.push(a);return!0},remove:function(a){a=SDFramework.jq.inArray(a,this.arr);if(a==-1)return!1;this.arr[a]=
this.arr[this.arr.length-1];this.arr.pop();return!0},contains:function(a){return SDFramework.jq.inArray(a,this.arr)!=-1},getCount:function(){return this.arr.length},isEmpty:function(){return this.getCount()===0},iterator:function(){return new a(this.arr)},getAny:function(){return this.arr[0]},removeAny:function(){return this.arr.pop()}}});SDFramework.Event=function(){this.handlers=new SDUtils.ArraySet;this.dispatch=function(){for(var a=this.handlers.iterator();a.hasNext();)a.next().apply(null,arguments)}};
SDUtils.Cache=function(){function a(b,c){return function(a,d){return this.operate(a,d,b,c)}}function d(a,b,c){for(var d in b)if(b.hasOwnProperty(d)&&(c||!a.hasOwnProperty(d)))a[d]=b[d]}var b={PRESERVE:void 0,REPLACE:1,MERGE_OVERWRITE:2,MERGE_NO_OVERWRITE:3},f={DO_NOT_ADD:void 0,ADD:!0};return SDFramework.defineClass({publicStatic:{IF_EXISTS:b,IF_NEW:f},init:function(a){a.length||o.error("Invalid keyspec:",a);this.spec=a;this.buckets={}},privateFunctions:{primaryKey:function(a){return a[this.spec[0]]},
supplementaryKeysAreEqual:function(a,b){for(var c=this.spec,d=1;d<c.length;d++)if(a[c[d]]!==b[c[d]])return!1;return!0},operateOnBucket:function(a,b,c,f,e){for(var m=0;m<a.length;m++){var l=a[m];if(this.supplementaryKeysAreEqual(l.key,b)){switch(f){case SDUtils.Cache.IF_EXISTS.REPLACE:l.value=c;break;case SDUtils.Cache.IF_EXISTS.MERGE_OVERWRITE:d(l.value,c,!0);break;case SDUtils.Cache.IF_EXISTS.MERGE_NO_OVERWRITE:d(l.value,c,!1)}return l.value}}e===SDUtils.Cache.IF_NEW.ADD&&a.push({key:b,value:c});
return c}},publicFunctions:{keysAreEqual:function(a,b){return this.primaryKey(a)==this.primaryKey(b)&&this.supplementaryKeysAreEqual(a,b)},operate:function(a,b,c,d){var e=this.primaryKey(a),m=this.buckets[e];return m===void 0?(d==f.ADD&&(this.buckets[e]=[{key:a,value:b}]),b):this.operateOnBucket(m,a,b,c,d)},set:a(b.REPLACE,f.ADD),update:a(b.MERGE_OVERWRITE,f.ADD),get:a(b.PRESERVE,f.DO_NOT_ADD),clear:function(){this.buckets={}},forEachSubkey:function(a){for(var b=0;b<this.spec.length;b++)a(this.spec[b])}}})}()})();
ScheduledDelivery.Fsm=SDFramework.defineClass({init:function(a){this.initMatrix(a.graph);this.triggers=a.triggers?a.triggers:{};this.slaves=a.slaves?a.slaves:[];if(a.options)this.state=a.options.initialState,this.defaultSearch=a.options.defaultSearch,this.context=a.options.context;if(this.state===void 0)this.state="init";if(this.defaultSearch===void 0)this.defaultSearch=!1},privateFunctions:{initMatrix:function(a){this.matrix={};for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];this.matrix[c]={};
for(var b in d)d.hasOwnProperty(b)&&(this.matrix[c][b]={fn:d[b],enabled:!0})}},incrementSearch:function(a,c,d){var b=this.matrix[a.state];if(b)for(var f in b)if(b.hasOwnProperty(f)&&!d[f]&&b[f].enabled){var g={state:f,source:a};d[f]=!0;c.push(g)}return c.shift()},path:function(a){var c=[],d={state:this.state,source:null},b={};for(b[this.state]=!0;d.state!==a;)if(d=this.incrementSearch(d,c,b),d===void 0)return;for(a=[];d.source!==null;)a.unshift(d.state),d=d.source;return a},getTransitionMetadata:function(a,
c){var d=this.matrix[a];return!d?void 0:d[c]},driveSlaves:function(){for(var a=0;a<this.slaves.length;a++){var c=this.slaves[a],d=c.bindings[this.state];d!==void 0&&c.fsm.trySetState(d)}},doSingleStepTransition:function(a,c){var d=this.getTransitionMetadata(this.state,a);if(d&&d.enabled)return d.fn.apply(this.context,c)!==!1?(this.state=a,this.driveSlaves(),!0):!1},doMultiStepTransition:function(a,c){var d=this.path(a);if(d!==void 0){for(var b=0;b<d.length;b++)if(!this.doSingleStepTransition(d[b],
c))return!1;return!0}},logTransitionFailed:function(a,c){o.error('State transition from "'+a+'" to "'+c+'" failed.')},logTransitionNotDefined:function(a,c){o.error('State transition from "'+a+'" to "'+c+'" does not exist.')}},publicFunctions:{getState:function(){return this.state},setState:function(a,c){var d=this.state,b=this.trySetState(a,c);b||(b===!1?this.logTransitionFailed(d,a):this.logTransitionNotDefined(d,a))},trySetState:function(a,c){var d=this.defaultSearch,b=[];if(c){if(c.search!==void 0)d=
c.search;if(c.args!==void 0)b=c.args}var f=this.doSingleStepTransition(a,b);if(f!==void 0)return f;else if(this.state===a)return!0;else if(d)return this.doMultiStepTransition(a,b)},setTransitionEnabled:function(a,c,d){var b=this.getTransitionMetadata(a,c);b?b.enabled=d:this.logTransitionNotDefined(a,c)},enableTransition:function(a,c){this.setTransitionEnabled(a,c,!0)},disableTransition:function(a,c){this.setTransitionEnabled(a,c,!1)},setTrigger:function(a,c,d){var b=this.triggers[a];b||(b={},this.triggers[a]=
b);b[c]=d},clearTrigger:function(a,c){var d=this.triggers[a];d&&delete d[c]},trigger:function(a){var c=this.triggers[a];c?(c=c[this.state])?this.setState(c):o.error('State "'+this.state+'" cannot consume trigger "'+a+'".'):o.error('Trigger "'+a+'" is not defined.')},tryTrigger:function(a){if(a=this.triggers[a])return a=a[this.state],!a?void 0:this.trySetState(a)}}});ScheduledDelivery.Data={};ScheduledDelivery.Data.ReservationIdParser=function(){return SDFramework.defineClass({init:function(a){this.parts=
a?a.split(";"):[]},publicFunctions:{getSlotId:function(){return this.parts[0]},getEncodedCarriers:function(){return this.parts[1]},getEncodedCharges:function(){return this.parts[2]},getEncodedServices:function(){return this.parts[3]},getCharges:function(){if(this.charges===void 0){var a=this.getEncodedCharges(),a=a?a.split("^"):[];this.charges={perItem:parseFloat(a[0]),perShipment:parseFloat(a[1]),currencyCode:a[2]}}return this.charges},getCarriers:function(){if(this.carriers===void 0){var a=this.getEncodedCarriers();
this.carriers=a?a.split(","):[]}return this.carriers}}})}();ScheduledDelivery.Data.FulfillmentServiceSubclass=function(){function a(a){for(var b=0;b<c.length;b++)if(c[b]==a)return b}var c=["FAST_TRACK_SAME_DAY","FAST_TRACK_FUTURE_DAY","NOT_FAST_TRACK",void 0];return{score:a,pickTightestSla:function(c){for(var b=c,f=1;f<arguments.length;f++){var g=arguments[f],h=a(g),i=a(b);if(i===void 0||h!==void 0&&h<i)b=g}return b}}}();ScheduledDelivery.Data.Json=function(){function a(a){b.lastIndex=0;return b.test(a)?
'"'+a.replace(b,function(a){var b=h[a];return typeof b==="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(b,d){var h,l,w,n,q=f,s,p=d[b];p&&typeof p==="object"&&typeof p.toJSON==="function"&&(p=p.toJSON(b));typeof i==="function"&&(p=i.call(d,b,p));switch(typeof p){case "string":return a(p);case "number":return isFinite(p)?String(p):"null";case "boolean":case "null":return String(p);case "object":if(!p)return"null";f+=g;s=[];if(Object.prototype.toString.apply(p)===
"[object Array]"){n=p.length;for(h=0;h<n;h+=1)s[h]=c(h,p)||"null";w=s.length===0?"[]":f?"[\n"+f+s.join(",\n"+f)+"\n"+q+"]":"["+s.join(",")+"]";f=q;return w}if(i&&typeof i==="object"){n=i.length;for(h=0;h<n;h+=1)typeof i[h]==="string"&&(l=i[h],(w=c(l,p))&&s.push(a(l)+(f?": ":":")+w))}else for(l in p)Object.prototype.hasOwnProperty.call(p,l)&&(w=c(l,p))&&s.push(a(l)+(f?": ":":")+w);w=s.length===0?"{}":f?"{\n"+f+s.join(",\n"+f)+"\n"+q+"}":"{"+s.join(",")+"}";f=q;return w}}var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
b=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f,g,h={"":"\\b","\t":"\\t","\n":"\\n","":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},i;return{serialize:typeof JSON==="object"&&typeof JSON.stringify==="function"?function(a,b,c){return JSON.stringify(a,b,c)}:function(a,b,d){var h;g=f="";if(typeof d==="number")for(h=0;h<d;h+=1)g+=" ";else typeof d==="string"&&(g=d);if((i=b)&&typeof b!=="function"&&(typeof b!=="object"||typeof b.length!==
"number"))throw Error("JSON.stringify");return c("",{"":a})},deserialize:typeof JSON==="object"&&typeof JSON.parse==="function"?function(a,b){return JSON.parse(a,b)}:function(a,b){function c(a,d){var f,g,h=a[d];if(h&&typeof h==="object")for(f in h)Object.prototype.hasOwnProperty.call(h,f)&&(g=c(h,f),g!==void 0?h[f]=g:delete h[f]);return b.call(a,d,h)}var f,a=String(a);d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,
"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return f=eval("("+a+")"),typeof b==="function"?c({"":f},""):f;throw new SyntaxError("JSON.parse");}}}();(function(){function a(a){try{return encodeURIComponent(ScheduledDelivery.Data.Json.serialize(a)).replace(/[\\~]/g,function(a){return"%"+a.charCodeAt(0).toString(16)})}catch(b){o.error("Could not serialize SD data to JSON.",b,a)}}function c(a,b){if(a){if(b===void 0||b===null)b=
"";a.jquery?a.attr("value",b):d.each(a,function(a,c){d("input[name='"+c+"']").attr("value",b)})}}var d=SDFramework.jq,b={SPECIAL:-2,DATA_MEMBER:-1,SLOT:"slot"},f={data:b.SPECIAL,refdataVersion:b.DATA_MEMBER};ScheduledDelivery.Data.FormPersistence=SDFramework.defineClass({init:function(){this.data={}},privateFunctions:{updateFields:function(a,b){d.each(this.fields[a],function(a,d){c(d,b&&b[a])});this.data[a]=b},updateData:function(){var d=this.fields[b.SPECIAL].data;d&&c(d,a(this.data))}},publicFunctions:{setMappings:function(a){var c=
{};d.each(b,function(a,b){c[b]={}});d.each(a,function(a,d){c[f[a]||b.SLOT][a]=d});this.fields=c},clearSlotFields:function(){this.updateSlotFields()},updateSlotFields:function(a){this.updateFields(b.SLOT,a);this.updateData()},updateDataMembers:function(a){var f=this.fields[b.DATA_MEMBER],i=this;d.each(a,function(a,b){i.data[a]=b;c(f[a],b)});this.updateData()}}})})();ScheduledDelivery.BuyBox={};I=void 0;J=void 0;ScheduledDelivery.BuyBox.HoverPopover=function(){return SDFramework.defineClass({init:function(a){this.container=
SDFramework.jq(ScheduledDelivery.Debug.requiredArg(a.containerHtml));a.contentHtml&&this.setContent(a.contentHtml)},publicFunctions:{setContentHtml:function(a){this.container.html(a)},bind:function(a){this.parent&&this.unbind();this.parent=a;a.amazonPopoverTrigger({location:["left","auto"],locationAlign:"middle",locationMargin:-10,width:null,skin:null,hoverHideDelay:0,hoverShowDelay:0,showOnHover:!0,showCloseButton:!1,literalContent:this.container})},unbind:function(){if(this.parent)this.parent.removeAmazonPopoverTrigger(),
this.parent=null}}})}();ScheduledDelivery.BuyBox.UIOverride=function(){function a(a){b.wrap(a)}function c(a){b.unwrap(a)}var d=SDFramework.defineClass({init:function(a){this.cssClass=a;this.html='<span class="'+a+'" />';var b="span."+a;this.wrapperSelector=b;var c=function(){return SDFramework.jq(this).parent(b).length};this.contentFilter=c;this.nonContentFilter=function(){return!c.call(this)}},publicFunctions:{filterWrappedElements:function(a){return a.filter(this.contentFilter)},filterUnwrappedElements:function(a){return a.filter(this.nonContentFilter)},
selectWrappers:function(a){return a.parent(this.wrapperSelector)},wrap:function(a){this.filterUnwrappedElements(a).wrap(this.html)},unwrap:function(a){a=this.filterWrappedElements(a);a.unwrap?a.unwrap():a.each(function(){SDFramework.jq(this).parent().replaceWith(this)})}}}),b=new d("sdXuiVisibilityWrapper");return{WrapperTemplate:d,hide:a,show:c,setVisible:function(b,d){d?c(b):a(b)}}}();ScheduledDelivery.BuyBox.SDIntentCheckbox=SDFramework.defineClass({events:["onCheck","onClear"],privateFunctions:{dom:B("dom_sdCheckbox",
"check"),dispatchClick:function(){this.isChecked()?this.onCheck.dispatch():this.onClear.dispatch()}},publicFunctions:{config:v("checkbox"),bindDOM:function(){var a=this;this.dom().click(function(){a.dispatchClick()})},isChecked:function(){var a=this.dom();return a.prop?a.prop("checked"):a.is(":checked")},exists:function(){return this.dom().size()>0},setChecked:function(a){if(this.isChecked()!==a){var c=this.dom();c.prop?this.dom().prop("checked",a):a?c.attr("checked","checked"):c.removeAttr("checked");
this.dispatchClick()}},setVisible:function(a){a?this.dom().show():this.dom().hide()}}});ScheduledDelivery.BuyBox.SlotStorage=SDFramework.defineClass({privateFunctions:{INPUT_VALUE_PREFIX:"custom-value",validSlotExists:function(a){var a=this.slots[a],c=!1,d;for(d in a)if(a.hasOwnProperty(d)){var b=a[d];d.indexOf(this.INPUT_VALUE_PREFIX)===0&&b&&(c=!0)}return c}},init:function(a,c){this.slotInputClass=a;this.rootElement=c;this.slots={}},publicFunctions:{config:v("slotstorage"),storeSlotInput:function(a){if(a){this.slots[a]=
{};var c=this;SDFramework.jq("#"+this.rootElement+" ."+this.slotInputClass).each(function(){var d=SDFramework.jq(this),b=d.attr("name"),d=d.attr("value");c.slots[a][b]=d})}},repopulateSlotInput:function(a){if(a){var c=this.slots[a],d;for(d in c)if(c.hasOwnProperty(d)){var b=c[d],f=null,f=SDFramework.jq("#"+this.rootElement+" input[name='"+d+"']."+this.slotInputClass);f.size()>0&&(f=SDFramework.jq(f[0]),f.attr("name",d),f.attr("value",b))}return this.validSlotExists(a)}},clearSlotInput:function(a){if(a){var c=
this;SDFramework.jq("#"+this.rootElement+" ."+this.slotInputClass).each(function(){var a=SDFramework.jq(this);a.attr("name").indexOf(c.INPUT_VALUE_PREFIX)===0&&a.attr("value","")})}}}});SDUtils.isBeacon=function(a){return a.parents(".a-container").length>0};SDUtils.protectAgainstDoubleAction=function(){var a={};return function(c,d){if(!c)return window.console&&window.console.error&&console.error("Function is not used properly, use a unique owner to identify the caller."),!1;if(a.hasOwnProperty(c))return!0;
a[c]=1;setTimeout(function(){delete a[c]},d||100);return!1}}();I=function(){return SDFramework.defineClass({init:function(){this.warningPopover=new ScheduledDelivery.BuyBox.HoverPopover({containerHtml:'<div class="sd_bb_warn_pop" />'});this.disabledDomFsm=new ScheduledDelivery.Fsm({graph:{hiddenNotLoaded:{shown:function(){this.disabledDOM=this.loadDisabledJQ()}},shown:{hidden:function(){this.disabledDOM.hide()}},hidden:{shown:function(){this.disabledDOM.show()}}},options:{context:this,initialState:"hiddenNotLoaded"}});
this.enabledDomFsm=new ScheduledDelivery.Fsm({graph:{shown:{hidden:function(){this.overriddenUI=this.getAddToCartSelector();this.overriddenUI.hide()}},hidden:{shown:function(){this.overriddenUI.show()}}},options:{context:this,initialState:"shown"}})},privateFunctions:{getAddToCartSelector:function(){var a=this.config({key:"element"});a=="undefined"&&(o.warn("shopping-cart: no element"),a=[]);return SDFramework.jq(a)},loadDisabledJQ:function(){var a=this.config({key:"disabledHTML"});if(a!="undefined"){var c=
this.getAddToCartSelector(),a=SDFramework.jq(a);c.after(a);c=a.is("img")?a:a.find("img");c.length===0?o.warn("Add to cart disabled image not found"):(this.warningPopover.bind(c),c.css("cursor",this.config({key:"cursorDisabled"})))}else o.warn("no disabledHTML"),a=SDFramework.jq(document.createElement("span"));return a}},publicFunctions:{config:v("shoppingCart"),enable:function(a){a?this.enableAddToCart():this.disableAddToCart()},enableAddToCart:function(){this.disabledDomFsm.trySetState("hidden");
this.enabledDomFsm.setState("shown")},disableAddToCart:function(){this.enabledDomFsm.setState("hidden");this.disabledDomFsm.setState("shown")},setWarningMessage:function(a){this.warningPopover.setContentHtml(a)}}})}();J=function(){return SDFramework.defineClass({publicFunctions:{config:v("oneClick"),enable:function(a){var c=this.config({key:"element"});c?ScheduledDelivery.BuyBox.UIOverride.setVisible(SDFramework.jq(c),a):o.warn("one-click: no element")}}})}();ScheduledDelivery.BuyBox.DomStringUpdater=
function(){var a=ScheduledDelivery.Debug;return SDFramework.defineClass({init:function(c){this.merchantStringMappings=a.requiredArg(c.domMerchantStringMappings);this.afnLearnMoreNode=a.requiredArg(c.afnLearnMoreNode)},privateFunctions:{resolveMerchantString:function(a,d){return this.merchantStringMappings[a][d]},updateMerchantTextElements:function(a,d){for(var b in a)a.hasOwnProperty(b)&&SDFramework.jq(b).text(this.resolveMerchantString(a[b],d))},resolveLearnMoreNode:function(a,d){return a?this.afnLearnMoreNode:
this.resolveMerchantString("sd_mfn_learn_more_node",d)}},publicFunctions:{updateStrings:function(a,d){this.updateMerchantTextElements({"#sd_bb_intent_text":"schedule_delivery_34179","#sd_bb_select_delivery_date_text":"sd-select-delivery-date-buybox","#sd_bb_notify1":"notify1","#sd_bb_notify2":"notify2"},d);var b=a?this.afnLearnMoreNode:this.resolveMerchantString("sd_mfn_learn_more_node",d),f=!a&&(d=="Installation"||d=="LocalInstallation")?"/gp/feature.html?docId=":"/gp/help/customer/display.html?nodeId=";
SDFramework.jq("#sd_bb_learn_more").attr("href",f+b)}}})}();ScheduledDelivery.BuyBox.Widget=SDFramework.defineClass({initBase:function(a,c,d,b){return Z(a,c,d,b)},init:function(a,c,d,b){this.weblabs=b;this.domStringUpdater=a.domStringUpdater;this.jsMerchantStringMappings=a.jsMerchantStringMappings;this.marketplaceID=a.marketplaceID;this.strings=a.strings;this.initUI();c=function(){};this.visFsm=new ScheduledDelivery.Fsm({graph:{hidden:{hidden:c,visible:this.container.show},visible:{hidden:this.container.hide,
visible:c}},options:{context:this.container,initialState:"hidden"}});this.calCacheFsm=new ScheduledDelivery.Fsm({graph:{init:{needNew:this.invalidateCalendars},needNew:{needNew:this.invalidateCalendars}},options:{context:this}});this.fsm=new ScheduledDelivery.Fsm({graph:{notLoaded:{enabled:c,disabled:c,requiredEnabled:this.xToRequiredNt,requiredDisabled:c},enabled:{enabled:c,disabled:this.xToDisabledNt,requiredEnabled:this.xToRequiredNt,requiredDisabled:this.xToDisabledNt},disabled:{enabled:c,disabled:c,
requiredEnabled:this.xToRequiredNt,requiredDisabled:c},requiredEnabled:{enabled:this.xFromRequiredNt,disabled:function(){this.xFromRequiredNt();this.toDisabledNt()},requiredEnabled:c,requiredDisabled:function(){this.xFromRequiredNt();this.toDisabledNt()}},requiredDisabled:{enabled:c,disabled:c,requiredEnabled:this.xToRequiredNt,requiredDisabled:c}},slaves:[{fsm:this.visFsm,bindings:{enabled:"visible",disabled:"hidden",requiredEnabled:"visible",requiredDisabled:"hidden"}},{fsm:this.calCacheFsm,bindings:{enabled:"needNew",
requiredEnabled:"needNew"}}],triggers:{require:{enabled:"requiredEnabled",disabled:"requiredDisabled"},unrequire:{requiredEnabled:"enabled",requiredDisabled:"disabled"},enable:{enabled:"enabled",disabled:"enabled",requiredEnabled:"requiredEnabled",requiredDisabled:"requiredEnabled"},disable:{enabled:"disabled",requiredEnabled:"requiredDisabled"}},options:{context:this,initialState:"notLoaded"}});this.setEnabledTrigger(d);this.setMerchantType(a.merchantType)},publicInit:function(){},privateFunctions:{initUI:function(){this.container=
SDFramework.jq("#sd_div");this.chkSdIntent=this.bbSDUI.checkbox},setRequiredTrigger:function(a){this.required=a;this.fsm.tryTrigger(a?"require":"unrequire")},setEnabledTrigger:function(a){this.enabled=a;this.fsm.tryTrigger(a?"enable":"disable")},xToDisabledNt:function(){this.chkSdIntent.setChecked(!1)},xToRequiredNt:function(){this.bbSDUI.shoppingCart.setWarningMessage(this.strings.sd_required_buybox_disabled);this.chkSdIntent.setChecked(!0);this.chkSdIntent.setVisible(!1)},xFromRequiredNt:function(){this.chkSdIntent.setVisible(!0);
this.bbSDUI.shoppingCart.setWarningMessage(this.nonRequiredShoppingCartWarning)},setMerchantType:function(a){this.merchantType=a;M({calendar:this.calendarRef,buybox:this.bbSDUI,merchantType:a,marketplaceID:this.marketplaceID,strings:this.strings});SDFramework.jq("#sd_bb_no_slots_message").text(this.calendarRef.config({key:"noSlotsAddressBB"}));SDFramework.jq("#sd_bb_retrieve_error").text(this.calendarRef.config({key:"retrieveError"}));this.nonRequiredShoppingCartWarning=this.jsMerchantStringMappings?
this.jsMerchantStringMappings.sd_buybox_disabled[a]:this.strings.sd_buybox_disabled;this.required||this.bbSDUI.shoppingCart.setWarningMessage(this.nonRequiredShoppingCartWarning)},invalidateCalendars:function(){this.bbSDUI.unselectCalendar();this.chkSdIntent.isChecked()&&this.bbSDUI.selectCalendar()},isCallbackWeblabConsistent:function(a){if(a){if(this.weblabs.sdTwisterOnChildSelect&&a.sdInfo===void 0)return o.warn("Twister Ajax executed with inconsistent weblab state (non-T1)."),!1}else if(!this.weblabs.sdTwisterOnChildSelect)return o.warn("Twister Ajax executed with inconsistent weblab state (T1)."),
!1;return!0}},publicFunctions:{declareContainerReady:function(){this.fsm.setState(this.enabled?this.required?"requiredEnabled":"enabled":this.required?"requiredDisabled":"disabled")},updateBuyBoxObject:function(a){try{if(o.debug("Updating SD widget",a),this.isCallbackWeblabConsistent(a))if(this.weblabs.sdTwisterAjax){o.debug("SDTwister: T3");this.bbSDUI.config({key:"id_offerlist_id",value:a.offerListingID});this.bbSDUI.config({key:"id_quantity",value:a.quantity});var c={asin:a.asin,merchantID:a.merchantID,
sku:a.mSku,fmid:a.fmID,offerListingID:a.offerListingID,quantity:a.quantity},d=this.itemCache.update(c,c);d.isSDAvailable===void 0&&o.isWarnEnabled()&&o.warn("Cache miss on SD Availability for item:",a,"Cache state:",this.itemCache);this.bbSDUI.config({key:"id_merchant",value:d.merchantID});this.bbSDUI.config({key:"id_asin",value:d.asin});this.bbSDUI.config({key:"id_sku",value:d.sku});this.bbSDUI.config({key:"id_fmid",value:d.fmid});this.bbSDUI.config({key:"shipoption",value:d.shipOption});this.bbSDUI.config({key:"isSDAvailable",
value:d.isSDAvailable?!0:!1});this.domStringUpdater.updateStrings(d.isFBA,d.merchantType);this.setMerchantType(d.merchantType);this.setEnabledTrigger(this.bbSDUI.config({key:"isSDAvailable"}))}else this.weblabs.sdTwisterOnChildSelect?(o.debug("SDTwister: T1"),a?(this.bbSDUI.config({key:"id_merchant",value:a.merchantID}),this.bbSDUI.config({key:"id_asin",value:a.asin}),this.bbSDUI.config({key:"id_sku",value:a.mSku}),this.bbSDUI.config({key:"id_fmid",value:a.fmID}),this.bbSDUI.config({key:"id_offerlist_id",
value:a.offerListingID}),this.bbSDUI.config({key:"id_quantity",value:a.quantity}),this.bbSDUI.config({key:"shipoption",value:a.shipOption}),this.domStringUpdater.updateStrings(a.sdInfo.isFBA,a.sdInfo.merchantType),this.setMerchantType(a.sdInfo.merchantType),this.setEnabledTrigger(!0)):this.setEnabledTrigger(!1)):(o.debug("SDTwister: C"),SDFramework.jq("#sd_intent").removeAttr("disabled"),this.bbSDUI.config({key:"id_merchant",value:a.merchantID}),this.bbSDUI.config({key:"id_asin",value:a.asin}),this.bbSDUI.config({key:"id_sku",
value:a.mSku}),this.bbSDUI.config({key:"id_fmid",value:a.fmID}),this.bbSDUI.config({key:"id_offerlist_id",value:a.offerListingID}),this.bbSDUI.config({key:"id_quantity",value:a.quantity}),this.calendarRef.calData.clearCals(),SDFramework.jq("#sd_intent:checked").length>0&&SDFramework.jq("#sd_zipcode_go").click());else this.fsm.trigger("disable")}catch(b){o.error("Unable to update Scheduled Delivery widget.",b.message,b.stack)}}}});E.prototype.initializeDom=function(){var a=this.domSettings?this.domSettings.widgetRoot:
"sd_widgets_"+this.widgetIndex;SDFramework.jq("#"+a+" .sd_Loading").hide();SDFramework.jq("#"+a+" .sd_err_nojs").hide();SDFramework.jq("#"+a+" .sd_err_connect").hide()};E.prototype.establishDomHooks=function(){var a=this.domSettings?this.domSettings.widgetRoot:"sd_widgets_"+this.widgetIndex;this.calendarRef.icon({key:"dom_disabled",value:"#"+a+" .sd_calicon_disabled"});this.calendarRef.icon({key:"dom_enabled",value:"#"+a+" .sd_calicon_enabled"});this.calendarRef.config({data:{dom_bar:a+" .sd_widget",
dom_failbar:a+" .sd_err_connect",dom_noslots:a+" .sd_err_from_result",dom_inconsistent:a+" .sd_err_inconsistent",dom_reload:a+" .sd_reload",dom_loadbar:a+" .sd_Loading"}});this.UISettings.showDropdown===1&&this.calendarRef.dropdown.config({key:"element",value:"sduiDropdown"+this.widgetIndex})};E.prototype.injectDom=function(a,c,d,b,f,g,h){function i(a,b,c){k.push('<img class="sd_calicon ',a,'" src="',c,'" width="25" alt="Calendar" height="17" border="0"');b||k.push(' style="display: none;"');k.push("/>")}
function j(){i("sd_calicon_disabled",!0,f)}function e(a,b,c,d){var e;if(SDUtils.isBeacon(u)){k.push('<div class="',a," a-box ",c?"a-alert ":"","a-alert-",b,'" style="display: none;">');k.push('<div class="a-box-inner">');c&&k.push('<i class="a-icon a-icon-alert"></i>');for(e=3;e<arguments.length;e++)k.push(arguments[e]);k.push("</div>")}else{k.push('<div class="',a,' sdWarn" style="display: none;">');for(e=3;e<arguments.length;e++)k.push(arguments[e])}k.push("</div>")}var m=this.calendarRef.config({key:"pickDateText"}),
l=this.calendarRef.config({key:"learnMoreText"}),w=this.calendarRef.config({key:"reloadText"}),n=this.calendarRef.config({key:"noSlotsAddress"}),o=this.calendarRef.config({key:"inconsistentWithBuybox"}),s=this.calendarRef.config({key:"retrieveError"}),p=this.calendarRef.config({key:"tryAgain"}),y=this.calendarRef.config({key:"showDropdown"}),u=SDFramework.jq("#"+(this.domSettings?this.domSettings.widgetRoot:"sd_widgets_"+this.widgetIndex)),k=[];k.push('<input type="hidden" name="SD-SlotID-',a,'" key="ScheduledDeliveryEntity.SlotId"                   value=""/>');
k.push('<input type="hidden" name="SD-ResID-',a,'" key="ScheduledDeliveryEntity.ReservationId"            value=""/>');k.push('<input type="hidden" name="SD-ResType-',a,'" key="ScheduledDeliveryEntity.reservationType"          value=""/>');k.push('<input type="hidden" name="SD-StartTime-',a,'" key="ScheduledDeliveryEntity.startDeliveryDate"        value=""/>');k.push('<input type="hidden" name="SD-EndTime-',a,'" key="ScheduledDeliveryEntity.endDeliveryDate"          value=""/>');k.push('<input type="hidden" name="SD-WindowTZ-',
a,'" key="ScheduledDeliveryEntity.deliveryTimeZone"         value=""/>');k.push('<input type="hidden" name="SD-CutoffTime-',a,'" key="ScheduledDeliveryEntity.cutoffTime"               value=""/>');k.push('<input type="hidden" name="SD-CutoffTZ-',a,'" key="ScheduledDeliveryEntity.deliveryTimeZone"         value=""/>');k.push('<input type="hidden" name="SD-SlotStartLTZ-',a,'" key="ScheduledDeliveryEntity.deliveryRange.startDate"  value=""/>');k.push('<input type="hidden" name="SD-SlotEndLTZ-',a,'" key="ScheduledDeliveryEntity.deliveryRange.endDate"    value=""/>');
k.push('<input type="hidden" name="SD-SlotLongTZ-',a,'" key="ScheduledDeliveryEntity.deliveryRange.timezone"   value=""/>');k.push('<input type="hidden" name="SD-Date-',a,'" value=""/>');k.push('<input type="hidden" name="SD-Cutoff-',a,'" value=""/>');c&&k.push('<input type="hidden" name="SD-OrderID-',a,'" value="',c,'"/>');d&&k.push('<input type="hidden" name="SD-ItemList-',a,'" value="',d,'"/>');k.push('<input type="hidden" name="D_MinShipDtUTC-',a,'" key="ScheduledDeliveryEntity.promiseMinShipmentDate" value=""/>');
k.push('<input type="hidden" name="D_MaxShipDtUTC-',a,'" key="ScheduledDeliveryEntity.promiseMaxShipmentDate" value=""/>');k.push('<input type="hidden" name="SD-PromiseLFSS-',a,'" key="ScheduledDeliveryEntity.promiseFulfillmentServiceSubclass" value=""/>');if((c=this.dataField)&&(c.id||c.name))k.push('<input type="hidden"'),c.id&&k.push(' id="',c.id,'"'),c.name&&k.push(' name="',c.name,'"'),k.push("/>");k.push('<span class="sd_Loading" style="display: none;">');k.push('<img src="',b,'" width="114" height="9" alt="Loading" border="0" />');
k.push("</span>");y===1?(k.push('<div class="sdMessage" style="display: none;">'),k.push('<div class="sdMessage" style="display: none;"><span class="swSprite s_notifySm"></span><p></p></div>'),k.push("</div>")):(k.push('<div class="sdMessage" style="display: none;"><p></p></div>'),k.push('<div class="sdMessage_service" style="display: none;"><p></p></div>'));k.push('<span class="sd_controls v1">');k.push('<span class="sd_widget" style="display: none">');y===1?(k.push('<span class="sd_Active">'),k.push('<select id="sduiDropdown',
a,'" name="sduiDate" disabled >'),k.push('<option value="" selected>',m,"</option>"),k.push("</select>"),k.push("</span>"),j(),k.push('<a href="#" class="sd_calendar_link" id="calendarLink',a,'" onclick="return false;">')):(k.push('<a href="#" class="sd_calendar_link" id="calendarLink',a,'" onclick="return false;">'),k.push('<span class="sd_Active"> <u>'),k.push(this.calendarRef.config({key:"sd_select_another_date_and_time"})),k.push("</u></span>"),j());i("sd_calicon_enabled",!1,g);k.push("</a>");
k.push("</span>");k.push('<a class="learnmore" href="',h,'" target="_blank">',l,"</a>");k.push('<span class="sd_reload" id="sd_reload_',a,'" style="display: none;">');k.push(w);k.push("</span>");k.push("</span>");e("sd_err_noslots","info",!1,"<p>",n,"</p>");e("sd_err_inconsistent","info",!1,"<p>",o,"</p>");e("sd_err_connect","info",!1,"<p>",s,' <a class="sdReloadLink" href="#">',p,"</a></p>");e("sd_err_from_result","info",!1,'<div class="sd_err_from_result_content"/>');k.push('<div id="sdcal-popup',
a,'" class="sdCalendarPopover" style="display: none"></div>');u.prepend(k.join(""));u.find(".sdReloadLink").click(function(){u.find(".sd_reload").click()})};sd_init_checkout_configure=function(a,c,d,b,f,g,h){function i(a,b,c,d,f){if(this.chkSDUI=S("sd_loaded_"+a.currentSD)){this.chkSDUI.config({key:"sd_calendar",value:this.calendarRef});this.calendarRef.config({key:"load_url",value:c.load_url});this.calendarRef.config({key:"message_hook",value:a.messageHook});this.calendarRef.config({key:"dom_widget_root",
value:"sd_widgets_"+a.currentSD});this.calendarRef.config({key:"dom_no_widget_root",value:"sd_no_widgets_"+a.currentSD});this.calendarRef.config({key:"dom_popup_trigger",value:"calendarLink"+a.currentSD});this.calendarRef.config({key:"id_enable_fn",value:a.onEnableFn});this.calendarRef.config({key:"id_select_fn",value:a.onSelectFn});this.calendarRef.config({key:"id_is_selected",value:a.isSelected&&a.isSelected!=="false"&&a.isSelected!=="0"});this.calendarRef.config({key:"weblabs",value:h});if(this.chkSDUI.inputs){var g=
a.currentSD,i=j.id?SDFramework.jq("#"+j.id):[j.name];this.chkSDUI.inputs.setMappings({slotId:["SD-SlotID-"+g],reservationId:["SD-ResID-"+g],reservationType:["SD-ResType-"+g],ultStart:["SD-StartTime-"+g],ultEnd:["SD-EndTime-"+g],ultCutoff:["SD-CutoffTime-"+g],timeZone:["SD-CutoffTZ-"+g,"SD-WindowTZ-"+g],minShip:["D_MinShipDtUTC-"+g],maxShip:["D_MaxShipDtUTC-"+g],fss:["SD-PromiseLFSS-"+g],start:["SD-SlotStartLTZ-"+g],end:["SD-SlotEndLTZ-"+g],tz:["SD-SlotLongTZ-"+g],data:i});this.chkSDUI.inputs.updateDataMembers({refdataVersion:f.sdUseCase})}if(this.chkSDUI.message)this.chkSDUI.message.config({data:{element:"sd_widgets_"+
a.currentSD+" .sdMessage p",element_service:"sd_widgets_"+a.currentSD+" .sdMessage_service p",timeslotDeterminationFn:this.isTimeslot}}),this.chkSDUI.message.showDropdown=f.showDropdown!==void 0&&f.showDropdown===0?0:1}this.chkSDUI.config({data:{dom_message_hook:a.messageHook,dom_sdso:"sd-shipop",id_address:c.addressId,id_merchant:b.merchant,id_marketplace:c.marketplaceId,id_asin:b.asin,id_sku:b.msku,id_fmid:b.fmid,id_quantity:b.quantity,id_offerlist_id:b.olid,id_itemList_id:b.itemListId,id_shipoption:a.speedKey,
id_enable_fn:a.onEnableFn,id_select_fn:a.onSelectFn,id_is_selected:a.isSelected,id_template_slot:d&&d.reservationId?d.reservationId:null}})}var g=g===null?{}:g,j=a.dataField;if(!j||!j.id&&!j.name)j={name:"SD-Data-"+a.currentSD};i.prototype=new E(a.currentSD,b,f,g,null,j);i.prototype.initializeSpecificDom=function(){this.initializeDom()};a=new i(a,c,d,b,g);M({calendar:a.calendarRef,checkout:a.chkSDUI,merchantType:d.merchantType,marketplaceID:d.marketplaceID,strings:d.strings,sdUseCase:g.sdUseCase});
return a};C.declare("scheduledDeliveryWidget")})})})(function(){var C=window.AmazonUIPageJS||P,H=C.attributeErrors;return H?H("SDCXDetailPageAssets"):C}());
/* ******** */
(function(g,i,m){g.execute(function(){g.when("A","a-button","a-modal","ready").register("success-modal-add-to-br-declarative-actions",function(f,g,k){var c=f.$,e=f.state("jumpstart-success-modal-state");if(typeof e!=="undefined"&&e!==null&&e.showDPHeadJavaScript&&e.showBabyRegSuccessModal&&e.hasBabyReg){c(document).delegate("#add-to-registry-baby-button-submit","click",function(a){a.preventDefault();a=c("#is-fully-selected-baby-reg").val()==="true";if(typeof a!=="undefined"&&a!==null&&a){a=c("#ASIN").val();
c("#rsid").val();var a={name:"baby-registry-add-success-modal",header:e.addSuccessModalHeader,url:"/baby-reg/addsuccessmodal?asin="+a+"&ref_=br_js_asm"},b=c("#add-to-registry-baby-button-submit");k.create(b,a);k.get(c("#add-to-registry-baby-button-submit")).show()}});var l=function(a,b,d){a=c.extend({},{ref:"baby_reg_js_update_"+a,update:a,forceAjax:1},b);f.post("/gp/baby/api/update.html/ref="+a.ref,{params:a,success:function(a){d(a)},failure:function(){d({ok:0})}})},n=function(a,b,d){b=c.extend({},
{forceAjax:1},b);f.post(a,{params:b,success:function(a){d(a)},failure:function(){d({ok:0})}})};f.on("a:popover:beforeHide:baby-registry-add-success-modal",function(){var a=i.ue;typeof a!=="undefined"&&a.count("brSuccessModalDismissed",(a.count("brSuccessModalDismissed")||0)+1)});var j=c("#enable-success-modal-new-url").val();f.on("a:popover:ajaxContentLoaded:baby-registry-add-success-modal",function(){var a=c("#success-modal-recommendatons").val();if(typeof a!=="undefined"&&a!==null&&a.length>0)for(var a=
a.substring(1,a.length-1).split(", "),b=j==="1"?n:l,d=j==="1"?"/baby-reg/successmodal/getattributes":"getPaAttributes";a.length>0;){var e={isRAW:1,update:"getPaAttributes",recommendations:a.splice(0,10).toString(),sid:c("#rsid").val()};b(d,e,function(a){try{var b=j==="1"?a:f.parseJSON(a);b&&b.ok&&b.ok==="1"?c.each(b.itemMap,function(a,b){var d="#rec-item-title-"+a;c(d).attr("title",b.title);c(d).html(b.title);d="#rec-item-price-"+a;d="#rec-item-price-"+a;b.priceMin!==b.priceMax?c(d).html(b.currency+
b.priceMin+" - "+b.currency+b.priceMax):c(d).html(b.currency+b.priceMin);c("#rec-item-image-"+a).attr("src",b.imageUrl);var d="#rec-item-review-"+a+" > .a-icon",f="#rec-item-review-"+a+" .a-icon-alt",e=b.numFullStars,h=c(d).attr("class"),h=h.substring(0,h.length-1)+b.numFullStars;b.hasHalfStar&&(h+="-5",e+=0.5);c(d).attr("class",h);c(f).html(e+"/5");c("#rec-item-spinner-"+a).addClass("js-hidden");c("#rec-item-attributes-wrapper-"+a).removeClass("js-hidden");b.isVariationalParent===!0&&(g("#success-modal-add-to-br-submit-button-"+
a).hide(),c("#success-modal-see-buying-options-button-"+a).removeClass("js-hidden"))}):c("#add-success-recs-carousel-container").addClass("js-hidden")}catch(d){c("#add-success-recs-carousel-container").addClass("js-hidden")}})}});f.declarative("success-modal-add-to-br","click",function(a){var b=a.data,d=g("#success-modal-add-to-br-submit-button-"+b.recItemAsin);d.isEnabled()&&(d.disable(),a={isRAW:1,update:"addtoBabyRegistry",asin:b!==m?b.recItemAsin:null,sid:c("#rsid").val(),ref_:"baby_reg_asm_addtoBabyRegistry"},
c("#add-to-br-success-message").hasClass("js-hidden")||c("#add-to-br-success-message").addClass("js-hidden"),l("addtoBabyRegistry",a,function(a){try{var e=f.parseJSON(a);e&&e.ok&&e.ok==="1"?e.isDupItem?c("#rec-item-already-added-message-"+b.recItemAsin).removeClass("js-hidden"):c("#rec-item-added-message-"+b.recItemAsin).removeClass("js-hidden"):c("#rec-item-fail-added-message-"+b.recItemAsin).removeClass("js-hidden")}catch(g){c("#rec-item-fail-added-message-"+b.recItemAsin).removeClass("js-hidden")}d.hide()}))})}})})})(function(){var g=
window.AmazonUIPageJS||window.P,i=g._namespace||g.attributeErrors;return i?i("BabyRegistryDPAssets"):g}(),window);
/* ******** */
(function(b){b.execute(function(){b.when("A","a-popover","tellMeMoreLinkData","ready").execute(function(c,h,e){var a=e.method(),e=a.title,g=a.destination,a=a.trigger,a="#"+a,f=c.$,c=f(a),i={url:g,header:e,width:450,activate:"onclick",position:"triggerLeft",closeButton:"true",closeButtonLabel:"Dismiss"},d=null;e!==null&&g!==null&&a!==null&&(d=h.create(c,i).lock());d.isActive();b.when("A","a-popover","ready").execute(function(){f(document).delegate("button#pfw_close_close-announce","click",function(a){a.preventDefault();
d.unlock().hide();d.lock()});f(document).delegate("button#pfw_cancel_close-announce","click",function(a){a.preventDefault();d.unlock().hide();d.lock()})})})})})(function(){var b=window.AmazonUIPageJS||window.P,c=b._namespace||b.attributeErrors;return c?c("RetailPricingFeedbackAsset"):b}(),window);
/* ******** */
